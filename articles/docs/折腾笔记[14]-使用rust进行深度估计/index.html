<!doctype html><html lang=zh-CN><head><title>æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡ | ByeIOÂ·å¼€å‘è€…åšå®¢</title><meta content=ByeIOÂ·å¼€å‘è€…åšå®¢ property=og:site_name><meta content=article property=og:type><meta content=æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡ property=og:title><meta content=//articles/docs/æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡/ property=og:url><meta content=ä½¿ç”¨rustå®ç°åŸºäºREMODEæ•°æ®é›†çš„å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡. property=og:description><meta content=/processed_images/img00006.3250c5dc35a28271.webp property=og:image><meta content=summary_large_image name=twitter:card><meta content=æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡ name=twitter:title><meta content=//articles/docs/æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡/ name=twitter:url><meta content=ä½¿ç”¨rustå®ç°åŸºäºREMODEæ•°æ®é›†çš„å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡. name=twitter:description><meta content=/processed_images/img00006.3250c5dc35a28271.webp name=twitter:image><meta content=ä½¿ç”¨rustå®ç°åŸºäºREMODEæ•°æ®é›†çš„å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡. name=description><script id=ld-json type=application/ld+json>
        {
          "@context": "https://schema.org/",
          "@type": "Article",
          "headline": "æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡",
          "author": {
            "@type": "Person",
            "name": "qsbye",
            "url": "/about"
          },
          "image": "/processed_images/img00006.c4abedc898f992a6.webp",
          "datePublished": "2025-01-01T00:00:00+00:00",
          
          "description": "ä½¿ç”¨rustå®ç°åŸºäºREMODEæ•°æ®é›†çš„å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡."
        }
    </script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content="telephone=no" name=format-detection><meta content=var(--wjx-card-bg) name=theme-color><link href=/manifest.json rel=manifest><link href=/img/avatar.png rel=icon type=image/x-icon><link href=/img/avatar.png rel=apple-touch-icon><link href=/img/avatar.png rel=bookmark><link href=/img/avatar.png rel=apple-touch-icon-precomposed sizes=180x180><script src=/libs/jquery/jquery-3.7.1.min.js></script><script src=/libs/pjax/pjax.min.js></script><script src=/production/js/utils.js></script><link href=/production/css/blog.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link onload="this.onload=null;this.rel='stylesheet'" as=style href=/libs/snackbar/snackbar.min.css rel=preload><noscript><link href=/libs/snackbar/snackbar.min.css rel=stylesheet></noscript><script>// Added non-passive event listener
  !function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){var e,t=["scroll","wheel","touchstart","touchmove","touchenter","touchend","touchleave","mouseout","mouseleave","mouseup","mousedown","mousemove","mouseenter","mousewheel","mouseover"];if(function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}()){var n=EventTarget.prototype.addEventListener;e=n,EventTarget.prototype.addEventListener=function(n,o,r){var i,s="object"==typeof r&&null!==r,u=s?r.capture:r;(r=s?function(e){var t=Object.getOwnPropertyDescriptor(e,"passive");return t&&!0!==t.writable&&void 0===t.set?Object.assign({},e):e}(r):{}).passive=void 0!==(i=r.passive)?i:-1!==t.indexOf(n)&&!0,r.capture=void 0!==u&&u,e.call(this,n,o,r)},EventTarget.prototype.addEventListener._original=e}});</script><script>((win) => {
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return;
        const now = new Date();
        const expiryDay = ttl * 86400000;
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        };
        localStorage.setItem(key, JSON.stringify(item));
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key);

        if (!itemStr) {
          return undefined;
        }
        const item = JSON.parse(itemStr);
        const now = new Date();

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key);
          return undefined;
        }
        return item.value;
      },
    };

    win.getScript = (url) =>
      new Promise((resolve, reject) => {
        const script = document.createElement("script");
        script.src = url;
        script.async = true;
        script.onerror = reject;
        script.onload = script.onreadystatechange = function () {
          const loadState = this.readyState;
          if (loadState && loadState !== "loaded" && loadState !== "complete")
            return;
          script.onload = script.onreadystatechange = null;
          resolve();
        };
        document.head.appendChild(script);
      });

    win.getCSS = (url, id = false) =>
      new Promise((resolve, reject) => {
        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = url;
        if (id) link.id = id;
        link.onerror = reject;
        link.onload = link.onreadystatechange = function () {
          const loadState = this.readyState;
          if (loadState && loadState !== "loaded" && loadState !== "complete")
            return;
          link.onload = link.onreadystatechange = null;
          resolve();
        };
        document.head.appendChild(link);
      });

    win.activateDarkMode = function () {
      document.documentElement.setAttribute("data-theme", "dark");
      document.documentElement.classList.add("color-scheme-dark");
      wjx.initThemeColor();
    };
    win.activateLightMode = function () {
      document.documentElement.setAttribute("data-theme", "light");
      document.documentElement.classList.remove("color-scheme-dark");
      wjx.initThemeColor();
    };
    const t = saveToLocal.get("theme");

    const isDarkMode = window.matchMedia(
      "(prefers-color-scheme: dark)"
    ).matches;
    const isLightMode = window.matchMedia(
      "(prefers-color-scheme: light)"
    ).matches;
    const isNotSpecified = window.matchMedia(
      "(prefers-color-scheme: no-preference)"
    ).matches;
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified;

    if (t === undefined) {
      if (isLightMode) activateLightMode();
      else if (isDarkMode) activateDarkMode();
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date();
        const hour = now.getHours();
        const isNight = hour <= 6 || hour >= 18;
        isNight ? activateDarkMode() : activateLightMode();
      }
      window
        .matchMedia("(prefers-color-scheme: dark)")
        .addListener(function (e) {
          if (saveToLocal.get("theme") === undefined) {
            e.matches ? activateDarkMode() : activateLightMode();
          }
        });
    } else if (t === "light") activateLightMode();
    else activateDarkMode();

    if ("system" === "dark")
      activateDarkMode();
    else activateLightMode();

    const asideStatus = saveToLocal.get("aside-status");
    if (asideStatus !== undefined) {
      if (asideStatus === "hide") {
        document.documentElement.classList.add("hide-aside");
      } else {
        document.documentElement.classList.remove("hide-aside");
      }
    }
  })(window);</script><script data-pace-options='{ "restartOnRequestAfter":false,"eventLag":false}' src=/libs/pace/pace.min.js></script><script defer src=/libs/clipboard/clipboard.min.js></script><script src=/libs/countup/countup.js></script><link href=/icon/font.css rel=stylesheet><style>[data-theme=light]{--wjx-theme:#425aef!important;--wjx-theme-op:#425aef23!important;--wjx-theme-op-deep:#425aefdd!important;--wjx-theme-none:#425aef00!important}[data-theme=dark]{--wjx-theme:#f2b94b!important;--wjx-theme-op:#f2b94b23!important;--wjx-theme-op-deep:#f2b94bdd!important;--wjx-theme-none:#f2b94b00!important}:root{--halo-comment-widget-component-card-bg:var(--wjx-card-bg);--halo-comment-widget-component-theme-op:var(--wjx-theme-op);--halo-comment-widget-component-card-border:var(--wjx-card-border);--halo-comment-widget-component-shadow-border:var(--wjx-shadow-border);--halo-comment-widget-component-secondtext:var(--wjx-secondtext);--halo-comment-widget-component-lighttext:var(--wjx-lighttext);--halo-comment-widget-component-secondbg:var(--wjx-secondbg);--halo-comment-widget-component-fontcolor:var(--wjx-fontcolor);--halo-comment-widget-component-main:var(--wjx-main);--halo-comment-widget-component-background:var(--wjx-background);--halo-comment-widget-component-white:var(--wjx-white);--halo-comment-widget-component-shadow-black:var(--wjx-shadow-black)}#page{--halo-comment-widget-component-padding:1rem}.color-scheme-dark,.dark,[data-color-scheme=dark]{--halo-search-widget-color-modal-layer:var(--wjx-maskbgdeep);--halo-search-widget-color-modal-content-bg:var(--wjx-card-bg);--halo-search-widget-color-form-input:#fffc;--halo-search-widget-color-form-input-placeholder:#6b7280d9;--halo-search-widget-color-form-input-bg:var(--wjx-card-bg);--halo-search-widget-color-form-divider:#bbbbbb0f;--halo-search-widget-color-result-item-bg:var(--wjx-card-bg);--halo-search-widget-color-result-item-hover-bg:#90939914;--halo-search-widget-color-result-item-title:#fffc;--halo-search-widget-color-result-item-content:#ffffff82;--halo-search-widget-color-command-kbd-item:#c0c4ccb3;--halo-search-widget-color-command-kbd-border:#bbbbbb0f;--halo-search-widget-color-result-empty:#6b7280d9}[data-theme=light]{--halo-search-widget-color-result-item-title:#4b5563}</style><script id=site-config>var GLOBAL_CONFIG = {
        
                
        
        
        
        
        htmlType: "post",
        postTitle: "æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡",
        isPost: true,
        isHome: false,
        passageTip: {
            enable: true,
            day: 60,
        },
        copyright: {
            enable: false,
            limitCount: 10,
            languages: {
                author: " ä½œè€…ï¼šqsbye",
                link: " é“¾æ¥ï¼š",
                source: " æ¥æºï¼šByeIOÂ·å¼€å‘è€…åšå®¢",
                info: " æç¤ºï¼šè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„å¹¶ä¿ç•™åŸæ–‡é“¾æ¥ã€‚"
            }
        },
        lightbox: 'fancybox',
        rightMenuEnable: true,
        lazyload: {
            enable: true,
            error: "/img/404.svg"
        },
        isFriendLinksInFooter: true,
        loadingBox: true,
        progress_bar: true,
        navMusicEnable: false,
        isMusic: false,
        helloText: ["ğŸ¤–ï¸ æ•°ç ç§‘æŠ€çˆ±å¥½è€…","ğŸ”¯ å…¨æ ˆæ¶æ„éƒ½åœ¨è¡Œ","ğŸ  æ™ºèƒ½å®¶å±…å°èƒ½æ‰‹","ğŸ¤ ç§‘ç ”ç§‘æ™®ä¸¤ä¸è¯¯","ğŸµ ä¸šä½™åŸåˆ›éŸ³ä¹äºº","ğŸƒ æ–‡è‰ºé’å¹´ç»†èŠ‚æ§","ğŸ” æ¢ç´¢ä¸–ç•Œæ¶‰çŒå¹¿","ğŸ¤› çƒ­çˆ±åˆ†äº«äº¤æœ‹å‹"],
        profileStyle: "one",
        enable: true,
        keyboard: true,
        date_suffix: {
            just: 'åˆšåˆš',
            min: 'åˆ†é’Ÿå‰',
            hour: 'å°æ—¶å‰',
            day: 'å¤©å‰',
            month: 'ä¸ªæœˆå‰'
        },
        Snackbar: {
            chs_to_cht: "ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",
            cht_to_chs: "ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",
            day_to_night: "ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",
            night_to_day: "ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",
            bgLight: "#425AEF",
            bgDark: "#f2b94b",
            position: "top-center"
        },
        translate: {
            defaultEncoding: "2",
            translateDelay: 0,
            msgToTraditionalChinese: "ç¹",
            msgToSimplifiedChinese: "ç®€",
            rightMenuMsgToTraditionalChinese: "è½‰ç‚ºç¹é«”",
            rightMenuMsgToSimplifiedChinese: "è½¬ä¸ºç®€ä½“"
        },
        prism: {
            enable: true,
            enable_title: true,
            enable_hr: true,
            enable_line: true,
            enable_copy: true,
            enable_expander: true,
            prism_limit: 330,
            enable_height_limit: false
        },
        
        source: {
            power: {
                powerLink: "/",
                showNum: 3
            },
            links: {
                linksUrl: "/friends",
                linksNum: 3
            },
            jQuery: '/libs/jquery/jquery.min.js',
            justifiedGallery: {
                js: '/libs/justified-gallery/fjGallery.min.js',
                css: '/libs/justified-gallery/fjGallery.css'
            },
            fancybox: {
                js: '/libs/fancybox/jquery.fancybox.min.js',
                css: '/null'
            },
            comments: {
                use: "twikoo",
                maxBarrage: 1,
                barrageTime: 4000,
                mailMd5: "",
                lazyload: false,
                textarea: "el-textarea__inner"
            },
            post: {
                dynamicBackground: true
            },
            tool: {
                switch: false
            },
            postAi: {
                
                gptName: "æœ¬åœ°",
                modeName: "local"
            },twikoo: {
                js: "/libs/twikoo/twikoo.all.min.js",
                twikooUrl: "https://your-api-url",
            },
            footer: {
                default_enable: true
            },
            about: {
                
                rewardList: [],
                rewardAmount: 10
            }
        }
    };</script><style id=wjx-theme-styles>:root{--wjx-main:var(--wjx-theme)!important;--wjx-main-op:var(--wjx-theme-op)!important;--wjx-main-op-deep:var(--wjx-theme-op-deep)!important;--wjx-main-op-light:var(--wjx-theme-op-light)!important;--wjx-main-none:var(--wjx-theme-none)!important}</style><script>document.addEventListener('pjax:send', function () {
      // removeEventListener toc scroll
      window.removeEventListener('scroll', window.tocScrollFn);
      typeof preloader === 'object' && preloader.initLoading();
      
      if (window.aplayers) {
          for (let i = 0; i < window.aplayers.length; i++) {
              if (!window.aplayers[i].options.fixed) {
                  window.aplayers[i].destroy()
              }
          }
      }
      
      typeof typed === 'object' && typed.destroy();
      typeof window.initializationRegistry === 'object' && window.initializationRegistry.clear();
      
      //reset readmode
      const $bodyClassList = document.body.classList
      $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
  })
  document.addEventListener('pjax:complete', function () {
      window.refreshFn();
      
      document.querySelectorAll('script[data-pjax]').forEach(item => {
                  const newScript = document.createElement('script')
                  const content = item.text || item.textContent || item.innerHTML || ""
                  Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
                  newScript.appendChild(document.createTextNode(content))
                  item.parentNode.replaceChild(newScript, item)
              }
      );

      typeof chatBtnFn === 'function' && chatBtnFn();
      typeof panguInit === 'function' && panguInit();
      
      // google analytics
      typeof gtag === 'function' && gtag('config', '', {
          'page_path': window.location.pathname
      });
      
      // baidu analytics
      typeof _hmt === 'object' && _hmt.push(['_trackPageview', window.location.pathname]);
      
      typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting();
      
      // Analytics
      if (false) {
          MtaH5.pgv()
      }
      
      // prismjs
      typeof Prism === 'object' && Prism.highlightAll();
      
      typeof preloader === 'object' && preloader.endLoading();
  })
  document.addEventListener('pjax:error', (e) => {
      if (e.request.status === 404 || e.request.status === 500) {
          window.location.href = e.request.responseURL;
      }
  })</script><script data-pjax src=/production/js/main.js></script><script>let initTop = 0
  let isChatShow = true
  const innerHeight = window.innerHeight + 0
  window.addEventListener('scroll', btf.throttle(function (e) {
    const $rightside = document.getElementById('rightside')

    const $header = document.getElementById('page-header')
    const $cookies_window = document.getElementById('cookies-window')
    const isChatBtnHide = typeof chatBtnHide === 'function'
    const isChatBtnShow = typeof chatBtnShow === 'function'
  
    const currentTop = window.scrollY || document.documentElement.scrollTop
    // æ‰¾åˆ°æ»šåŠ¨æ–¹å‘ true is down & false is up
    const isDown = currentTop > initTop
    initTop = currentTop
    if (currentTop > 0) {
        if (isDown) {
            if ($header.classList.contains('nav-visible')) $header.classList.remove('nav-visible')
            if (isChatBtnShow && isChatShow === true) {
                chatBtnHide()
                isChatShow = false
            }
        } else {
            if (!$header.classList.contains('nav-visible')) $header.classList.add('nav-visible')
            if (isChatBtnHide && isChatShow === false) {
                chatBtnShow()
                isChatShow = true
            }
        }
        $header.classList.add('nav-fixed')
        if($cookies_window!=null && $cookies_window!=''){
            $cookies_window.classList.add('cw-hide')
        }
        if ($rightside && window.getComputedStyle($rightside).getPropertyValue('opacity') === '0') {
            $rightside.style.cssText = 'opacity: 0.8; transform: translateX(-58px)'
        }
    } else {
        if (currentTop === 0) {
            $header.classList.remove('nav-fixed', 'nav-visible')
        }
        $rightside.style.cssText = "opacity: ''; transform: ''"
    }
    if (document.body.scrollHeight <= innerHeight) {
        $rightside.style.cssText = 'opacity: 0.8; transform: translateX(-58px)'
    }
  }, 200))</script><script defer src=/libs/katex/katex.min.js></script><body><style>#loading-box{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#loading-box .loading-bg{background:var(--wjx-card-bg);z-index:1999;opacity:1;pointer-events:all;width:100%;height:100%;transition:all .2s;animation:.3s backwards showLoading;display:flex;position:fixed}#loading-box.loaded .loading-bg{pointer-events:none;transition:all .2s;animation:.3s forwards hideLoading}#loading-box .loading-img{width:100px;height:100px;margin:auto;animation-name:loadingAction;animation-duration:.2s;animation-iteration-count:infinite;animation-direction:alternate;overflow:hidden}#loading-box .loading-image-dot{background:#6bdf8f;border:6px solid #fff;border-radius:50%;width:30px;height:30px;position:absolute;top:50%;left:50%;-webkit-transform:translate(18px,24px);-moz-transform:translate(18px,24px);-ms-transform:translate(18px,24px);-o-transform:translate(18px,24px);transform:translate(18px,24px)}@keyframes loadingAction{0%{opacity:1}to{opacity:.6}}@keyframes hideLoading{0%{opacity:1}to{opacity:0}}@keyframes showLoading{0%{opacity:0}to{opacity:1}}</style><div id=loading-box onclick=wjx.hideLoading()><div class=loading-bg><picture class=loading-img style=border-radius:50%;width:100px;height:100px><source media="(min-width: 1em)" srcset=/processed_images/logo.21eeb8b123e2a315.avif><img alt=Loading decoding=async loading=lazy src=/processed_images/logo.caf14bfbf942dbfc.webp><noscript><img decoding=async loading=lazy src=/processed_images/logo.caf14bfbf942dbfc.webp></noscript></picture><div class=loading-image-dot></div></div></div><script>var preloader = {
            endLoading: () => {
                //- document.body.style.overflow = 'auto';
                document.getElementById('loading-box').classList.add("loaded")
            },
            initLoading: () => {
                //- document.body.style.overflow = '';
                document.getElementById('loading-box').classList.remove("loaded")
            }
        }
        window.addEventListener('load', preloader.endLoading())
        setTimeout(function () {
            preloader.endLoading();
        }, 3000)</script><div id=an_music_bg></div><div class=post data-type=post id=body-wrap><header class=post-bg id=page-header><nav class=show id=nav><div id=nav-group><div id=blog_name><div class=back-home-button tabindex=-1><i class="nav-icon back-home-button-icon icon-apps-fill" style=font-size:1rem></i><div class=back-menu-list-groups><div class=back-menu-list-group><div class=back-menu-list-title>ä½œå“</div><div class=back-menu-list><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a></div></div></div></div><a class="nav-item icon-home" data-pjax href=/ id=site-name title=è¿”å›åšå®¢ä¸»é¡µ> <span>ByeIOÂ·å¼€å‘è€…åšå®¢</span> </a></div><div id=page-name-mask><div id=page-name><a clase=nav-item id=page-name-text onclick=btf.scrollToDest(0,500)> æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡ </a></div></div><div id=menus><div class=menus_items><div class=menus_item><button class="site-page nav-item"><span>æ–‡åº“</span></button><div class=menus_item_child><div class=recursion_menus_item><a class="site-page child nav-item" href=/archives> <i class=icon-book-open style=font-size:.9em></i> <span>å…¨éƒ¨æ–‡ç« </span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/categories> <i class=icon-folder-open style=font-size:.9em></i> <span>åˆ†ç±»åˆ—è¡¨</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/tags> <i class=icon-tags style=font-size:.9em></i> <span>æ ‡ç­¾åˆ—è¡¨</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=javascript:toRandomPost()> <i class=icon-artstation style=font-size:.9em></i> <span>éšæœºæ–‡ç« </span> </a></div></div></div><div class=menus_item><a class="site-page nav-item" href=/tags/work> <span>æ¨è</span> </a><div class="menus_item_child vertical_nav"><div class=recursion_menus_item><a class="site-page child nav-item" href=/articles/docs/readme> <i class=icon-music style=font-size:.9em></i> <span>åšå®¢ä¸»é¢˜ä»‹ç»</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/articles/misc/lorem-ipsum> <i class=icon-music style=font-size:.9em></i> <span>Lorem Ipsum</span> </a></div></div></div><div class=menus_item><button class="site-page nav-item"><span>å‹é“¾</span></button><div class=menus_item_child><div class=recursion_menus_item><a class="site-page child nav-item" href=/friends> <i class=icon-link style=font-size:.9em></i> <span>å‹é“¾åˆ—è¡¨</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=javascript:travelling()> <i class=icon-paper-plane style=font-size:.9em></i> <span>éšæœºå‘ç°</span> </a></div></div></div><div class=menus_item><button class="site-page nav-item"><span>æˆ‘çš„</span></button><div class=menus_item_child><div class=recursion_menus_item><a class="site-page child nav-item" href=/about> <i class=icon-rocket style=font-size:.9em></i> <span>å…³äºæœ¬äºº</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/equipment> <i class=icon-artstation style=font-size:.9em></i> <span>æˆ‘çš„è£…å¤‡</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/tags/project> <i class=icon-lightbulb style=font-size:.9em></i> <span>æˆ‘çš„é¡¹ç›®</span> </a></div></div></div></div></div><div id=nav-right><div class=nav-button id=randomPost_button><button class="site-page nav-item" href=javascript:void(0); onclick=toRandomPost() title=éšæœºæ–‡ç« ><i class="nav-icon icon-dice"></i></button></div><div class=nav-button id=darkmode_button><button class="site-page console_switchbutton nav-item" title="åˆ‡æ¢æ¨¡å¼ - æ—¥å¤œäº¤æ›¿ï¼Œé»‘ç™½äº’æ¢ã€‚" href=javascript:void(0); onclick=navFn.switchDarkMode();><i class="nav-icon icon-moon-clear-fill" style=font-size:1rem></i></button></div><div class=nav-button id=nav-console><button class="site-page console_switchbutton nav-item" href=javascript:void(0); onclick=wjx.showConsole() title=æ˜¾ç¤ºä¸­æ§å°><i class="nav-icon icon-dashboard"></i></button></div><div class=nav-button id=nav-totop onclick=btf.scrollToDest(0,500)><button class="totopbtn nav-item"><i class="nav-icon icon-arrow-up" style=font-size:1rem></i><span id=percent>0</span></button></div><div id=toggle-menu><button class="site-page nav-item"><i class="nav-icon icon-bars"></i></button></div></div></div></nav><div class="coverdiv loaded" id=coverdiv><img alt=cover class=nolazyload decoding=async id=post-cover loading=lazy src=/processed_images/img00006.c4abedc898f992a6.webp></div><div id=post-info><div id=post-firstinfo><div class=meta-firstline><a class=post-meta-original href=/copyright title=è¯¥æ–‡ç« ä¸ºåŸåˆ›æ–‡ç« ï¼Œæ³¨æ„ç‰ˆæƒåè®®>åŸåˆ›</a><span class=post-meta-categories> <a href=/categories/theme/ title=ä¸»é¢˜> ä¸»é¢˜ </a> </span><div class=tag_share><div class=post-meta__tag-list><a class=post-meta__tags href=/tags/blog/ title=åšå®¢> <span class="tags-name tags-punctuation">åšå®¢</span> </a><a class=post-meta__tags href=/tags/docs/ title=æ–‡æ¡£> <span class="tags-name tags-punctuation">æ–‡æ¡£</span> </a><a class=post-meta__tags href=/tags/featured/ title=å¿…çœ‹> <span class="tags-name tags-punctuation">å¿…çœ‹</span> </a><a class=post-meta__tags href=/tags/hot/ title=çƒ­é—¨> <span class="tags-name tags-punctuation">çƒ­é—¨</span> </a></div></div></div></div><h1 class=post-title>æŠ˜è…¾ç¬”è®°[14]-ä½¿ç”¨rustè¿›è¡Œæ·±åº¦ä¼°è®¡</h1><div id=post-meta><div class=meta-secondline><span class=post-meta-author data-flag-title=æ–‡ç« ä½œè€… title=æ–‡ç« ä½œè€…> <i class="icon-zuozhe post-meta-icon"></i>qsbye </span><span class=post-meta-wordcount> <i class="icon-file-word post-meta-icon" title=å­—æ•°></i> <span class=post-meta-label>å­—æ•°:</span> <span class=word-count>2773</span> <span class=post-meta-separator></span> <i class="icon-clock post-meta-icon" title=é˜…è¯»è€—æ—¶></i> <span class=post-meta-label>é˜…è¯»è€—æ—¶:</span> <span> 14 åˆ†é’Ÿ</span> </span><span class=post-meta-date> <i class="icon-calendar-days post-meta-icon"></i> <time title="2025-01-01 00:00:00" datetime=2025-01-01> 2025/01/01 </time> </span><span class=post-meta-wechat title=è¯¥æ–‡ç« åœ¨åšå®¢é¦–å‘> <i class="icon-rss post-meta-icon"></i>åšå®¢ç‹¬äº« </span><a class=post-meta-pv data-flag-title=çƒ­åº¦ title=çƒ­åº¦> <i class="icon-fire post-meta-icon"></i> <span class=post-meta-label>çƒ­åº¦:</span> <span id=twikoo_visitors> <i class="icon-spinner fa-spin"></i> </span> </a><a class=post-meta-commentcount data-flag-title=è¯„è®ºæ•° href=#post-comment title=è¯„è®ºæ•°> <i class="icon-chat--fill post-meta-icon" style=font-size:17px></i> <span class=post-meta-label>è¯„è®º:</span> <span id=twikoo-count> <i class="icon-spinner fa-spin"></i> </span> </a></div></div></div><section class="main-hero-waves-area waves-area"><svg viewbox="0 24 150 28" class=waves-svg preserveaspectratio=none shape-rendering=auto xlink=http://www.w3.org/1999/xlink xmlns=http://www.w3.org/2000/svg><defs><path d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z" id=gentle-wave></path></defs><g class=parallax><use href=#gentle-wave x=48 y=0></use><use href=#gentle-wave x=48 y=3></use><use href=#gentle-wave x=48 y=5></use><use href=#gentle-wave x=48 y=7></use></g></svg></section></header><main class="layout right-aside" id=content-inner><div id=post><div id=abstract-container><div class=abstract-title><i class=icon-bilibili></i><div class=abstract-title-text>æ–‡ç« æ‘˜è¦</div><div id=abstract-tag>æœ¬åœ°</div></div><div id=abstract-content style=display:block>ä½¿ç”¨rustå®ç°åŸºäºREMODEæ•°æ®é›†çš„å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡.</div><div class=abstract-btn-box><div class=abstract-btn-item id=abstract-intro>ä»‹ç»è‡ªå·±</div><div class=abstract-btn-item id=abstract-generate>ç”Ÿæˆæœ¬æ–‡ç®€ä»‹</div><div class=abstract-btn-item id=abstract-recommend>æ¨èç›¸å…³æ–‡ç« </div><div class=abstract-btn-item id=abstract-home>å‰å¾€ä¸»é¡µ</div><div class=abstract-btn-item id=abstract-hide style=margin-left:auto>éšè—æœ¬æ‘˜è¦</div></div></div><div class="note simple warning" data-tip-enable=true data-update-date=2025-01-01 id=passage-tip></div><article class="post-content line-numbers" id=article-container><h2 id=zhai-yao>æ‘˜è¦</h2><p>ä½¿ç”¨rustå®ç°åŸºäºREMODEæ•°æ®é›†çš„å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡. Implement dense depth estimation for a monocular camera with a known trajectory based on the REMODE dataset using Rust.<h2 id=guan-jian-ci>å…³é”®è¯</h2><p>rust;slam;REMODE;epipolar;depth evaludate;<h2 id=guan-jian-xin-xi>å…³é”®ä¿¡æ¯</h2><p><strong>é¡¹ç›®åœ°å€</strong>:[https://github.com/ByeIO/slambook2.rs]<pre class=language-toml data-lang=toml><code class=language-toml data-lang=toml>[package]
name = "exp65-rust-ziglang-slambook2"
version = "0.1.0"
edition = "2021"

[dependencies]
env_logger = { version = "0.11.6", default-features = false, features = [
    "auto-color",
    "humantime",
] }

# éšæœºæ•°
rand = "0.8.5"
rand_distr = "0.4.3"
fastrand = "2.3.0"

# çº¿æ€§ä»£æ•°
nalgebra = { version = "0.33.2",features = ["rand"]}
ndarray = "0.16.1"

# winit
wgpu = "23.0.1"
winit = "0.30.8"

# egui
eframe = "0.30.0"
egui = { version = "0.30.0", features = [
    "default"
]}
egui_extras = {version = "0.30.0",features = ["default", "image"]}

# three_d
three-d = {path = "./static/three-d" , features=["egui-gui"] }
three-d-asset = {version = "0.9",features = ["hdr", "http"] }

# sophus
sophus = { version = "0.11.0" }
sophus_autodiff = { version = "0.11.0" }
sophus_geo = "0.11.0"
sophus_image = "0.11.0"
sophus_lie = "0.11.0"
sophus_opt = "0.11.0"
sophus_renderer = "0.11.0"
sophus_sensor = "0.11.0"
sophus_sim = "0.11.0"
sophus_spline = "0.11.0"
sophus_tensor = "0.11.0"
sophus_timeseries = "0.11.0"
sophus_viewer = "0.11.0"
tokio = "1.43.0"
approx = "0.5.1"
bytemuck = "1.21.0"
thingbuf = "0.1.6"

# rust-cvè®¡ç®—æœºè§†è§‰
cv = { version = "0.6.0" , features = ["default"] }
cv-core = "0.15.0"
cv-geom = "0.7.0"
cv-pinhole = "0.6.0"
akaze = "0.7.0"
eight-point = "0.8.0"
lambda-twist = "0.7.0"
image = "0.25.5"
imageproc = "0.25.0"

# æœ€å°äºŒä¹˜ä¼˜åŒ–
gomez = "0.5.0"

# å›¾ä¼˜åŒ–
factrs = { version = "0.2.0", features = [] }
gs-rs = { version = "0.1.0", path = "./static/gs-rs" }

# ORBè§’ç‚¹æ£€æµ‹
bye_orb_rs = { version = "0.1.1", path = "./static/bye_orb_rs" }

# è¯è¢‹
bye_abow_rs = { version = "0.1.0", path = "./static/bye_abow_rs" }

# ä¾èµ–è¦†ç›–
[patch.crates-io]
pulp = { path = "./static/pulp" }
mio = { path = "./static/mio", version = "1.0.3" }
</code></pre><h2 id=yuan-li-jian-jie>åŸç†ç®€ä»‹</h2><h3 id=remodeshu-ju-ji-jian-jie>REMODEæ•°æ®é›†ç®€ä»‹</h3><p>[https://blog.csdn.net/qq_36122936/article/details/89002724] [https://www.cnblogs.com/zonghaochen/p/8858585.html] [http://rpg.ifi.uzh.ch/datasets/remode_test_data.zip] REMODEæ•°æ®é›†æ˜¯ä¸€ä¸ªç”¨äºå•ç›®ç›¸æœºå®æ—¶ä¸‰ç»´é‡å»ºç ”ç©¶çš„æ•°æ®é›†ï¼Œä¸»è¦åŒ…å«å•ç›®RGBå›¾åƒåŠå…¶å¯¹åº”çš„ä½å§¿ä¿¡æ¯ã€‚ REMODEæ•°æ®é›†ç”±è‹é»ä¸–å¤§å­¦çš„ç ”ç©¶äººå‘˜åœ¨è¿›è¡Œå•ç›®RGBç›¸æœºå®æ—¶ä¸‰ç»´é‡å»ºç ”ç©¶æ—¶é‡‡é›†ã€‚æ•°æ®é›†ä¸­çš„å›¾åƒé€šå¸¸ç”±æ— äººæœºé‡‡é›†çš„å•ç›®ä¿¯è§†å›¾åƒç»„æˆã€‚ æ•°æ®é›†åŒ…å«ä¸€ç³»åˆ—å•ç›®RGBå›¾åƒï¼Œä¾‹å¦‚åœ¨REMODEæµ‹è¯•æ•°æ®é›†ä¸­ï¼Œå…±æœ‰çº¦200å¼ å›¾åƒã€‚ æ¯å¼ å›¾åƒéƒ½é…æœ‰çœŸå®ä½å§¿ä¿¡æ¯ï¼Œè¿™äº›ä½å§¿ä¿¡æ¯é€šå¸¸ä»¥æ–‡æœ¬æ–‡ä»¶çš„å½¢å¼è®°å½•ã€‚<h3 id=chou-mi-shen-du-gu-ji-jian-jie>ç¨ å¯†æ·±åº¦ä¼°è®¡ç®€ä»‹</h3><p>ç¨ å¯†æ·±åº¦ä¼°è®¡æ˜¯è®¡ç®—æœºè§†è§‰é¢†åŸŸä¸­çš„ä¸€é¡¹é‡è¦æŠ€æœ¯ï¼Œæ—¨åœ¨ä¸ºå›¾åƒä¸­çš„æ¯ä¸ªåƒç´ éƒ½ä¼°è®¡å‡ºä¸€ä¸ªæ·±åº¦å€¼ï¼Œä»è€Œç”Ÿæˆä¸€å¹…å®Œæ•´çš„æ·±åº¦å›¾ï¼Œä»¥è·å–åœºæ™¯çš„ä¸‰ç»´ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯å…¶ç®€ä»‹ï¼š<h4 id=ding-yi-yu-mu-biao>å®šä¹‰ä¸ç›®æ ‡</h4><ul><li>ä¼ ç»Ÿçš„å›¾åƒæ˜¯äºŒç»´çš„ï¼Œä»…åŒ…å«é¢œè‰²å’Œçº¹ç†ç­‰ä¿¡æ¯ï¼Œè€Œç¨ å¯†æ·±åº¦ä¼°è®¡çš„ç›®æ ‡å°±æ˜¯åœ¨äºŒç»´å›¾åƒçš„åŸºç¡€ä¸Šï¼Œä¸ºæ¯ä¸ªåƒç´ èµ‹äºˆä¸€ä¸ªæ·±åº¦å€¼ï¼Œä½¿å¾—è®¡ç®—æœºèƒ½å¤Ÿç†è§£åœºæ™¯ä¸­ç‰©ä½“çš„è¿œè¿‘å…³ç³»ï¼Œæ¢å¤å‡ºåœºæ™¯çš„ä¸‰ç»´ç»“æ„ã€‚æ·±åº¦å›¾ä¸­çš„æ¯ä¸ªåƒç´ å€¼ä»£è¡¨äº†è¯¥åƒç´ æ‰€å¯¹åº”çš„åœºæ™¯ç‚¹ä¸ç›¸æœºä¹‹é—´çš„è·ç¦»ï¼Œè·ç¦»å€¼è¶Šå¤§ï¼Œè¡¨ç¤ºè¯¥ç‚¹ç¦»ç›¸æœºè¶Šè¿œï¼Œåä¹‹åˆ™è¶Šè¿‘ã€‚</ul><h4 id=fang-fa-fen-lei>æ–¹æ³•åˆ†ç±»</h4><ul><li><strong>åŸºäºç«‹ä½“è§†è§‰çš„æ–¹æ³•</strong>ï¼šæ¨¡æ‹Ÿäººç±»åŒçœ¼è§†è§‰åŸç†ï¼Œä½¿ç”¨ä¸¤ä¸ªæˆ–å¤šä¸ªç›¸æœºä»ä¸åŒè§†è§’æ‹æ‘„åŒä¸€åœºæ™¯ï¼Œé€šè¿‡è®¡ç®—ä¸åŒå›¾åƒä¹‹é—´çš„è§†å·®æ¥ä¼°è®¡æ·±åº¦ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å¯¹å·¦å³ä¸¤å¹…å›¾åƒä¸­çš„å¯¹åº”ç‚¹è¿›è¡ŒåŒ¹é…ï¼Œæ ¹æ®ä¸‰è§’æµ‹é‡åŸç†ï¼Œåˆ©ç”¨ç›¸æœºçš„ç›¸å¯¹ä½ç½®å’Œå§¿æ€ä»¥åŠåŒ¹é…ç‚¹çš„è§†å·®æ¥è®¡ç®—åœºæ™¯ç‚¹çš„æ·±åº¦ã€‚<li><strong>åŸºäºå•ç›®è§†è§‰çš„æ–¹æ³•</strong>ï¼šä»…ä½¿ç”¨å•ç›®ç›¸æœºæ‹æ‘„çš„å›¾åƒæ¥ä¼°è®¡æ·±åº¦ã€‚è¿™ç§æ–¹æ³•é€šå¸¸éœ€è¦å€ŸåŠ©ä¸€äº›å…ˆéªŒçŸ¥è¯†æˆ–å‡è®¾ï¼Œä¾‹å¦‚åœºæ™¯çš„å‡ ä½•ç»“æ„ã€ç‰©ä½“çš„è¿åŠ¨ä¿¡æ¯ã€å›¾åƒçš„çº¹ç†å’Œæ˜æš—ç­‰çº¿ç´¢ã€‚å¦‚åˆ©ç”¨å›¾åƒåºåˆ—ä¸­ç‰©ä½“çš„è¿åŠ¨ä¿¡æ¯ï¼Œç»“åˆç›¸æœºçš„è¿åŠ¨æ¨¡å‹å’Œå‡ ä½•çº¦æŸï¼Œé€šè¿‡å¯¹å¤šå¸§å›¾åƒçš„åˆ†ææ¥ä¼°è®¡æ·±åº¦ã€‚<li><strong>åŸºäºå¤šæ¨¡æ€çš„æ–¹æ³•</strong>ï¼šèåˆå¤šç§ä¼ æ„Ÿå™¨çš„æ•°æ®æ¥è¿›è¡Œæ·±åº¦ä¼°è®¡ï¼Œå¦‚å°†æ¿€å…‰é›·è¾¾ï¼ˆLiDARï¼‰è·å–çš„æ·±åº¦ä¿¡æ¯ä¸ç›¸æœºå›¾åƒæ•°æ®ç›¸ç»“åˆã€‚æ¿€å…‰é›·è¾¾å¯ä»¥ç›´æ¥æµ‹é‡åœºæ™¯ä¸­ç‰©ä½“çš„è·ç¦»ï¼Œä½†æ•°æ®ç¨€ç–ä¸”æˆæœ¬è¾ƒé«˜ï¼›ç›¸æœºå›¾åƒåˆ™å…·æœ‰ä¸°å¯Œçš„çº¹ç†ä¿¡æ¯ï¼Œä½†ç¼ºä¹æ·±åº¦ä¿¡æ¯ã€‚é€šè¿‡å°†ä¸¤è€…çš„æ•°æ®è¿›è¡Œèåˆï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨å„è‡ªçš„ä¼˜åŠ¿ï¼Œæé«˜æ·±åº¦ä¼°è®¡çš„ç²¾åº¦å’Œå¯é æ€§ã€‚</ul><h4 id=tiao-zhan-yu-nan-dian>æŒ‘æˆ˜ä¸éš¾ç‚¹</h4><ul><li><strong>çº¹ç†ç¼ºå¤±åŒºåŸŸ</strong>ï¼šåœ¨ä¸€äº›çº¹ç†è¾ƒå°‘æˆ–æ— çº¹ç†çš„åŒºåŸŸï¼Œå¦‚å¹³æ»‘çš„å¢™é¢ã€å¤§é¢ç§¯çš„å¤©ç©ºç­‰ï¼Œç¼ºä¹è¶³å¤Ÿçš„ç‰¹å¾ä¿¡æ¯æ¥è¿›è¡Œå‡†ç¡®çš„æ·±åº¦ä¼°è®¡ï¼Œå®¹æ˜“å¯¼è‡´æ·±åº¦å€¼ä¸å‡†ç¡®æˆ–æ¨¡ç³Šã€‚<li><strong>é®æŒ¡é—®é¢˜</strong>ï¼šå½“åœºæ™¯ä¸­å­˜åœ¨ç‰©ä½“ç›¸äº’é®æŒ¡æ—¶ï¼Œè¢«é®æŒ¡éƒ¨åˆ†çš„æ·±åº¦ä¿¡æ¯éš¾ä»¥ç›´æ¥è·å–ï¼Œéœ€è¦é€šè¿‡ä¸€äº›é¢å¤–çš„å‡è®¾æˆ–æ¨ç†æ¥ä¼°è®¡ï¼Œè¿™å¢åŠ äº†æ·±åº¦ä¼°è®¡çš„éš¾åº¦å’Œä¸ç¡®å®šæ€§ã€‚<li><strong>å…‰ç…§å˜åŒ–</strong>ï¼šå…‰ç…§æ¡ä»¶çš„å˜åŒ–ä¼šå½±å“å›¾åƒçš„ç°åº¦å’Œé¢œè‰²ä¿¡æ¯ï¼Œä»è€Œå½±å“åŸºäºå›¾åƒç‰¹å¾çš„æ·±åº¦ä¼°è®¡ç®—æ³•çš„å‡†ç¡®æ€§ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼ºå…‰æˆ–é˜´å½±ä¸‹ï¼Œå›¾åƒçš„å¯¹æ¯”åº¦å’Œçº¹ç†ç‰¹å¾å¯èƒ½ä¼šå‘ç”Ÿè¾ƒå¤§å˜åŒ–ï¼Œå¯¼è‡´åŒ¹é…é”™è¯¯æˆ–æ·±åº¦ä¼°è®¡åå·®ã€‚<li><strong>å®æ—¶æ€§è¦æ±‚</strong>ï¼šåœ¨ä¸€äº›å®æ—¶åº”ç”¨åœºæ™¯ä¸­ï¼Œå¦‚è‡ªåŠ¨é©¾é©¶å’Œæœºå™¨äººå¯¼èˆªï¼Œéœ€è¦åœ¨çŸ­æ—¶é—´å†…å®Œæˆå¤§é‡å›¾åƒçš„æ·±åº¦ä¼°è®¡ï¼Œå¯¹ç®—æ³•çš„å®æ—¶æ€§å’Œè®¡ç®—æ•ˆç‡æå‡ºäº†å¾ˆé«˜çš„è¦æ±‚ã€‚</ul><p><strong>ä»£ç ä¸­æ¶‰åŠçš„æ•°å­¦åŸç†:</strong><h4 id=1-ji-xian-sou-suo-yu-san-jiao-hua>1. <strong>æçº¿æœç´¢ä¸ä¸‰è§’åŒ–</strong></h4><ul><li><strong>æçº¿æœç´¢</strong>ï¼šåœ¨å‚è€ƒå›¾åƒå’Œå½“å‰å›¾åƒä¹‹é—´ï¼Œé€šè¿‡æçº¿çº¦æŸå¯»æ‰¾åŒ¹é…ç‚¹ã€‚æçº¿æ˜¯å‚è€ƒå›¾åƒä¸­çš„ç‚¹åœ¨å½“å‰å›¾åƒä¸­çš„æŠ•å½±çº¿ï¼Œæœç´¢èŒƒå›´ç”±æ·±åº¦å‡å€¼å’Œæ–¹å·®å†³å®šã€‚<li><strong>ä¸‰è§’åŒ–</strong>ï¼šé€šè¿‡ä¸¤å¸§å›¾åƒä¸­çš„åŒ¹é…ç‚¹ï¼Œåˆ©ç”¨ç›¸æœºçš„ä½å§¿å˜æ¢ï¼Œè®¡ç®—ä¸‰ç»´ç‚¹çš„æ·±åº¦ã€‚å…¬å¼ä¸ºï¼š $$ d_{\text{ref}} \cdot \mathbf{f}<em>{\text{ref}} = d</em>{\text{cur}} \cdot (\mathbf{R}<em>{\text{RC}} \cdot \mathbf{f}</em>{\text{cur}}) + \mathbf{t}<em>{\text{RC}} $$ å…¶ä¸­ï¼Œ$\mathbf{f}</em>{\text{ref}}$ å’Œ $\mathbf{f}<em>{\text{cur}}$ æ˜¯å½’ä¸€åŒ–çš„åƒç´ æ–¹å‘å‘é‡ï¼Œ$\mathbf{R}</em>{\text{RC}}$ å’Œ $\mathbf{t}_{\text{RC}}$ æ˜¯ç›¸å¯¹ä½å§¿çš„æ—‹è½¬å’Œå¹³ç§»ã€‚</ul><h4 id=2-ncc-gui-yi-hua-hu-xiang-guan>2. <strong>NCCï¼ˆå½’ä¸€åŒ–äº’ç›¸å…³ï¼‰</strong></h4><ul><li><strong>NCC</strong> ç”¨äºè¡¡é‡ä¸¤ä¸ªå›¾åƒå—çš„ç›¸ä¼¼åº¦ï¼Œå…¬å¼ä¸ºï¼š $$ \text{NCC} = \frac{\sum (I_{\text{ref}} - \mu_{\text{ref}})(I_{\text{curr}} - \mu_{\text{curr}})}{\sqrt{\sum (I_{\text{ref}} - \mu_{\text{ref}})^2 \sum (I_{\text{curr}} - \mu_{\text{curr}})^2}} $$ å…¶ä¸­ï¼Œ$I_{\text{ref}}$ å’Œ $I_{\text{curr}}$ æ˜¯å‚è€ƒå›¾åƒå’Œå½“å‰å›¾åƒçš„åƒç´ å€¼ï¼Œ$\mu_{\text{ref}}$ å’Œ $\mu_{\text{curr}}$ æ˜¯å›¾åƒå—çš„å‡å€¼ã€‚</ul><h4 id=3-shen-du-lu-bo-qi>3. <strong>æ·±åº¦æ»¤æ³¢å™¨</strong></h4><ul><li><strong>æ·±åº¦æ›´æ–°</strong>ï¼šé€šè¿‡é«˜æ–¯èåˆæ›´æ–°æ·±åº¦ä¼°è®¡ï¼Œå…¬å¼ä¸ºï¼š $$ \mu_{\text{fuse}} = \frac{\sigma_{\text{curr}}^2 \cdot \mu_{\text{prev}} + \sigma_{\text{prev}}^2 \cdot \mu_{\text{curr}}}{\sigma_{\text{prev}}^2 + \sigma_{\text{curr}}^2} $$ $$ \sigma_{\text{fuse}}^2 = \frac{\sigma_{\text{prev}}^2 \cdot \sigma_{\text{curr}}^2}{\sigma_{\text{prev}}^2 + \sigma_{\text{curr}}^2} $$ å…¶ä¸­ï¼Œ$\mu_{\text{prev}}$ å’Œ $\sigma_{\text{prev}}^2$ æ˜¯ä¹‹å‰çš„æ·±åº¦å‡å€¼å’Œæ–¹å·®ï¼Œ$\mu_{\text{curr}}$ å’Œ $\sigma_{\text{curr}}^2$ æ˜¯å½“å‰ä¼°è®¡çš„æ·±åº¦å‡å€¼å’Œæ–¹å·®ã€‚</ul><h4 id=4-xiang-su-yu-xiang-ji-zuo-biao-zhuan-huan>4. <strong>åƒç´ ä¸ç›¸æœºåæ ‡è½¬æ¢</strong></h4><ul><li><strong>åƒç´ åˆ°ç›¸æœºåæ ‡</strong>ï¼šé€šè¿‡ç›¸æœºå†…å‚å°†åƒç´ åæ ‡è½¬æ¢ä¸ºç›¸æœºåæ ‡ç³»ä¸‹çš„æ–¹å‘å‘é‡ï¼Œå…¬å¼ä¸ºï¼š $$ \mathbf{p}_{\text{cam}} = \left( \frac{u - c_x}{f_x}, \frac{v - c_y}{f_y}, 1 \right) $$<li><strong>ç›¸æœºåæ ‡åˆ°åƒç´ </strong>ï¼šå°†ç›¸æœºåæ ‡ç³»ä¸‹çš„ç‚¹æŠ•å½±åˆ°åƒç´ å¹³é¢ï¼Œå…¬å¼ä¸ºï¼š $$ \mathbf{p}_{\text{px}} = \left( \frac{f_x \cdot x}{z} + c_x, \frac{f_y \cdot y}{z} + c_y \right) $$</ul><h4 id=5-shen-du-gu-ji-de-bu-que-ding-xing>5. <strong>æ·±åº¦ä¼°è®¡çš„ä¸ç¡®å®šæ€§</strong></h4><ul><li><strong>ä¸ç¡®å®šæ€§è®¡ç®—</strong>ï¼šé€šè¿‡å‡ ä½•å…³ç³»è®¡ç®—æ·±åº¦ä¼°è®¡çš„ä¸ç¡®å®šæ€§ï¼Œå…¬å¼ä¸ºï¼š $$ d_{\text{cov}} = p' - d_{\text{est}} $$ å…¶ä¸­ï¼Œ$p'$ æ˜¯é€šè¿‡æçº¿æ–¹å‘è°ƒæ•´åçš„æ·±åº¦ä¼°è®¡å€¼ï¼Œ$d_{\text{est}}$ æ˜¯å½“å‰çš„æ·±åº¦ä¼°è®¡å€¼ã€‚</ul><h4 id=6-shen-du-tu-ping-gu>6. <strong>æ·±åº¦å›¾è¯„ä¼°</strong></h4><ul><li><strong>è¯¯å·®è®¡ç®—</strong>ï¼šé€šè¿‡æ¯”è¾ƒçœŸå®æ·±åº¦å›¾å’Œä¼°è®¡æ·±åº¦å›¾ï¼Œè®¡ç®—å¹³å‡è¯¯å·®å’Œå¹³æ–¹è¯¯å·®ï¼Œå…¬å¼ä¸ºï¼š $$ \text{error} = d_{\text{truth}} - d_{\text{estimate}} $$ $$ \text{ave_error} = \frac{\sum \text{error}}{N} $$ $$ \text{ave_error_sq} = \frac{\sum \text{error}^2}{N} $$</ul><p>è¿™äº›æ•°å­¦åŸç†æ„æˆäº†å•ç›®ç›¸æœºç¨ å¯†æ·±åº¦ä¼°è®¡çš„æ ¸å¿ƒç®—æ³•ã€‚<h2 id=shi-xian>å®ç°</h2><p>åŸå§‹cppä»£ç :[https://github.com/gaoxiang12/slambook2/blob/master/ch12/dense_mono/dense_mapping.cpp]<pre class=language-cpp data-lang=cpp><code class=language-cpp data-lang=cpp>#include &LTiostream>
#include &LTvector>
#include &LTfstream>

using namespace std;

#include &LTboost/timer.hpp>

// for sophus
#include &LTsophus/se3.hpp>

using Sophus::SE3d;

// for eigen
#include &LTEigen/Core>
#include &LTEigen/Geometry>

using namespace Eigen;

#include &LTopencv2/core/core.hpp>
#include &LTopencv2/highgui/highgui.hpp>
#include &LTopencv2/imgproc/imgproc.hpp>

using namespace cv;

/**********************************************
* æœ¬ç¨‹åºæ¼”ç¤ºäº†å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡
* ä½¿ç”¨æçº¿æœç´¢ + NCC åŒ¹é…çš„æ–¹å¼ï¼Œä¸ä¹¦æœ¬çš„ 12.2 èŠ‚å¯¹åº”
* è¯·æ³¨æ„æœ¬ç¨‹åºå¹¶ä¸å®Œç¾ï¼Œä½ å®Œå…¨å¯ä»¥æ”¹è¿›å®ƒâ€”â€”æˆ‘å…¶å®åœ¨æ•…æ„æš´éœ²ä¸€äº›é—®é¢˜(è¿™æ˜¯å€Ÿå£)ã€‚
***********************************************/

// ------------------------------------------------------------------
// parameters
const int boarder = 20;         // è¾¹ç¼˜å®½åº¦
const int width = 640;          // å›¾åƒå®½åº¦
const int height = 480;         // å›¾åƒé«˜åº¦
const double fx = 481.2f;       // ç›¸æœºå†…å‚
const double fy = -480.0f;
const double cx = 319.5f;
const double cy = 239.5f;
const int ncc_window_size = 3;    // NCC å–çš„çª—å£åŠå®½åº¦
const int ncc_area = (2 * ncc_window_size + 1) * (2 * ncc_window_size + 1); // NCCçª—å£é¢ç§¯
const double min_cov = 0.1;     // æ”¶æ•›åˆ¤å®šï¼šæœ€å°æ–¹å·®
const double max_cov = 10;      // å‘æ•£åˆ¤å®šï¼šæœ€å¤§æ–¹å·®

// ------------------------------------------------------------------
// é‡è¦çš„å‡½æ•°
/// ä» REMODE æ•°æ®é›†è¯»å–æ•°æ®
bool readDatasetFiles(
    const string &path,
    vector&LTstring> &color_image_files,
    vector&LTSE3d> &poses,
    cv::Mat &ref_depth
);

/**
 * æ ¹æ®æ–°çš„å›¾åƒæ›´æ–°æ·±åº¦ä¼°è®¡
 * @param ref           å‚è€ƒå›¾åƒ
 * @param curr          å½“å‰å›¾åƒ
 * @param T_C_R         å‚è€ƒå›¾åƒåˆ°å½“å‰å›¾åƒçš„ä½å§¿
 * @param depth         æ·±åº¦
 * @param depth_cov     æ·±åº¦æ–¹å·®
 * @return              æ˜¯å¦æˆåŠŸ
 */
bool update(
    const Mat &ref,
    const Mat &curr,
    const SE3d &T_C_R,
    Mat &depth,
    Mat &depth_cov2
);

/**
 * æçº¿æœç´¢
 * @param ref           å‚è€ƒå›¾åƒ
 * @param curr          å½“å‰å›¾åƒ
 * @param T_C_R         ä½å§¿
 * @param pt_ref        å‚è€ƒå›¾åƒä¸­ç‚¹çš„ä½ç½®
 * @param depth_mu      æ·±åº¦å‡å€¼
 * @param depth_cov     æ·±åº¦æ–¹å·®
 * @param pt_curr       å½“å‰ç‚¹
 * @param epipolar_direction  æçº¿æ–¹å‘
 * @return              æ˜¯å¦æˆåŠŸ
 */
bool epipolarSearch(
    const Mat &ref,
    const Mat &curr,
    const SE3d &T_C_R,
    const Vector2d &pt_ref,
    const double &depth_mu,
    const double &depth_cov,
    Vector2d &pt_curr,
    Vector2d &epipolar_direction
);

/**
 * æ›´æ–°æ·±åº¦æ»¤æ³¢å™¨
 * @param pt_ref    å‚è€ƒå›¾åƒç‚¹
 * @param pt_curr   å½“å‰å›¾åƒç‚¹
 * @param T_C_R     ä½å§¿
 * @param epipolar_direction æçº¿æ–¹å‘
 * @param depth     æ·±åº¦å‡å€¼
 * @param depth_cov2    æ·±åº¦æ–¹å‘
 * @return          æ˜¯å¦æˆåŠŸ
 */
bool updateDepthFilter(
    const Vector2d &pt_ref,
    const Vector2d &pt_curr,
    const SE3d &T_C_R,
    const Vector2d &epipolar_direction,
    Mat &depth,
    Mat &depth_cov2
);

/**
 * è®¡ç®— NCC è¯„åˆ†
 * @param ref       å‚è€ƒå›¾åƒ
 * @param curr      å½“å‰å›¾åƒ
 * @param pt_ref    å‚è€ƒç‚¹
 * @param pt_curr   å½“å‰ç‚¹
 * @return          NCCè¯„åˆ†
 */
double NCC(const Mat &ref, const Mat &curr, const Vector2d &pt_ref, const Vector2d &pt_curr);

// åŒçº¿æ€§ç°åº¦æ’å€¼
inline double getBilinearInterpolatedValue(const Mat &img, const Vector2d &pt) {
    uchar *d = &img.data[int(pt(1, 0)) * img.step + int(pt(0, 0))];
    double xx = pt(0, 0) - floor(pt(0, 0));
    double yy = pt(1, 0) - floor(pt(1, 0));
    return ((1 - xx) * (1 - yy) * double(d[0]) +
            xx * (1 - yy) * double(d[1]) +
            (1 - xx) * yy * double(d[img.step]) +
            xx * yy * double(d[img.step + 1])) / 255.0;
}

// ------------------------------------------------------------------
// ä¸€äº›å°å·¥å…·
// æ˜¾ç¤ºä¼°è®¡çš„æ·±åº¦å›¾
void plotDepth(const Mat &depth_truth, const Mat &depth_estimate);

// åƒç´ åˆ°ç›¸æœºåæ ‡ç³»
inline Vector3d px2cam(const Vector2d px) {
    return Vector3d(
        (px(0, 0) - cx) / fx,
        (px(1, 0) - cy) / fy,
        1
    );
}

// ç›¸æœºåæ ‡ç³»åˆ°åƒç´ 
inline Vector2d cam2px(const Vector3d p_cam) {
    return Vector2d(
        p_cam(0, 0) * fx / p_cam(2, 0) + cx,
        p_cam(1, 0) * fy / p_cam(2, 0) + cy
    );
}

// æ£€æµ‹ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…
inline bool inside(const Vector2d &pt) {
    return pt(0, 0) >= boarder && pt(1, 0) >= boarder
           && pt(0, 0) + boarder < width && pt(1, 0) + boarder <= height;
}

// æ˜¾ç¤ºæçº¿åŒ¹é…
void showEpipolarMatch(const Mat &ref, const Mat &curr, const Vector2d &px_ref, const Vector2d &px_curr);

// æ˜¾ç¤ºæçº¿
void showEpipolarLine(const Mat &ref, const Mat &curr, const Vector2d &px_ref, const Vector2d &px_min_curr,
                      const Vector2d &px_max_curr);

/// è¯„æµ‹æ·±åº¦ä¼°è®¡
void evaludateDepth(const Mat &depth_truth, const Mat &depth_estimate);
// ------------------------------------------------------------------


int main(int argc, char **argv) {
    if (argc != 2) {
        cout << "Usage: dense_mapping path_to_test_dataset" << endl;
        return -1;
    }

    // ä»æ•°æ®é›†è¯»å–æ•°æ®
    vector&LTstring> color_image_files;
    vector&LTSE3d> poses_TWC;
    Mat ref_depth;
    bool ret = readDatasetFiles(argv[1], color_image_files, poses_TWC, ref_depth);
    if (ret == false) {
        cout << "Reading image files failed!" << endl;
        return -1;
    }
    cout << "read total " << color_image_files.size() << " files." << endl;

    // ç¬¬ä¸€å¼ å›¾
    Mat ref = imread(color_image_files[0], 0);                // gray-scale image
    SE3d pose_ref_TWC = poses_TWC[0];
    double init_depth = 3.0;    // æ·±åº¦åˆå§‹å€¼
    double init_cov2 = 3.0;     // æ–¹å·®åˆå§‹å€¼
    Mat depth(height, width, CV_64F, init_depth);             // æ·±åº¦å›¾
    Mat depth_cov2(height, width, CV_64F, init_cov2);         // æ·±åº¦å›¾æ–¹å·®

    for (int index = 1; index < color_image_files.size(); index++) {
        cout << "*** loop " << index << " ***" << endl;
        Mat curr = imread(color_image_files[index], 0);
        if (curr.data == nullptr) continue;
        SE3d pose_curr_TWC = poses_TWC[index];
        SE3d pose_T_C_R = pose_curr_TWC.inverse() * pose_ref_TWC;   // åæ ‡è½¬æ¢å…³ç³»ï¼š T_C_W * T_W_R = T_C_R
        update(ref, curr, pose_T_C_R, depth, depth_cov2);
        evaludateDepth(ref_depth, depth);
        plotDepth(ref_depth, depth);
        imshow("image", curr);
        waitKey(1);
    }

    cout << "estimation returns, saving depth map ..." << endl;
    imwrite("depth.png", depth);
    cout << "done." << endl;

    return 0;
}

bool readDatasetFiles(
    const string &path,
    vector&LTstring> &color_image_files,
    std::vector&LTSE3d> &poses,
    cv::Mat &ref_depth) {
    ifstream fin(path + "/first_200_frames_traj_over_table_input_sequence.txt");
    if (!fin) return false;

    while (!fin.eof()) {
        // æ•°æ®æ ¼å¼ï¼šå›¾åƒæ–‡ä»¶å tx, ty, tz, qx, qy, qz, qw ï¼Œæ³¨æ„æ˜¯ TWC è€Œé TCW
        string image;
        fin >> image;
        double data[7];
        for (double &d:data) fin >> d;

        color_image_files.push_back(path + string("/images/") + image);
        poses.push_back(
            SE3d(Quaterniond(data[6], data[3], data[4], data[5]),
                 Vector3d(data[0], data[1], data[2]))
        );
        if (!fin.good()) break;
    }
    fin.close();

    // load reference depth
    fin.open(path + "/depthmaps/scene_000.depth");
    ref_depth = cv::Mat(height, width, CV_64F);
    if (!fin) return false;
    for (int y = 0; y < height; y++)
        for (int x = 0; x < width; x++) {
            double depth = 0;
            fin >> depth;
            ref_depth.ptr&LTdouble>(y)[x] = depth / 100.0;
        }

    return true;
}

// å¯¹æ•´ä¸ªæ·±åº¦å›¾è¿›è¡Œæ›´æ–°
bool update(const Mat &ref, const Mat &curr, const SE3d &T_C_R, Mat &depth, Mat &depth_cov2) {
    for (int x = boarder; x < width - boarder; x++)
        for (int y = boarder; y < height - boarder; y++) {
            // éå†æ¯ä¸ªåƒç´ 
            if (depth_cov2.ptr&LTdouble>(y)[x] < min_cov || depth_cov2.ptr&LTdouble>(y)[x] > max_cov) // æ·±åº¦å·²æ”¶æ•›æˆ–å‘æ•£
                continue;
            // åœ¨æçº¿ä¸Šæœç´¢ (x,y) çš„åŒ¹é…
            Vector2d pt_curr;
            Vector2d epipolar_direction;
            bool ret = epipolarSearch(
                ref,
                curr,
                T_C_R,
                Vector2d(x, y),
                depth.ptr&LTdouble>(y)[x],
                sqrt(depth_cov2.ptr&LTdouble>(y)[x]),
                pt_curr,
                epipolar_direction
            );

            if (ret == false) // åŒ¹é…å¤±è´¥
                continue;

            // å–æ¶ˆè¯¥æ³¨é‡Šä»¥æ˜¾ç¤ºåŒ¹é…
            // showEpipolarMatch(ref, curr, Vector2d(x, y), pt_curr);

            // åŒ¹é…æˆåŠŸï¼Œæ›´æ–°æ·±åº¦å›¾
            updateDepthFilter(Vector2d(x, y), pt_curr, T_C_R, epipolar_direction, depth, depth_cov2);
        }
}

// æçº¿æœç´¢
// æ–¹æ³•è§ä¹¦ 12.2 12.3 ä¸¤èŠ‚
bool epipolarSearch(
    const Mat &ref, const Mat &curr,
    const SE3d &T_C_R, const Vector2d &pt_ref,
    const double &depth_mu, const double &depth_cov,
    Vector2d &pt_curr, Vector2d &epipolar_direction) {
    Vector3d f_ref = px2cam(pt_ref);
    f_ref.normalize();
    Vector3d P_ref = f_ref * depth_mu;    // å‚è€ƒå¸§çš„ P å‘é‡

    Vector2d px_mean_curr = cam2px(T_C_R * P_ref); // æŒ‰æ·±åº¦å‡å€¼æŠ•å½±çš„åƒç´ 
    double d_min = depth_mu - 3 * depth_cov, d_max = depth_mu + 3 * depth_cov;
    if (d_min < 0.1) d_min = 0.1;
    Vector2d px_min_curr = cam2px(T_C_R * (f_ref * d_min));    // æŒ‰æœ€å°æ·±åº¦æŠ•å½±çš„åƒç´ 
    Vector2d px_max_curr = cam2px(T_C_R * (f_ref * d_max));    // æŒ‰æœ€å¤§æ·±åº¦æŠ•å½±çš„åƒç´ 

    Vector2d epipolar_line = px_max_curr - px_min_curr;    // æçº¿ï¼ˆçº¿æ®µå½¢å¼ï¼‰
    epipolar_direction = epipolar_line;        // æçº¿æ–¹å‘
    epipolar_direction.normalize();
    double half_length = 0.5 * epipolar_line.norm();    // æçº¿çº¿æ®µçš„åŠé•¿åº¦
    if (half_length > 100) half_length = 100;   // æˆ‘ä»¬ä¸å¸Œæœ›æœç´¢å¤ªå¤šä¸œè¥¿

    // å–æ¶ˆæ­¤å¥æ³¨é‡Šä»¥æ˜¾ç¤ºæçº¿ï¼ˆçº¿æ®µï¼‰
    // showEpipolarLine( ref, curr, pt_ref, px_min_curr, px_max_curr );

    // åœ¨æçº¿ä¸Šæœç´¢ï¼Œä»¥æ·±åº¦å‡å€¼ç‚¹ä¸ºä¸­å¿ƒï¼Œå·¦å³å„å–åŠé•¿åº¦
    double best_ncc = -1.0;
    Vector2d best_px_curr;
    for (double l = -half_length; l <= half_length; l += 0.7) { // l+=sqrt(2)
        Vector2d px_curr = px_mean_curr + l * epipolar_direction;  // å¾…åŒ¹é…ç‚¹
        if (!inside(px_curr))
            continue;
        // è®¡ç®—å¾…åŒ¹é…ç‚¹ä¸å‚è€ƒå¸§çš„ NCC
        double ncc = NCC(ref, curr, pt_ref, px_curr);
        if (ncc > best_ncc) {
            best_ncc = ncc;
            best_px_curr = px_curr;
        }
    }
    if (best_ncc < 0.85f)      // åªç›¸ä¿¡ NCC å¾ˆé«˜çš„åŒ¹é…
        return false;
    pt_curr = best_px_curr;
    return true;
}

double NCC(
    const Mat &ref, const Mat &curr,
    const Vector2d &pt_ref, const Vector2d &pt_curr) {
    // é›¶å‡å€¼-å½’ä¸€åŒ–äº’ç›¸å…³
    // å…ˆç®—å‡å€¼
    double mean_ref = 0, mean_curr = 0;
    vector&LTdouble> values_ref, values_curr; // å‚è€ƒå¸§å’Œå½“å‰å¸§çš„å‡å€¼
    for (int x = -ncc_window_size; x <= ncc_window_size; x++)
        for (int y = -ncc_window_size; y <= ncc_window_size; y++) {
            double value_ref = double(ref.ptr&LTuchar>(int(y + pt_ref(1, 0)))[int(x + pt_ref(0, 0))]) / 255.0;
            mean_ref += value_ref;

            double value_curr = getBilinearInterpolatedValue(curr, pt_curr + Vector2d(x, y));
            mean_curr += value_curr;

            values_ref.push_back(value_ref);
            values_curr.push_back(value_curr);
        }

    mean_ref /= ncc_area;
    mean_curr /= ncc_area;

    // è®¡ç®— Zero mean NCC
    double numerator = 0, demoniator1 = 0, demoniator2 = 0;
    for (int i = 0; i < values_ref.size(); i++) {
        double n = (values_ref[i] - mean_ref) * (values_curr[i] - mean_curr);
        numerator += n;
        demoniator1 += (values_ref[i] - mean_ref) * (values_ref[i] - mean_ref);
        demoniator2 += (values_curr[i] - mean_curr) * (values_curr[i] - mean_curr);
    }
    return numerator / sqrt(demoniator1 * demoniator2 + 1e-10);   // é˜²æ­¢åˆ†æ¯å‡ºç°é›¶
}

bool updateDepthFilter(
    const Vector2d &pt_ref,
    const Vector2d &pt_curr,
    const SE3d &T_C_R,
    const Vector2d &epipolar_direction,
    Mat &depth,
    Mat &depth_cov2) {
    // ä¸çŸ¥é“è¿™æ®µè¿˜æœ‰æ²¡æœ‰äººçœ‹
    // ç”¨ä¸‰è§’åŒ–è®¡ç®—æ·±åº¦
    SE3d T_R_C = T_C_R.inverse();
    Vector3d f_ref = px2cam(pt_ref);
    f_ref.normalize();
    Vector3d f_curr = px2cam(pt_curr);
    f_curr.normalize();

    // æ–¹ç¨‹
    // d_ref * f_ref = d_cur * ( R_RC * f_cur ) + t_RC
    // f2 = R_RC * f_cur
    // è½¬åŒ–æˆä¸‹é¢è¿™ä¸ªçŸ©é˜µæ–¹ç¨‹ç»„
    // => [ f_ref^T f_ref, -f_ref^T f2 ] [d_ref]   [f_ref^T t]
    //    [ f_2^T f_ref, -f2^T f2      ] [d_cur] = [f2^T t   ]
    Vector3d t = T_R_C.translation();
    Vector3d f2 = T_R_C.so3() * f_curr;
    Vector2d b = Vector2d(t.dot(f_ref), t.dot(f2));
    Matrix2d A;
    A(0, 0) = f_ref.dot(f_ref);
    A(0, 1) = -f_ref.dot(f2);
    A(1, 0) = -A(0, 1);
    A(1, 1) = -f2.dot(f2);
    Vector2d ans = A.inverse() * b;
    Vector3d xm = ans[0] * f_ref;           // ref ä¾§çš„ç»“æœ
    Vector3d xn = t + ans[1] * f2;          // cur ç»“æœ
    Vector3d p_esti = (xm + xn) / 2.0;      // Pçš„ä½ç½®ï¼Œå–ä¸¤è€…çš„å¹³å‡
    double depth_estimation = p_esti.norm();   // æ·±åº¦å€¼

    // è®¡ç®—ä¸ç¡®å®šæ€§ï¼ˆä»¥ä¸€ä¸ªåƒç´ ä¸ºè¯¯å·®ï¼‰
    Vector3d p = f_ref * depth_estimation;
    Vector3d a = p - t;
    double t_norm = t.norm();
    double a_norm = a.norm();
    double alpha = acos(f_ref.dot(t) / t_norm);
    double beta = acos(-a.dot(t) / (a_norm * t_norm));
    Vector3d f_curr_prime = px2cam(pt_curr + epipolar_direction);
    f_curr_prime.normalize();
    double beta_prime = acos(f_curr_prime.dot(-t) / t_norm);
    double gamma = M_PI - alpha - beta_prime;
    double p_prime = t_norm * sin(beta_prime) / sin(gamma);
    double d_cov = p_prime - depth_estimation;
    double d_cov2 = d_cov * d_cov;

    // é«˜æ–¯èåˆ
    double mu = depth.ptr&LTdouble>(int(pt_ref(1, 0)))[int(pt_ref(0, 0))];
    double sigma2 = depth_cov2.ptr&LTdouble>(int(pt_ref(1, 0)))[int(pt_ref(0, 0))];

    double mu_fuse = (d_cov2 * mu + sigma2 * depth_estimation) / (sigma2 + d_cov2);
    double sigma_fuse2 = (sigma2 * d_cov2) / (sigma2 + d_cov2);

    depth.ptr&LTdouble>(int(pt_ref(1, 0)))[int(pt_ref(0, 0))] = mu_fuse;
    depth_cov2.ptr&LTdouble>(int(pt_ref(1, 0)))[int(pt_ref(0, 0))] = sigma_fuse2;

    return true;
}

// åé¢è¿™äº›å¤ªç®€å•æˆ‘å°±ä¸æ³¨é‡Šäº†ï¼ˆå…¶å®æ˜¯å› ä¸ºæ‡’ï¼‰
void plotDepth(const Mat &depth_truth, const Mat &depth_estimate) {
    imshow("depth_truth", depth_truth * 0.4);
    imshow("depth_estimate", depth_estimate * 0.4);
    imshow("depth_error", depth_truth - depth_estimate);
    waitKey(1);
}

void evaludateDepth(const Mat &depth_truth, const Mat &depth_estimate) {
    double ave_depth_error = 0;     // å¹³å‡è¯¯å·®
    double ave_depth_error_sq = 0;      // å¹³æ–¹è¯¯å·®
    int cnt_depth_data = 0;
    for (int y = boarder; y < depth_truth.rows - boarder; y++)
        for (int x = boarder; x < depth_truth.cols - boarder; x++) {
            double error = depth_truth.ptr&LTdouble>(y)[x] - depth_estimate.ptr&LTdouble>(y)[x];
            ave_depth_error += error;
            ave_depth_error_sq += error * error;
            cnt_depth_data++;
        }
    ave_depth_error /= cnt_depth_data;
    ave_depth_error_sq /= cnt_depth_data;

    cout << "Average squared error = " << ave_depth_error_sq << ", average error: " << ave_depth_error << endl;
}

void showEpipolarMatch(const Mat &ref, const Mat &curr, const Vector2d &px_ref, const Vector2d &px_curr) {
    Mat ref_show, curr_show;
    cv::cvtColor(ref, ref_show, CV_GRAY2BGR);
    cv::cvtColor(curr, curr_show, CV_GRAY2BGR);

    cv::circle(ref_show, cv::Point2f(px_ref(0, 0), px_ref(1, 0)), 5, cv::Scalar(0, 0, 250), 2);
    cv::circle(curr_show, cv::Point2f(px_curr(0, 0), px_curr(1, 0)), 5, cv::Scalar(0, 0, 250), 2);

    imshow("ref", ref_show);
    imshow("curr", curr_show);
    waitKey(1);
}

void showEpipolarLine(const Mat &ref, const Mat &curr, const Vector2d &px_ref, const Vector2d &px_min_curr,
                      const Vector2d &px_max_curr) {

    Mat ref_show, curr_show;
    cv::cvtColor(ref, ref_show, CV_GRAY2BGR);
    cv::cvtColor(curr, curr_show, CV_GRAY2BGR);

    cv::circle(ref_show, cv::Point2f(px_ref(0, 0), px_ref(1, 0)), 5, cv::Scalar(0, 255, 0), 2);
    cv::circle(curr_show, cv::Point2f(px_min_curr(0, 0), px_min_curr(1, 0)), 5, cv::Scalar(0, 255, 0), 2);
    cv::circle(curr_show, cv::Point2f(px_max_curr(0, 0), px_max_curr(1, 0)), 5, cv::Scalar(0, 255, 0), 2);
    cv::line(curr_show, Point2f(px_min_curr(0, 0), px_min_curr(1, 0)), Point2f(px_max_curr(0, 0), px_max_curr(1, 0)),
             Scalar(0, 255, 0), 1);

    imshow("ref", ref_show);
    imshow("curr", curr_show);
    waitKey(1);
}
</code></pre><p>ä½¿ç”¨rusté‡æ„:<pre class=language-rs data-lang=rs><code class=language-rs data-lang=rs>#![allow(dead_code)]
#![allow(unused_variables)]
#![allow(unused_imports)]
#![allow(non_fmt_panics)]
#![allow(unused_mut)]
#![allow(unused_assignments)]
#![cfg_attr(not(debug_assertions), windows_subsystem = "windows")]
#![allow(rustdoc::missing_crate_level_docs)]
#![allow(unsafe_code)]
#![allow(clippy::undocumented_unsafe_blocks)]
#![allow(unused_must_use)]
#![allow(non_snake_case)]
#![allow(unused_doc_comments)]

//! æœ¬ç¨‹åºæ¼”ç¤ºäº†å•ç›®ç›¸æœºåœ¨å·²çŸ¥è½¨è¿¹ä¸‹çš„ç¨ å¯†æ·±åº¦ä¼°è®¡ï¼Œ
//! ä½¿ç”¨æçº¿æœç´¢ + NCC åŒ¹é…çš„æ–¹å¼ï¼Œä¸ä¹¦æœ¬çš„ 12.2 èŠ‚å¯¹åº”ã€‚
//! æ·»åŠ äº†å›¾åƒä¿å­˜åˆ°æ–‡ä»¶çš„åŠŸèƒ½ã€‚

use std::fs::File;
use std::io::{self, BufRead, Write, BufReader, Cursor};
use std::path::Path;
use std::fs::create_dir_all;

use std::cell::{
    RefMut, Ref, RefCell
};

// çº¿æ€§ä»£æ•°
use nalgebra::{
    Quaternion, Vector3, Matrix3, UnitQuaternion, 
    Isometry3, Translation3, Const,
    Matrix, Point3, ViewStorage, Rotation3,
    Matrix3x1, VectorView3, DMatrix, DVector, SVector,
    Vector6, Matrix6, Vector2, Matrix2, 
};

// æä»£æ•°
use factrs::{
    assign_symbols,
    core::{BetweenResidual, GaussNewton, Graph, Values},
    dtype, fac,
    linalg::{ ForwardProp, Numeric, NumericalDiff, VectorX, DiffResult, MatrixX },
    residuals::{Residual1, Residual2},
    traits::*,
    variables::{VectorVar2, SE2, VectorVar3, SE3, SO3, SO2, MatrixLieGroup},
    containers::Key,
    noise::{GaussianNoise},
    optimizers::{LevenMarquardt}
};

// å›¾åƒå¤„ç†
use image::{
    DynamicImage, GrayImage, ImageBuffer, Luma, 
    GenericImageView, Rgb, RgbImage, 
    buffer::ConvertBuffer,
};
use imageproc::drawing::{
    draw_cross_mut, draw_filled_circle_mut, draw_line_segment_mut,
};

// éšæœºæ•°
use rand::Rng;
use rand_distr::{
    Distribution, Normal
};

// è¾¹ç¼˜å®½åº¦
const BOARDER: i32 = 20;     
// å›¾åƒå®½åº¦    
const WIDTH: i32 = 640;          
// å›¾åƒé«˜åº¦
const HEIGHT: i32 = 480;         
// ç›¸æœºå†…å‚
const FX: f64 = 481.2;           
const FY: f64 = -480.0;
const CX: f64 = 319.5;
const CY: f64 = 239.5;
// NCC å–çš„çª—å£åŠå®½åº¦
const NCC_WINDOW_SIZE: i32 = 3;  
// NCCçª—å£é¢ç§¯
const NCC_AREA: i32 = (2 * NCC_WINDOW_SIZE + 1) * (2 * NCC_WINDOW_SIZE + 1); 
// æ”¶æ•›åˆ¤å®šï¼šæœ€å°æ–¹å·®
const MIN_COV: f64 = 0.1;        
// å‘æ•£åˆ¤å®šï¼šæœ€å¤§æ–¹å·®
const MAX_COV: f64 = 10.0;    
// å›¾åƒä¿å­˜ç›®å½•
const OUTPUT_DIR: &str = "./result/ch12-dense_mono_dense_mapping";

// ä» REMODE æ•°æ®é›†è¯»å–æ•°æ®
fn read_dataset_files(
    path: &str,
    color_image_files: &mut Vec&LTString>,
    poses: &mut Vec&LTSE3>,
    ref_depth: &mut ImageBuffer&LTLuma&LTf64>, Vec&LTf64>>,
) -> io::Result<()> {
    println!("å¼€å§‹è¯»å–æ•°æ®é›†æ–‡ä»¶...");
    let file = File::open(format!("{}/first_200_frames_traj_over_table_input_sequence.txt", path))?;
    let reader = io::BufReader::new(file);

    for line in reader.lines() {
        let line = line?;
        let parts: Vec<&str> = line.split_whitespace().collect();
        if parts.len() < 8 {
            continue;
        }

        let image = parts[0];
        let data: Vec&LTf64> = parts[1..8].iter().map(|s| s.parse().unwrap()).collect();

        color_image_files.push(format!("{}/images/{}", path, image));
        poses.push(SE3::from_rot_trans(
            SO3::from_xyzw(data[3], data[4], data[5],data[6]),
            Vector3::new(data[0], data[1], data[2]),
        ));
    }

    println!("è¯»å–è½¨è¿¹å’Œå›¾åƒæ–‡ä»¶å®Œæˆï¼Œå…±è¯»å– {} å¼ å›¾åƒ", color_image_files.len());

    // åŠ è½½å‚è€ƒæ·±åº¦å›¾
    let depth_file = File::open(format!("{}/depthmaps/scene_000.depth", path))?;
    let depth_reader = io::BufReader::new(depth_file);

    for (y, line) in depth_reader.lines().enumerate() {
        let line = line?;
        let depths: Vec&LTf64> = line.split_whitespace().map(|s| s.parse().unwrap()).collect();
        for (x, depth) in depths.iter().enumerate() {
            let x_index = std::cmp::min(ref_depth.width() as usize - 1, x);
            let y_index = std::cmp::min(ref_depth.height() as usize - 1, y);
            ref_depth.put_pixel(x_index as u32, y_index as u32, Luma([*depth / 100.0]));
        }
    }

    println!("å‚è€ƒæ·±åº¦å›¾åŠ è½½å®Œæˆ");
    Ok(())
}

// æçº¿æœç´¢
fn epipolar_search(
    ref_img: &GrayImage,
    curr_img: &GrayImage,
    t_c_r: &SE3,
    pt_ref: &Vector2&LTf64>,
    depth_mu: f64,
    depth_cov: f64,
    pt_curr: &mut Vector2&LTf64>,
    epipolar_direction: &mut Vector2&LTf64>,
) -> bool {
    println!("å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š{:?}", pt_ref);
    let f_ref = px2cam(pt_ref);
    let p_ref = f_ref * depth_mu;

    let px_mean_curr = cam2px(&(t_c_r.apply((&p_ref).into())));
    let d_min = depth_mu - 3.0 * depth_cov;
    let d_max = depth_mu + 3.0 * depth_cov;
    let px_min_curr = cam2px(&(t_c_r.apply((&(f_ref * d_min)).into())));
    let px_max_curr = cam2px(&(t_c_r.apply((&(f_ref * d_max)).into())));

    let epipolar_line = px_max_curr - px_min_curr;
    *epipolar_direction = epipolar_line;
    epipolar_direction.normalize();
    let half_length = 0.5 * epipolar_line.norm();

    // åœ¨æçº¿ä¸Šæœç´¢ï¼Œä»¥æ·±åº¦å‡å€¼ç‚¹ä¸ºä¸­å¿ƒï¼Œå·¦å³å„å–åŠé•¿åº¦
    let mut best_ncc = -1.0;
    let mut best_px_curr = Vector2::zeros();

    for l in (-half_length as i32..=half_length as i32).step_by(1) {
        let px_curr = px_mean_curr + (l as f64) * *epipolar_direction;
        if !inside(&px_curr) {
            continue;
        }

        let ncc = ncc(ref_img, curr_img, pt_ref, &px_curr);
        if ncc > best_ncc {
            best_ncc = ncc;
            best_px_curr = px_curr;
        }
    }

    if best_ncc < 0.85 {
        println!("æçº¿æœç´¢å¤±è´¥ï¼Œæœ€ä½³ NCC ä¸º {}", best_ncc);
        return false;
    }

    *pt_curr = best_px_curr;
    println!("æçº¿æœç´¢æˆåŠŸï¼Œæœ€ä½³åŒ¹é…ç‚¹ï¼š{:?}", pt_curr);
    true
}

// è®¡ç®— NCC è¯„åˆ†
fn ncc(ref_img: &GrayImage, curr_img: &GrayImage, pt_ref: &Vector2&LTf64>, pt_curr: &Vector2&LTf64>) -> f64 {
    println!("è®¡ç®— NCC è¯„åˆ†ï¼Œå‚è€ƒç‚¹ï¼š{:?}ï¼Œå½“å‰ç‚¹ï¼š{:?}", pt_ref, pt_curr);
    let mut mean_ref = 0.0;
    let mut mean_curr = 0.0;
    let mut values_ref = Vec::new();
    let mut values_curr = Vec::new();

    for x in -NCC_WINDOW_SIZE..=NCC_WINDOW_SIZE {
        for y in -NCC_WINDOW_SIZE..=NCC_WINDOW_SIZE {
            let value_ref = ref_img.get_pixel((pt_ref.x + x as f64) as u32, (pt_ref.y + y as f64) as u32)[0] as f64 / 255.0;
            mean_ref += value_ref;

            let value_curr = get_bilinear_interpolated_value(curr_img, &(pt_curr + Vector2::new(x as f64, y as f64)));
            mean_curr += value_curr;

            values_ref.push(value_ref);
            values_curr.push(value_curr);
        }
    }

    mean_ref /= NCC_AREA as f64;
    mean_curr /= NCC_AREA as f64;

    let mut numerator = 0.0;
    let mut demoniator1 = 0.0;
    let mut demoniator2 = 0.0;

    for i in 0..values_ref.len() {
        let n = (values_ref[i] - mean_ref) * (values_curr[i] - mean_curr);
        numerator += n;
        demoniator1 += (values_ref[i] - mean_ref) * (values_ref[i] - mean_ref);
        demoniator2 += (values_curr[i] - mean_curr) * (values_curr[i] - mean_curr);
    }

    let ncc_score = numerator / (demoniator1 * demoniator2 + 1e-10).sqrt();
    println!("NCC è¯„åˆ†ï¼š{}", ncc_score);
    ncc_score
}

// åŒçº¿æ€§ç°åº¦æ’å€¼
fn get_bilinear_interpolated_value(img: &GrayImage, pt: &Vector2&LTf64>) -> f64 {
    println!("åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š{:?}", pt);
    let x = pt.x as u32;
    let y = pt.y as u32;
    let xx = pt.x - x as f64;
    let yy = pt.y - y as f64;

    let d00 = img.get_pixel(x, y)[0] as f64;
    let d01 = img.get_pixel(x, y + 1)[0] as f64;
    let d10 = img.get_pixel(x + 1, y)[0] as f64;
    let d11 = img.get_pixel(x + 1, y + 1)[0] as f64;

    let interpolated_value = ((1.0 - xx) * (1.0 - yy) * d00 + xx * (1.0 - yy) * d10 + (1.0 - xx) * yy * d01 + xx * yy * d11) / 255.0;
    println!("æ’å€¼ç»“æœï¼š{}", interpolated_value);
    interpolated_value
}

// åƒç´ åˆ°ç›¸æœºåæ ‡ç³»
fn px2cam(px: &Vector2&LTf64>) -> Vector3&LTf64> {
    println!("åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š{:?}", px);
    Vector3::new((px.x - CX) / FX, (px.y - CY) / FY, 1.0)
}

// ç›¸æœºåæ ‡ç³»åˆ°åƒç´ 
fn cam2px(p_cam: &Vector3&LTf64>) -> Vector2&LTf64> {
    println!("ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š{:?}", p_cam);
    Vector2::new(p_cam.x * FX / p_cam.z + CX, p_cam.y * FY / p_cam.z + CY)
}

// æ£€æµ‹ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…
fn inside(pt: &Vector2&LTf64>) -> bool {
    println!("æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ï¼Œç‚¹ï¼š{:?}", pt);
    pt.x >= (BOARDER as f64) && pt.y >= (BOARDER as f64) && pt.x + (BOARDER as f64) < (WIDTH as f64) && pt.y + (BOARDER as f64) < (HEIGHT as f64)
}

// æ›´æ–°æ·±åº¦æ»¤æ³¢å™¨
fn update_depth_filter(
    pt_ref: &Vector2&LTf64>,
    pt_curr: &Vector2&LTf64>,
    t_c_r: &SE3,
    epipolar_direction: &Vector2&LTf64>,
    depth: &mut ImageBuffer&LTLuma&LTf64>, Vec&LTf64>>,
    depth_cov2: &mut ImageBuffer&LTLuma&LTf64>, Vec&LTf64>>,
) -> bool {
    println!("æ›´æ–°æ·±åº¦æ»¤æ³¢å™¨ï¼Œå‚è€ƒç‚¹ï¼š{:?}ï¼Œå½“å‰ç‚¹ï¼š{:?}", pt_ref, pt_curr);
    let t_r_c = t_c_r.inverse();
    let f_ref = px2cam(pt_ref).normalize();
    let f_curr = px2cam(pt_curr).normalize();

    let t = t_r_c.xyz().clone();
    let f2 = t_r_c.rot().apply((&f_curr).into());
    let b = Vector2::new(t.dot(&f_ref), t.dot(&f2));
    let a = Matrix2::new(
        f_ref.dot(&f_ref),
        -f_ref.dot(&f2),
        -f_ref.dot(&f2),
        -f2.dot(&f2),
    );
    let ans = a.try_inverse().unwrap() * b;
    let xm = ans[0] * f_ref;
    let xn = t + ans[1] * f2;
    let p_esti = (xm + xn) / 2.0;
    let depth_estimation = p_esti.norm();

    // è®¡ç®—ä¸ç¡®å®šæ€§
    let p = f_ref * depth_estimation;
    let a = p - t;
    let t_norm = t.norm();
    let a_norm = a.norm();
    let alpha = (f_ref.dot(&t) / t_norm).acos();
    let beta = (-a.dot(&t) / (a_norm * t_norm)).acos();
    let f_curr_prime = px2cam(&(pt_curr + epipolar_direction)).normalize();
    let beta_prime = (f_curr_prime.dot(&-t) / t_norm).acos();
    let gamma = std::f64::consts::PI - alpha - beta_prime;
    let p_prime = t_norm * beta_prime.sin() / gamma.sin();
    let d_cov = p_prime - depth_estimation;
    let d_cov2 = d_cov * d_cov;

    // é«˜æ–¯èåˆ
    let mu = depth.get_pixel(pt_ref.x as u32, pt_ref.y as u32)[0];
    let sigma2 = depth_cov2.get_pixel(pt_ref.x as u32, pt_ref.y as u32)[0];

    let mu_fuse = (d_cov2 * mu + sigma2 * depth_estimation) / (sigma2 + d_cov2);
    let sigma_fuse2 = (sigma2 * d_cov2) / (sigma2 + d_cov2);

    depth.put_pixel(pt_ref.x as u32, pt_ref.y as u32, Luma([mu_fuse]));
    depth_cov2.put_pixel(pt_ref.x as u32, pt_ref.y as u32, Luma([sigma_fuse2]));

    println!("æ·±åº¦æ›´æ–°å®Œæˆï¼Œæ–°æ·±åº¦ï¼š{}", mu_fuse);
    true
}

// æ˜¾ç¤ºå¹¶ä¿å­˜æçº¿åŒ¹é…
fn show_epipolar_match(ref_img: &GrayImage, curr_img: &GrayImage, px_ref: (i32, i32), px_curr: (i32, i32), index: usize, output_dir: &Path) {
    let mut ref_show : RgbImage = ref_img.convert();
    let mut curr_show : RgbImage = curr_img.convert();

    draw_filled_circle_mut(&mut ref_show, px_ref, 5, Rgb([0, 255, 0]));
    draw_filled_circle_mut(&mut curr_show, px_curr, 5, Rgb([255, 0, 0]));

    let rand_number = rand::random::&LTu32>() % 1000;
    ref_show.save(output_dir.join(format!("ref_match_{index}_{rand_number}.png"))).unwrap();
    curr_show.save(output_dir.join(format!("curr_match_{index}_{rand_number}.png"))).unwrap();
}

// æ˜¾ç¤ºå¹¶ä¿å­˜æçº¿
fn show_epipolar_line(ref_img: &GrayImage, curr_img: &GrayImage, px_ref: (f32, f32), px_min_curr: (f32, f32), px_max_curr: (f32, f32), index: usize, output_dir: &Path) {
    let mut curr_show : RgbImage = curr_img.convert();

    draw_line_segment_mut(&mut curr_show, px_min_curr, px_max_curr, Rgb([0, 255, 0])); //æçº¿
    draw_filled_circle_mut(&mut curr_show, (px_ref.0 as i32, px_ref.1 as i32), 5, Rgb([255, 0, 0])); // å‚è€ƒç‚¹
    let rand_number = rand::random::&LTu32>() % 1000;
    curr_show.save(output_dir.join(format!("epipolar_line_{index}_{rand_number}.png"))).unwrap();
}

// è¯„ä¼°æ·±åº¦ä¼°è®¡
fn evaluate_depth(depth_truth: &ImageBuffer&LTLuma&LTf64>, Vec&LTf64>>, depth_estimate: &ImageBuffer&LTLuma&LTf64>, Vec&LTf64>>) {
    let mut error_sum = 0.0;
    let mut error_sq_sum = 0.0;
    let mut count = 0;

    for (x, y, pixel) in depth_truth.enumerate_pixels() {
        let est_pixel = depth_estimate.get_pixel(x, y)[0];
        let error = pixel[0] - est_pixel;
        error_sum += error;
        error_sq_sum += error * error;
        count += 1;
    }

    let avg_error = error_sum / count as f64;
    let avg_sq_error = error_sq_sum / count as f64;

    println!("Average Error: {avg_error}, Average Squared Error: {avg_sq_error}");
}

// ä¿å­˜æ·±åº¦å›¾å¯è§†åŒ–
fn save_depth_image(depth_image: &ImageBuffer&LTLuma&LTf64>, Vec&LTf64>>, file_path: &Path) {
    let max_depth = depth_image.pixels().map(|p| p[0]).fold(f64::MIN, f64::max);
    let scale_factor = 255.0 / max_depth;
    let buffer: Vec&LTu8> = depth_image
        .pixels()
        .map(|p| (p[0] * scale_factor) as u8)
        .collect();
    let new_img = GrayImage::from_raw(depth_image.width(), depth_image.height(), buffer).unwrap();
    new_img.save(file_path).unwrap();
}

// ä¸»å‡½æ•°
fn main() -> Result<(), Box&LTdyn std::error::Error>> {
    println!("ç¨‹åºå¼€å§‹æ‰§è¡Œ...");
    // åˆ¤æ–­å›¾åƒä¿å­˜ç›®å½•æ˜¯å¦å­˜åœ¨
    let output_dir = Path::new(OUTPUT_DIR);
    if !output_dir.exists() {
        create_dir_all(output_dir)?;
    }

    // åŠ è½½æ•°æ®é›†
    let path = "./assets/ch12-REMODE";
    let mut color_image_files = Vec::new();
    let mut poses = Vec::new();
    let mut ref_depth = ImageBuffer::new(WIDTH as u32, HEIGHT as u32);

    read_dataset_files(path, &mut color_image_files, &mut poses, &mut ref_depth)?;

    let ref_img = image::open(&color_image_files[0])?.to_luma8();
    let pose_ref_twc = &poses[0];
    let init_depth = 3.0;
    let init_cov2 = 3.0;
    let mut depth = ImageBuffer::from_pixel(WIDTH as u32, HEIGHT as u32, Luma([init_depth]));
    let mut depth_cov2 = ImageBuffer::from_pixel(WIDTH as u32, HEIGHT as u32, Luma([init_cov2]));

    for index in 1..color_image_files.len() {
        println!("å¤„ç†ç¬¬ {} å¼ å›¾åƒ", index);
        let curr_img = image::open(&color_image_files[index])?.to_luma8();
        let pose_curr_twc = &poses[index];
        let pose_t_c_r = pose_curr_twc.inverse() * pose_ref_twc.clone();

        // æ›´æ–°æ·±åº¦å›¾
        for x in BOARDER..WIDTH - BOARDER {
            for y in BOARDER..HEIGHT - BOARDER {
                let depth_cov = (depth_cov2.get_pixel(x as u32, y as u32)[0] as f64).sqrt();
                if depth_cov < MIN_COV || depth_cov > MAX_COV {
                    continue;
                }

                let mut pt_curr = Vector2::zeros();
                let mut epipolar_direction = Vector2::zeros();
                let pt_ref = Vector2::new(x as f64, y as f64);

                if epipolar_search(&ref_img, &curr_img, &pose_t_c_r, &pt_ref, depth.get_pixel(x as u32, y as u32)[0], depth_cov, &mut pt_curr, &mut epipolar_direction) {
                    update_depth_filter(&pt_ref, &pt_curr, &pose_t_c_r, &epipolar_direction, &mut depth, &mut depth_cov2);
                    // æ˜¾ç¤ºæçº¿(çº¿æ®µ)
                    show_epipolar_line(&ref_img, &curr_img, (x as f32, y as f32), (pt_curr.x as f32, pt_curr.y as f32), (pt_curr.x as f32 + epipolar_direction.x as f32, pt_curr.y as f32 + epipolar_direction.y as f32), index, output_dir);
                    // æ˜¾ç¤ºæçº¿åŒ¹é…
                    show_epipolar_match(&ref_img, &curr_img, (x, y), (pt_curr.x as i32, pt_curr.y as i32), index + 1, output_dir);
                }
            }
        }
        evaluate_depth(&ref_depth, &depth);
        let rand_number = rand::random::&LTu32>() % 1000;
        save_depth_image(&depth, &output_dir.join(format!("depth_{index}_{rand_number}.png")));
    }

    println!("ç¨‹åºæ‰§è¡Œå®Œæˆ");
    Ok(())
}
</code></pre><h3 id=xiao-guo>æ•ˆæœ</h3><pre class=language-log data-lang=log><code class=language-log data-lang=log>ç¨‹åºå¼€å§‹æ‰§è¡Œ...
å¼€å§‹è¯»å–æ•°æ®é›†æ–‡ä»¶...
è¯»å–è½¨è¿¹å’Œå›¾åƒæ–‡ä»¶å®Œæˆï¼Œå…±è¯»å– 201 å¼ å›¾åƒ
å‚è€ƒæ·±åº¦å›¾åŠ è½½å®Œæˆ
å¤„ç†ç¬¬ 1 å¼ å›¾åƒ
å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[20.0, 20.0]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[20.0, 20.0]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-1.8693913433010692, 1.3664523892875033, 3.0006036072515196]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[1.3686227157496347, -1.0011821385364805, -2.197007571459172]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-5.107405402351772, 3.734086917111487, 8.198214785962211]]
æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ï¼Œç‚¹ï¼š[[19.709947017813022, 20.911598228801864]]
æçº¿æœç´¢å¤±è´¥ï¼Œæœ€ä½³ NCC ä¸º -1
å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[20.0, 21.0]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[20.0, 21.0]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-1.8693827350313288, 1.3602023912233974, 3.000598715452996]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[1.3686164140588197, -0.9966068224063478, -2.197003990414112]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-5.107381884121477, 3.717011604853142, 8.198201421320103]]
æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ï¼Œç‚¹ï¼š[[19.71083876879817, 21.91104202810277]]
æçº¿æœç´¢å¤±è´¥ï¼Œæœ€ä½³ NCC ä¸º -1
å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[20.0, 22.0]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[20.0, 22.0]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-1.8693741267615887, 1.3539523931592907, 3.0005938236544716]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[1.3686101123680046, -0.992031506276215, -2.197000409369052]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-5.107358365891182, 3.699936292594796, 8.198188056677997]]
æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ï¼Œç‚¹ï¼š[[19.7117305226908, 22.910489086143826]]
æçº¿æœç´¢å¤±è´¥ï¼Œæœ€ä½³ NCC ä¸º -1
å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[20.0, 23.0]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[20.0, 23.0]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-1.8693655184918485, 1.3477023950951843, 3.0005889318559475]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[1.3686038106771896, -0.987456190146082, -2.196996828323992]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-5.107334847660885, 3.6828609803364505, 8.198174692035886]]
æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ï¼Œç‚¹ï¼š[[19.71262227949103, 23.90993940294092]]
æçº¿æœç´¢å¤±è´¥ï¼Œæœ€ä½³ NCC ä¸º -1
å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[20.0, 24.0]]
æ’å€¼ç»“æœï¼š0.45378002051700056
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[34.941196008644, 273.8573589563265]]
æ’å€¼ç»“æœï¼š0.44161817260912173
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[34.941196008644, 274.8573589563265]]
æ’å€¼ç»“æœï¼š0.4616305554813449
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[34.941196008644, 275.8573589563265]]
æ’å€¼ç»“æœï¼š0.48169858265169746
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[34.941196008644, 276.8573589563265]]
æ’å€¼ç»“æœï¼š0.4624760172710629
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[34.941196008644, 277.8573589563265]]
æ’å€¼ç»“æœï¼š0.4833474248532138
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[34.941196008644, 278.8573589563265]]
æ’å€¼ç»“æœï¼š0.5117548311170721
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 272.8573589563265]]
æ’å€¼ç»“æœï¼š0.4478432207576696
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 273.8573589563265]]
æ’å€¼ç»“æœï¼š0.42718292336624775
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 274.8573589563265]]
æ’å€¼ç»“æœï¼š0.45748061624595493
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 275.8573589563265]]
æ’å€¼ç»“æœï¼š0.4734576985005847
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 276.8573589563265]]
æ’å€¼ç»“æœï¼š0.4516662716854218
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 277.8573589563265]]
æ’å€¼ç»“æœï¼š0.42698323561167817
åŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[35.941196008644, 278.8573589563265]]
æ’å€¼ç»“æœï¼š0.4694125351752237
NCC è¯„åˆ†ï¼š0.924036091750607
æçº¿æœç´¢æˆåŠŸï¼Œæœ€ä½³åŒ¹é…ç‚¹ï¼š[[32.941196008644, 275.8573589563265]]
æ›´æ–°æ·±åº¦æ»¤æ³¢å™¨ï¼Œå‚è€ƒç‚¹ï¼š[[33.0, 275.0]]ï¼Œå½“å‰ç‚¹ï¼š[[32.941196008644, 275.8573589563265]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[33.0, 275.0]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[32.941196008644, 275.8573589563265]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[32.92309742015061, 276.001493721201]]
æ·±åº¦æ›´æ–°å®Œæˆï¼Œæ–°æ·±åº¦ï¼š0.08288561637779884
å¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[33.0, 276.0]]
åƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[33.0, 276.0]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-1.7861402456029445, -0.23343549458515642, 2.9993614389929117]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[1.3076786824487272, 0.17001707887216214, -2.196098241182322]]
ç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[-4.879959173654615, -0.6368880680424751, 8.194821119168147]]
æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ï¼Œç‚¹ï¼š[[32.94210970694951, 276.8576308424161]]
è®¡ç®— NCC è¯„åˆ†ï¼Œå‚è€ƒç‚¹ï¼š[[33.0, 276.0]]ï¼Œå½“å‰ç‚¹ï¼š[[32.94210970694951, 276.8576308424161]]
</code></pre><h3 id=fen-xi>åˆ†æ</h3><p>è¿™ä»½æ—¥å¿—è®°å½•äº†ç¨ å¯†æ·±åº¦ä¼°è®¡è¿‡ç¨‹ä¸­çš„å…³é”®æ­¥éª¤å’Œæ•°æ®ï¼ŒåŒ…æ‹¬å›¾åƒè¯»å–ã€æçº¿æœç´¢ã€åæ ‡è½¬æ¢ã€æ’å€¼è®¡ç®—ã€NCCè¯„åˆ†ä»¥åŠæ·±åº¦æ»¤æ³¢å™¨æ›´æ–°ç­‰ã€‚ä»¥ä¸‹æ˜¯å¯¹å„éƒ¨åˆ†çš„è¯¦ç»†åˆ†æï¼š<ol><li><p><strong>æ•°æ®è¯»å–</strong></p> <ul><li>â€œå¼€å§‹è¯»å–æ•°æ®é›†æ–‡ä»¶...è¯»å–è½¨è¿¹å’Œå›¾åƒæ–‡ä»¶å®Œæˆï¼Œå…±è¯»å–201å¼ å›¾åƒï¼Œå‚è€ƒæ·±åº¦å›¾åŠ è½½å®Œæˆâ€ï¼šç¨‹åºæˆåŠŸè¯»å–äº†åŒ…å«201å¼ å›¾åƒçš„æ•°æ®é›†ä»¥åŠå‚è€ƒæ·±åº¦å›¾ï¼Œä¸ºåç»­çš„æ·±åº¦ä¼°è®¡æä¾›æ•°æ®åŸºç¡€ã€‚</ul><li><p><strong>æçº¿æœç´¢</strong></p> <ul><li>æ—¥å¿—ä¸­å¤šæ¬¡å‡ºç°â€œå¼€å§‹æçº¿æœç´¢ï¼Œå‚è€ƒç‚¹ï¼š[[x, y]]â€ï¼Œè¡¨æ˜åœ¨ä¸åŒçš„åƒç´ ä½ç½®ä¸Šè¿›è¡Œæçº¿æœç´¢ï¼Œå°è¯•åœ¨å½“å‰å›¾åƒä¸­æ‰¾åˆ°ä¸å‚è€ƒå›¾åƒä¸­ç‰¹å®šç‚¹åŒ¹é…çš„ç‚¹ã€‚æçº¿æœç´¢çš„èŒƒå›´å¯èƒ½ç”±æ·±åº¦å‡å€¼å’Œæ–¹å·®ç­‰å› ç´ å†³å®šï¼ˆæ ¹æ®å‰é¢æåˆ°çš„æçº¿æœç´¢åŸç†ï¼‰ã€‚<li>â€œæçº¿æœç´¢å¤±è´¥ï¼Œæœ€ä½³NCCä¸º -1â€ï¼šå¤šæ¬¡å‡ºç°æ­¤æç¤ºï¼Œè¯´æ˜åœ¨æŸäº›å‚è€ƒç‚¹çš„æçº¿æœç´¢è¿‡ç¨‹ä¸­ï¼Œæœªèƒ½æ‰¾åˆ°åˆé€‚çš„åŒ¹é…ç‚¹ã€‚NCCï¼ˆå½’ä¸€åŒ–äº’ç›¸å…³ï¼‰å€¼ä¸º -1 è¡¨æ˜å‚è€ƒå›¾åƒå—ä¸å½“å‰å›¾åƒå—ä¹‹é—´çš„ç›¸ä¼¼åº¦æä½ï¼Œå¯èƒ½ç”±äºåœºæ™¯çš„å¤æ‚æ€§ã€å›¾åƒå™ªå£°æˆ–çº¹ç†ç¼ºå¤±ç­‰åŸå› å¯¼è‡´åŒ¹é…å¤±è´¥ã€‚<li>â€œæçº¿æœç´¢æˆåŠŸï¼Œæœ€ä½³åŒ¹é…ç‚¹ï¼š[[x, y]]â€ï¼šå½“æçº¿æœç´¢æˆåŠŸæ—¶ï¼Œè®°å½•äº†æ‰¾åˆ°çš„æœ€ä½³åŒ¹é…ç‚¹çš„åæ ‡ã€‚ä¾‹å¦‚ï¼Œåœ¨å‚è€ƒç‚¹ä¸º [[20.0, 24.0]] é™„è¿‘çš„æœç´¢è¿‡ç¨‹ä¸­ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†æœ€ä½³åŒ¹é…ç‚¹ [[32.941196008644, 275.8573589563265]]ï¼Œå¹¶ä¸”ç»™å‡ºäº†è¯¥åŒ¹é…çš„NCCè¯„åˆ†ï¼š0.924036091750607ï¼Œè¡¨æ˜è¿™ä¸¤ä¸ªå›¾åƒå—ä¹‹é—´å…·æœ‰è¾ƒé«˜çš„ç›¸ä¼¼åº¦ã€‚</ul><li><p><strong>åæ ‡è½¬æ¢</strong></p> <ul><li>â€œåƒç´ åˆ°ç›¸æœºåæ ‡ç³»ï¼Œåƒç´ ç‚¹ï¼š[[x, y]]â€ï¼šè®°å½•äº†å°†åƒç´ åæ ‡è½¬æ¢ä¸ºç›¸æœºåæ ‡ç³»ä¸‹çš„æ–¹å‘å‘é‡çš„æ“ä½œï¼Œé€šè¿‡ç›¸æœºå†…å‚å®ç°è¿™ç§è½¬æ¢ï¼Œä¸ºåç»­ä¸‰è§’åŒ–è®¡ç®—æ·±åº¦æä¾›åŸºç¡€ã€‚<li>â€œç›¸æœºåæ ‡ç³»åˆ°åƒç´ ï¼Œç›¸æœºç‚¹ï¼š[[x, y, z]]â€ï¼šå±•ç¤ºäº†å°†ç›¸æœºåæ ‡ç³»ä¸‹çš„ç‚¹æŠ•å½±å›åƒç´ å¹³é¢çš„è¿‡ç¨‹ï¼Œè¿™ä¸€æ“ä½œæœ‰åŠ©äºéªŒè¯åæ ‡è½¬æ¢çš„æ­£ç¡®æ€§ä»¥åŠæ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å›¾åƒè¾¹æ¡†å†…ã€‚</ul><li><p><strong>åŒçº¿æ€§æ’å€¼ä¸NCCè¯„åˆ†</strong></p> <ul><li>â€œæ’å€¼ç»“æœï¼šxâ€å’Œâ€œåŒçº¿æ€§æ’å€¼ï¼Œç‚¹ï¼š[[x, y]]â€ï¼šåœ¨æçº¿æœç´¢è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å¯¹å›¾åƒè¿›è¡Œäº†åŒçº¿æ€§æ’å€¼æ“ä½œä»¥è·å–æ›´ç²¾ç¡®çš„åƒç´ å€¼ï¼Œç”¨äºè®¡ç®—NCCè¯„åˆ†ã€‚å¤šä¸ªæ’å€¼ç»“æœè¡¨æ˜åœ¨ä¸åŒä½ç½®è¿›è¡Œäº†æ’å€¼è®¡ç®—ï¼Œä»¥è¯„ä¼°ä¸åŒä½ç½®çš„ç›¸ä¼¼åº¦ã€‚<li>â€œNCCè¯„åˆ†ï¼šxâ€ï¼šé€šè¿‡è®¡ç®—å‚è€ƒå›¾åƒå—ä¸å½“å‰å›¾åƒå—ä¹‹é—´çš„NCCå€¼æ¥è¡¡é‡å®ƒä»¬çš„ç›¸ä¼¼åº¦ï¼Œå½“NCCè¯„åˆ†è¶³å¤Ÿé«˜æ—¶ï¼Œè®¤ä¸ºæ‰¾åˆ°äº†è¾ƒå¥½çš„åŒ¹é…ç‚¹ã€‚å¦‚å‰é¢æåˆ°çš„æçº¿æœç´¢æˆåŠŸæ¡ˆä¾‹ä¸­ï¼ŒNCCè¯„åˆ†ä¸º0.924036091750607ï¼Œè¯´æ˜åŒ¹é…æ•ˆæœè¾ƒå¥½ã€‚</ul><li><p><strong>æ·±åº¦æ»¤æ³¢å™¨æ›´æ–°</strong></p> <ul><li>â€œæ›´æ–°æ·±åº¦æ»¤æ³¢å™¨ï¼Œå‚è€ƒç‚¹ï¼š[[x, y]]ï¼Œå½“å‰ç‚¹ï¼š[[x, y]]â€ï¼šåœ¨æ‰¾åˆ°æçº¿æœç´¢çš„æœ€ä½³åŒ¹é…ç‚¹åï¼Œä½¿ç”¨å‚è€ƒç‚¹å’Œå½“å‰ç‚¹çš„ä¿¡æ¯æ¥æ›´æ–°æ·±åº¦æ»¤æ³¢å™¨ã€‚<li>â€œæ·±åº¦æ›´æ–°å®Œæˆï¼Œæ–°æ·±åº¦ï¼šxâ€ï¼šæ ¹æ®æ·±åº¦æ›´æ–°å…¬å¼ï¼ˆå¦‚å‰é¢æåˆ°çš„æ·±åº¦æ»¤æ³¢å™¨éƒ¨åˆ†çš„å…¬å¼ï¼‰ï¼Œé€šè¿‡é«˜æ–¯èåˆæ›´æ–°æ·±åº¦ä¼°è®¡ï¼Œå¾—åˆ°æ–°çš„æ·±åº¦å€¼ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œå¾—åˆ°çš„æ–°æ·±åº¦ä¸º0.08288561637779884 ã€‚</ul></ol><p>æ€»ä½“è€Œè¨€ï¼Œè¿™ä»½æ—¥å¿—è¯¦ç»†è®°å½•äº†ç¨ å¯†æ·±åº¦ä¼°è®¡è¿‡ç¨‹ä¸­å„ä¸ªå…³é”®æ­¥éª¤çš„æ‰§è¡Œæƒ…å†µå’Œä¸­é—´æ•°æ®ï¼Œé€šè¿‡åˆ†æè¿™äº›æ•°æ®å¯ä»¥äº†è§£ç®—æ³•çš„æ‰§è¡Œæ•ˆæœã€å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼ˆå¦‚æçº¿æœç´¢å¤±è´¥ï¼‰ä»¥åŠæ·±åº¦ä¼°è®¡çš„æ›´æ–°è¿‡ç¨‹ã€‚</article><div><div class=post-copyright><div class=post-copyright__author_group><a class=post-copyright__author_img href=/about> <picture class="post-copyright__author_img_back progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture> </a><div class=post-copyright__author_name>ByeIOÂ·å¼€å‘è€…åšå®¢</div><div class=post-copyright__author_desc>ByeIOÂ·å¼€å‘è€…åšå®¢|æŠ€æœ¯è§£å†³æ–¹æ¡ˆ|å¼€å‘æ€è€ƒ|æ€»ç»“</div></div><div class=post-tools id=post-tools><div class=post-tools-left><div class=rewardLeftButton><div class="reward-link mode"><a class=reward-link-button href=/subscribe> <i class=icon-plant-fill></i>è®¢é˜… </a></div></div><div class=shareRight><div class="copyright-link mobile"><div class=copyright-qrcode><div class=copyright-button title=ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« ><i class=icon-qrcode></i></div><div class=copyright-main><div class=copyright-main-all><div id=qrcode></div><div class=reward-dec>ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« </div></div></div></div></div><div class="copyright-link copyurl"><div class=copyright-button id=post-share-url onclick=rm.copyPageUrl() title=å¤åˆ¶é“¾æ¥><i class=icon-link></i></div></div></div></div></div><div class=post-copyright__notice><span class=post-copyright-info> æœ¬æ–‡æ˜¯åŸåˆ›æ–‡ç« ï¼Œé‡‡ç”¨ <a href=/copyright target=_blank>CC BY-NC-ND 4.0</a> åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜ <a href=/ target=_blank>æœ¬ç«™åç§°åŠåœ°å€</a> </span></div></div><div class=post-tools-right><div class=tag_share><div class=post-meta__tag-list><a class=post-meta__tags href=/tags/blog/> <span class=tags-punctuation>åšå®¢</span> <span class=tagsPageCount>31</span> </a><a class=post-meta__tags href=/tags/docs/> <span class=tags-punctuation>æ–‡æ¡£</span> <span class=tagsPageCount>25</span> </a><a class=post-meta__tags href=/tags/featured/> <span class=tags-punctuation>å¿…çœ‹</span> <span class=tagsPageCount>30</span> </a><a class=post-meta__tags href=/tags/hot/> <span class=tags-punctuation>çƒ­é—¨</span> <span class=tagsPageCount>30</span> </a></div></div></div><link href=/css/post-copyright-one.css rel=stylesheet></div><nav class="pagination-post needEndHide" id=pagination><div class="prev-post pull-left"><a href=/articles/docs/æŠ˜è…¾ç¬”è®°[13]-ä½¿ç”¨rustå¯¹å›¾åƒå»ºç«‹è¯è¢‹/> <div class=pagination-info><div class=label>ä¸Šä¸€ç¯‡</div><div class=prev_info>æŠ˜è…¾ç¬”è®°[13]-ä½¿ç”¨rustå¯¹å›¾åƒå»ºç«‹è¯è¢‹</div></div> </a></div><div class="next-post pull-right"><a href=/articles/docs/æŠ˜è…¾ç¬”è®°[18]-ä½¿ç”¨rustè¯»å–rosbagæ•°æ®/> <div class=pagination-info><div class=label>ä¸‹ä¸€ç¯‡</div><div class=next_info>æŠ˜è…¾ç¬”è®°[18]-ä½¿ç”¨rustè¯»å–rosbagæ•°æ®</div></div> </a></div></nav><div class=relatedPosts><div class=headline><i class=icon-cainixihuan style=font-size:1.1rem></i><span>å–œæ¬¢è¿™ç¯‡æ–‡ç« çš„äººä¹Ÿçœ‹äº†</span></div><div class=relatedPosts-list><div><a href=/articles/docs/ROSç¬”è®°[1]-æ­å»ºGazeboä»¿çœŸç¯å¢ƒ/ title=ROSç¬”è®°[1]-æ­å»ºGazeboä»¿çœŸç¯å¢ƒ> <picture class="cover progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> <div class="content is-center"><div class=date><i class="far fa-calendar-alt fa-fw"></i> 2025-01-01</div><div class=title>ROSç¬”è®°[1]-æ­å»ºGazeboä»¿çœŸç¯å¢ƒ</div></div> </a></div><div><a href=/articles/docs/ROSç¬”è®°[2]-è·å–OpenMVæ•°æ®å¹¶å‘å¸ƒåˆ°ROSæ¶ˆæ¯/ title=ROSç¬”è®°[2]-è·å–OpenMVæ•°æ®å¹¶å‘å¸ƒåˆ°ROSæ¶ˆæ¯> <picture class="cover progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> <div class="content is-center"><div class=date><i class="far fa-calendar-alt fa-fw"></i> 2025-01-01</div><div class=title>ROSç¬”è®°[2]-è·å–OpenMVæ•°æ®å¹¶å‘å¸ƒåˆ°ROSæ¶ˆæ¯</div></div> </a></div></div></div><link href=/css/related-posts-two.css rel=stylesheet><hr></div><div class=aside-content id=aside-content><div class="card-widget card-info"><div class=card-content><div class="card-info-avatar is-center"><div class=author-info__top-group><div class=author-info__sayhi id=author-info__sayhi onclick=wjx.changeSayHelloText()>å¥½ä¹…ä¸è§ï¼Œä½ ç»ˆäºæ¥äº†</div></div></div><div class=avatar-img-group><picture class="avatar-img progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture></div><div class=author-info__description_group>ä¸ºåˆ›é€ è€…è€Œç”Ÿçš„å¼€æº Zola ä¸»é¢˜~</div><div class=author-info__bottom-group><a class=author-info__bottom-group-left href=/about> <div class=author-info__name>qsbye</div> <div class=author-info__desc>ByeIOÂ·å¼€å‘è€…åšå®¢|æŠ€æœ¯è§£å†³æ–¹æ¡ˆ|å¼€å‘æ€è€ƒ|æ€»ç»“</div> </a><div class="card-info-social-icons is-center"><a rel="external nofollow" class=social-icon href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang target=_blank title=GitHub> <i class=icon-github></i> </a></div></div></div><style>.avatar-img-group:before{content:"";-o-transition:1s;background:var(--wjx-green);border:5px solid var(--wjx-background);z-index:2;border-radius:50%;width:26px;height:26px;-webkit-transition:all 1s;-moz-transition:all 1s;-ms-transition:all 1s;transition:all 1s;position:absolute;bottom:2px;right:2px}.card-info-avatar.is-center{flex-direction:column;align-items:flex-start;display:flex}#aside-content .card-info .avatar-img{opacity:1;border:5px solid var(--wjx-white);border-radius:500px;width:118px;transition:all .3s;position:absolute;top:0;right:0;overflow:hidden}.page #aside-content .card-info .avatar-img{border-color:var(--wjx-card-bg)}.author-info__top-group{width:100%;height:28px;display:flex}.avatar-img-group{transform-origin:bottom;border-radius:500px;width:118px;height:118px;transition:all .3s cubic-bezier(.69,.39,0,1.21);position:absolute;top:90px;right:calc(50% - 59px)}#aside-content .card-info:hover .avatar-img-group{opacity:0;transform:scale(0)}.author-info__bottom-group{justify-content:space-between;align-items:center;width:100%;padding:1.2rem;display:flex;position:absolute;bottom:0;left:0}a.author-info__bottom-group-left:hover{opacity:.8}#aside-content .card-info .card-info-social-icons{cursor:pointer;flex-flow:wrap;justify-content:flex-start;margin:0;display:flex}#aside-content .card-info .card-info-social-icons i:hover{cursor:pointer;background-color:#000;transform:rotate(540deg)}#aside-content .card-info .card-info-social-icons .social-icon{margin:0 0 0 8px}#aside-content .card-info .card-info-social-icons i{background:var(--wjx-white-op);color:var(--wjx-white);justify-content:center;align-items:center;width:40px;height:40px;font-size:1rem;display:flex}#aside-content .card-info .card-info-social-icons i:hover{background:var(--wjx-white);color:var(--wjx-main);box-shadow:none;transform:scale(1.1)}[data-theme=dark] .page #aside-content .card-info .card-info-social-icons i{background:var(--wjx-black-op);color:var(--wjx-card-bg)}[data-theme=dark] .page #aside-content .card-info .card-info-social-icons i:hover{background:var(--wjx-card-bg);color:var(--wjx-fontcolor)}#aside-content .card-info .banner-button{border-radius:20px;justify-content:center;width:118px;height:40px}@media screen and (width>=1300px){#aside-content .card-info .card-info-social-icons i{color:var(--wjx-white)}[data-theme=dark] .page #aside-content .card-info .card-info-social-icons i{color:var(--wjx-card-bg)}}#aside-content .card-info .card-info-data>.card-info-data-item:hover{background:var(--wjx-post-blockquote-bg);transform:scale(.97)}#aside-content>div.card-widget.card-info>div.card-content>div.card-info-data>.card-info-data-item:hover>a>div.headline,#aside-content>div.card-widget.card-info>div.card-content>div.card-info-data>.card-info-data-item:hover>a>div.length-num{color:var(--wjx-blue)}.author-info__description_group{color:var(--wjx-white);opacity:0;width:100%;padding:1.2rem;transition:all .3s;position:absolute;top:50px;left:0}.card-widget:hover .author-info__description_group{opacity:1}.author-info__description2{text-align:justify;z-index:2;color:#fffc;width:100%;margin:.3rem 0;line-height:1.38}.author-info__description2 b{color:var(--wjx-white)}[data-theme=dark] .page div#author-info__sayhi{background:var(--wjx-black-op);color:var(--wjx-black)}#aside-content .card-info .author-info__name{text-align:left;color:var(--wjx-white);margin-bottom:5px;font-size:20px;font-weight:700;line-height:1}.page #aside-content .card-info .author-info__name,.page .author-info__desc{color:var(--wjx-white)}.author-info__desc{color:var(--wjx-white);opacity:.6;font-size:12px;line-height:1}.author-info__description{text-align:justify;color:var(--wjx-white);opacity:1;margin:.3rem 0;line-height:1.38}.page .author-info__description{color:var(--wjx-card-bg)}.author-info__description b{color:var(--wjx-white);opacity:1}.page .author-info__description b{color:var(--wjx-card-bg);opacity:1}.avatar-sticker{z-index:0;background:var(--wjx-white);border-radius:50%;justify-content:center;align-items:center;width:33px;height:33px;line-height:34px;transition:all .3s ease-out .2s;display:flex;position:absolute;bottom:2px;right:2px;transform:scale(1)}.page .avatar-sticker{background:var(--wjx-card-bg)}.avatar-sticker img{width:26px;height:26px}.card-widget:hover .avatar-sticker{opacity:0;transform:scale(0)}.author-info__description b{color:var(--wjx-white)}#aside-content>.card-widget.card-info:before{background:linear-gradient(-25deg,var(--wjx-main),var(--wjx-main-op-deep),var(--wjx-main),var(--wjx-main-op-deep));content:"";background-size:400%;width:100%;height:100%;animation:15s infinite gradient;position:absolute;top:0;left:0}</style></div><div class="card-widget wjx-right-widget" onclick="javascript:window.open('/subscribe')" id=card-wechat><div id=flip-wrapper><div id=flip-content><div style="background:url(/img/wechat/qr-green.avif) 50%/100% no-repeat" class=face></div><div class="back face" style="background:url(/img/wechat/qr-white.avif) 50%/100% no-repeat"></div></div></div><style>#aside-content .card-widget#card-wechat{background:#07c160}#aside-content .card-widget#card-wechat:before{content:"";background:url(/img/wechat/gzh_cover.avif) 50%/cover no-repeat;width:100%;height:90%;transition:all .2s cubic-bezier(.45,.04,.43,1.21);position:absolute;top:0;left:0}#aside-content .card-widget#card-wechat:hover:before{opacity:0;transition:all .3s ease-out;top:100%}</style></div><div class=sticky_layout><div class=card-widget id=card-toc><div class=item-headline><i class=icon-bars></i><span>æ–‡ç« ç›®å½•</span><span class=toc-percentage></span></div><div class=toc-content></div></div><div class="card-widget card-recent-post"><div class=item-headline><i class=icon-chat--fill style=font-size:19px></i><span>æœ€æ–°è¯„è®º</span></div><div class=aside-list id=newcomm></div></div><div class="card-widget card-recent-post"><div class=item-headline><i class=icon-eicon_map-2-line1></i><span>æœ€è¿‘å‘å¸ƒ</span></div><div class=aside-list><div class=aside-list-item><a class=thumbnail href=/articles/docs/é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5/ title=é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a class=title href=/articles/docs/é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5/ title=é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5>é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5</a></div></div><div class=aside-list-item><a class=thumbnail href=/articles/docs/è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ/ title=è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a class=title href=/articles/docs/è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ/ title=è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ>è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ</a></div></div><div class=aside-list-item><a href="/articles/docs/ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight/" title="ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight" class=thumbnail> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a href="/articles/docs/ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight/" title="ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight" class=title>ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight</a></div></div><div class=aside-list-item><a class=thumbnail href=/articles/docs/æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ/ title=æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a class=title href=/articles/docs/æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ/ title=æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ>æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ</a></div></div></div></div><div class="card-widget card-categories"><div class=item-headline><i class=icon-folder-open></i><span>åˆ†ç±»</span></div><div class=aside-list><ul class=card-category-list><li class=card-category-list-item><a class=card-category-list-link href=/categories/misc/ rel=tag> <span class=card-category-list-name>æ‚è°ˆ</span> <span class=card-category-list-count>6</span> </a><li class=card-category-list-item><a class=card-category-list-link href=/categories/theme/ rel=tag> <span class=card-category-list-name>ä¸»é¢˜</span> <span class=card-category-list-count>25</span> </a></ul></div></div></div></div></main><footer id=footer><div id=wjx-footer-bar><div class=footer-logo>qsbye</div><div class=footer-bar-description>ByeIOÂ·å¼€å‘è€…åšå®¢|æŠ€æœ¯è§£å†³æ–¹æ¡ˆ|å¼€å‘æ€è€ƒ|æ€»ç»“</div><a class=footer-bar-link href=/about>äº†è§£æ›´å¤š</a></div><div id=footer_deal><a rel="external nofollow noopener noreferrer" class=deal_link href=mailto:mail@example.com target=_blank title=Mail> <i class=icon-envelope></i> </a><picture class="footer_mini_logo progressive-picture" onclick="btf.scrollToDest(0, 500)" style=border-radius:500px><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img alt=è¿”å›é¡¶éƒ¨ class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img alt=è¿”å›é¡¶éƒ¨ decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture><a rel="external nofollow noopener noreferrer" class=deal_link href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang target=_blank title=Github> <i class=icon-github></i> </a></div><div id=wjx-footer><div class=footer-group><h3 class=footer-title>æ–‡åº“</h3><div class=footer-links><a class=footer-item data-pjax href=/archives target=_blank>å…¨éƒ¨æ–‡ç« </a><a class=footer-item data-pjax href=/categories target=_blank>åˆ†ç±»åˆ—è¡¨</a><a class=footer-item data-pjax href=/tags target=_blank>æ ‡ç­¾åˆ—è¡¨</a><a class=footer-item data-pjax href=javascript:toRandomPost() target=_blank>éšæœºæ–‡ç« </a></div></div><div class=footer-group><h3 class=footer-title>ä½œå“</h3><div class=footer-links><a class=footer-item data-pjax href=/articles/misc/lorem-ipsum target=_blank>Lorem Ipsum</a></div></div><div class=footer-group><h3 class=footer-title>åè®®</h3><div class=footer-links><a class=footer-item data-pjax href=/privacy target=_blank>éšç§åè®®</a><a class=footer-item data-pjax href=/cookies target=_blank>Cookies</a><a class=footer-item data-pjax href=/copyright target=_blank>ç‰ˆæƒåè®®</a></div></div><div class=footer-group><div class=footer-title-group><h3 class=footer-title>å‹é“¾</h3><button class=random-friends-btn id=footer-random-friends-btn onclick=javascript:wjx.addFriendLinksInFooter(); title=æ¢ä¸€æ‰¹å‹æƒ…é“¾æ¥><i class=icon-arrow-rotate-right style=font-size:16px></i></button></div><div class=footer-links id=friend-links-in-footer></div></div></div><div id=footer-bar style=padding:1rem><div class=footer-bar-links><div class=footer-bar-left><div id=footer-bar-tips><div class=copyright-group>Â© <span class=inline-word id=copyright-info>2025</span> Â ByÂ  <a class=footer-bar-link href=/ target=_blank> <picture class=progressive-picture id=copyright-logo><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture> ByeIOÂ·å¼€å‘è€…åšå®¢ </a><script defer>var startYear = 2025;
                            var currentYear = new Date().getFullYear();
                            var copyrightInfo = `${startYear !== currentYear ? startYear + ' - ' : ''}${currentYear}`;
                            document.getElementById('copyright-info').innerHTML = copyrightInfo;</script></div><div class=compliance-group><a rel="noopener external nofollow noreferrer" class=footer-bar-link href=https://beian.miit.gov.cn/#/Integrated/index target=_blank> ICP </a><a class=footer-bar-link href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang> <div class=status-light></div> <span>æœ¬ç«™åŠä¸»é¢˜åŸºäº Zola æ„å»º</span> </a></div></div></div><div class=footer-bar-right><a class=footer-bar-link href=/subscribe target=_blank>è®¢é˜…</a><a class=footer-bar-link href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang target=_blank>ä¸»é¢˜</a><a class=footer-bar-link href=/about>å…³äº</a><a class=footer-bar-link href=mailto:mail@example.com target=_blank>åé¦ˆ</a><a class="footer-bar-link cc" href=/copyright rel=license target=_blank title=CCç‰ˆæƒåè®®> <i class=icon-copyright-line></i> <i class=icon-creative-commons-by-line></i> <i class=icon-creative-commons-nc-line></i> <i class=icon-creative-commons-nd-line></i> </a></div></div></div><div id=quit-box onclick=RemoveRewardMask()></div><div class="comment-barrage needEndHide" style=display:none></div><style>a.footer-bar-link.cloud{align-items:center;display:flex}img.entered.loading.cloud{height:32px}</style></footer></div><div id=sidebar><div id=menu-mask></div><div id=sidebar-menus><span class=sidebar-menu-item-title>åŠŸèƒ½</span><div class=sidebar-menu-item><button class="darkmode_switchbutton menu-child" href=javascript:void(0); onclick=rm.switchDarkMode() title=æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢><i class=icon-moon style=font-size:.9rem;line-height:2></i> <span>æ˜¾ç¤ºæ¨¡å¼</span></button></div><div class=back-menu-list-groups><div class=back-menu-list-group><div class=back-menu-list-title>ä½œå“</div><div class=back-menu-list><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a></div></div></div><div class=menus_items><div class=menus_item><button class=site-page><span>æ–‡åº“</span></button><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/archives> <i class="icon-book-open faa-tada" style=font-size:.9em></i> <span>å…¨éƒ¨æ–‡ç« </span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/categories> <i class="icon-folder-open faa-tada" style=font-size:.9em></i> <span>åˆ†ç±»åˆ—è¡¨</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/tags> <i class="icon-tags faa-tada" style=font-size:.9em></i> <span>æ ‡ç­¾åˆ—è¡¨</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=javascript:toRandomPost()> <i class="icon-artstation faa-tada" style=font-size:.9em></i> <span>éšæœºæ–‡ç« </span> </a></ul></div><div class=menus_item><a class=site-page href=/tags/work> <span>æ¨è</span> </a><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/articles/docs/readme> <i class="icon-music faa-tada" style=font-size:.9em></i> <span>åšå®¢ä¸»é¢˜ä»‹ç»</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/articles/misc/lorem-ipsum> <i class="icon-music faa-tada" style=font-size:.9em></i> <span>Lorem Ipsum</span> </a></ul></div><div class=menus_item><button class=site-page><span>å‹é“¾</span></button><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/friends> <i class="icon-link faa-tada" style=font-size:.9em></i> <span>å‹é“¾åˆ—è¡¨</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=javascript:travelling()> <i class="icon-paper-plane faa-tada" style=font-size:.9em></i> <span>éšæœºå‘ç°</span> </a></ul></div><div class=menus_item><button class=site-page><span>æˆ‘çš„</span></button><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/about> <i class="icon-rocket faa-tada" style=font-size:.9em></i> <span>å…³äºæœ¬äºº</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/equipment> <i class="icon-artstation faa-tada" style=font-size:.9em></i> <span>æˆ‘çš„è£…å¤‡</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/tags/project> <i class="icon-lightbulb faa-tada" style=font-size:.9em></i> <span>æˆ‘çš„é¡¹ç›®</span> </a></ul></div></div><span class=sidebar-menu-item-title>æ ‡ç­¾</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class=item-headline></div><div class=card-tag-cloud><a class=tag-item href=/tags/blog/ style=font-size:1em title=åšå®¢>  åšå®¢<sup>31</sup> </a><a class=tag-item href=/tags/docs/ style=font-size:1em title=æ–‡æ¡£>  æ–‡æ¡£<sup>25</sup> </a><a class=tag-item href=/tags/featured/ style=font-size:1em title=å¿…çœ‹>  å¿…çœ‹<sup>30</sup> </a><a class=tag-item href=/tags/hot/ style=font-size:1em title=çƒ­é—¨>  çƒ­é—¨<sup>30</sup> </a><a class=tag-item href=/tags/project/ style=font-size:1em title=é¡¹ç›®>  é¡¹ç›®<sup>1</sup> </a><a class=tag-item href=/tags/work/ style=font-size:1em title=work>  work<sup>1</sup> </a></div></div></div></div><div id=console><div class=close-btn href=javascript:void(0); onclick=wjx.hideConsole()><i class=icon-circle-xmark></i></div><div class=console-card-group><div class=console-card-group-left><div class=console-card id=card-newest-comments onclick=wjx.hideConsole()><div class=card-content><div class=author-content-item-tips>äº’åŠ¨</div><span class=author-content-item-title>æœ€è¿‘è¯„è®º</span></div><div class=aside-list><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div><div class=console-card-group-right><div class="console-card tags" onclick=wjx.hideConsole()><div class=card-content><div class=author-content-item-tips>æ ‡ç­¾</div><span class=author-content-item-title>å¯»æ‰¾æ„Ÿå…´è¶£çš„é¢†åŸŸ</span></div><div class=card-tag-cloud><a href=/tags/blog/ rel=tag style=color:#d3d3d3;font-size:1em> åšå®¢<sup>31</sup> </a><a href=/tags/docs/ rel=tag style=color:#d3d3d3;font-size:1em> æ–‡æ¡£<sup>25</sup> </a><a href=/tags/featured/ rel=tag style=color:#d3d3d3;font-size:1em> å¿…çœ‹<sup>30</sup> </a><a href=/tags/hot/ rel=tag style=color:#d3d3d3;font-size:1em> çƒ­é—¨<sup>30</sup> </a><a href=/tags/project/ rel=tag style=color:#d3d3d3;font-size:1em> é¡¹ç›®<sup>1</sup> </a><a href=/tags/work/ rel=tag style=color:#d3d3d3;font-size:1em> work<sup>1</sup> </a></div></div><div class="console-card history" onclick=wjx.hideConsole()><div class=item-headline><i class="fas fa-archive"></i><span>æ–‡ç« </span></div><ul class=card-archive-list><ul><li class=card-archive-list-item><a class=card-archive-list-link href=/archives> <span class=card-archive-list-date> 2025 1æœˆ </span> <div class=card-archive-list-count-group><span class=card-archive-list-count>25</span><span class=card-archive-list-count-unit>ç¯‡</span></div> </a></ul><ul><li class=card-archive-list-item><a class=card-archive-list-link href=/archives> <span class=card-archive-list-date> 2024 12æœˆ </span> <div class=card-archive-list-count-group><span class=card-archive-list-count>6</span><span class=card-archive-list-count-unit>ç¯‡</span></div> </a></ul></ul></div></div></div><div class=button-group><div class=console-btn-item><button rel="external nofollow" class=darkmode_switchbutton href=javascript:void(0); onclick=navFn.switchDarkMode(); title=æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢><i class=icon-moon-clear-fill style=font-size:1rem></i></button></div><div class=console-btn-item id=consoleHideAside onclick=wjx.hideAsideBtn() title=è¾¹æ æ˜¾ç¤ºæ§åˆ¶><button class=asideSwitch title=ä¾§è¾¹æ å¼€å…³><i class=icon-arrows-left-right></i></button></div><div class="console-btn-item on" id=consoleCommentBarrage onclick=wjx.switchCommentBarrage() title=çƒ­è¯„å¼€å…³><button class=commentBarrage><i class=icon-chat--fill></i></button></div></div><div class=console-mask href=javascript:void(0); onclick=wjx.hideConsole()></div></div><div id=rightside><div id=rightside-config-hide><button id=translateLink title=ç®€ç¹è½¬æ¢ type=button>ç¹</button><button id=darkmode title=æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢ type=button><i class=icon-circle-half-stroke></i></button><button id=hide-aside-btn title=å•æ å’ŒåŒæ åˆ‡æ¢ type=button><i class=icon-arrows-left-right></i></button></div><div id=rightside-config-show><button id=rightside-config title=è®¾ç½® type=button><i class=icon-gear></i></button><a href=#post-comment id=to_comment title=ç›´è¾¾è¯„è®º><i class=icon-chat--fill style=font-size:17px></i></a><button id=go-up title=å›åˆ°é¡¶éƒ¨ type=button><i class=icon-arrow-up></i></button></div></div><link onload="this.onload=null;this.rel='stylesheet'" as=style href=/css/read-mode.css rel=preload><noscript><link href=/css/read-mode.css rel=stylesheet></noscript><div class=js-pjax><div id=rightMenu><div class="rightMenu-group rightMenu-small"><div class=rightMenu-item id=menu-backward><i class=icon-arrow-left></i></div><div class=rightMenu-item id=menu-forward><i class=icon-arrow-right></i></div><div class=rightMenu-item id=menu-refresh><i class=icon-arrow-rotate-right></i></div><div class=rightMenu-item id=menu-top><i class=icon-arrow-up></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class=rightMenu-item id=menu-copytext><i class=icon-copy></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class=rightMenu-item id=menu-pastetext><i class=icon-paste></i><span>ç²˜è´´æ–‡æœ¬</span></div><a class=rightMenu-item id=menu-commenttext> <i class=icon-comment-medical></i> <span>å¼•ç”¨åˆ°è¯„è®º</span> </a><div class=rightMenu-item id=menu-newwindow><i class=icon-window-restore></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class=rightMenu-item id=menu-copylink><i class=icon-link></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class=rightMenu-item id=menu-copyimg><i class=icon-images></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class=rightMenu-item id=menu-downloadimg><i class=icon-download></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class=rightMenu-item id=menu-newwindowimg><i class=icon-window-restore></i><span>æ–°çª—å£æ‰“å¼€å›¾ç‰‡</span></div><div class=rightMenu-item id=menu-search><i class=icon-search--line></i><span>ç«™å†…æœç´¢</span></div><div class=rightMenu-item id=menu-searchBaidu><i class=icon-baidu></i><span>ç™¾åº¦æœç´¢</span></div><div class=rightMenu-item id=menu-music-toggle><i class=icon-play></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class=rightMenu-item id=menu-music-back><i class=icon-backward></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class=rightMenu-item id=menu-music-forward><i class=icon-forward></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div onclick="javascript:window.open('https://y.qq.com/n/ryqq/playlist/xxxxx')" class=rightMenu-item id=menu-music-playlist><i class=icon-radio></i><span>æŸ¥çœ‹æ‰€æœ‰æ­Œæ›²</span></div><div class=rightMenu-item id=menu-music-copyMusicName><i class=icon-copy></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id=menu-randomPost onclick=toRandomPost()> <i class=icon-shuffle></i> <span>éšä¾¿é€›é€›</span> </a><a class="rightMenu-item menu-link" href=../categories> <i class=icon-cube></i> <span>åšå®¢åˆ†ç±»</span> </a><a class="rightMenu-item menu-link" href=../tags> <i class=icon-tags></i> <span>æ–‡ç« æ ‡ç­¾</span> </a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><div class=rightMenu-item id=menu-copy><i class=icon-copy></i><span>å¤åˆ¶åœ°å€</span></div><div class=rightMenu-item draggable=false id=menu-commentBarrage style=display:flex><i class=icon-chat--fill style=font-size:19px></i><span class=menu-commentBarrage-text>æ˜¾ç¤ºçƒ­è¯„</span></div><div class=rightMenu-item id=menu-darkmode><i class=icon-moon-clear-fill style=font-size:19px></i><span class=menu-darkmode-text>æ·±è‰²æ¨¡å¼</span></div><div class=rightMenu-item id=menu-translate><i class=icon-fanti style=font-size:19px></i><span>è½‰ç‚ºç¹é«”</span></div></div></div><div id=rightmenu-mask></div></div><script defer onload src=/libs/qrcode/qrcode.min.js></script><script defer src=/libs/view-image/view-image.min.js></script><script defer src=/libs/tocbot/4.18.2/tocbot.min.js></script><link onload="this.onload=null;this.rel='stylesheet'" as=style href=/libs/tocbot/4.18.2/tocbot.css rel=preload><noscript><link href=/libs/tocbot/4.18.2/tocbot.css rel=stylesheet></noscript><script async src=/libs/snackbar/snackbar.min.js></script><script>var meting_api = "https:&#x2F;&#x2F;api.i-meto.com&#x2F;meting&#x2F;api?server=:server&amp;type=:type&amp;id=:id&amp;r=:r";</script><canvas height=880 id=universe width=1312></canvas><script defer src=/libs/canvas/dark.js></script><script src=/libs/waterfall/waterfall.min.js></script><script src=/libs/fast-average-color/index.browser.min.js></script><script>let pjaxSelectors = ['title', '#body-wrap', '#rightside-config-hide', '#rightside-config-show', '.js-pjax', '#site-config']
          
    pjaxSelectors.unshift('meta[property="og:type"]', 'meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]', 'meta[property="og:description"]'
            , 'meta[name="twitter:title"]', 'meta[name="twitter:url"]', 'meta[name="twitter:description"]', 'meta[name="twitter:image"]', 'meta[name="description"]')
    
    var pjax = new Pjax({
        elements: 'a:not([target="_blank"])',
        selectors: pjaxSelectors,
        cacheBust: false,
        //debug: true,        
        analytics: false,
        scrollRestoration: false
    })</script><script defer src=/js/rightmenu.js></script><script data-pjax defer src=/production/js/abstract/local.js></script><script data-pjax defer src=/production/js/bundle.js></script><script defer src=/js/tw_cn.js></script><script defer src=/libs/instantpage/instantpage.min.js type=module></script><link onload="this.rel='stylesheet'" as=style href=/libs/prism/prism.min.css rel=preload><noscript><link href=/libs/prism/prism.min.css rel=stylesheet></noscript><link onload="this.rel='stylesheet'" as=style href=/libs/prism/code.css rel=preload><noscript><link href=/libs/prism/code.css rel=stylesheet></noscript><link onload="this.rel='stylesheet'" as=style data-code-theme=light href=/libs/prism/themes/prism-one-dark.css rel=preload><noscript><link href=/libs/prism/themes/prism-one-dark.css rel=stylesheet></noscript><link onload="this.rel='stylesheet'" as=style data-code-theme=dark href=/libs/prism/themes/prism-one-dark.css rel=preload><noscript><link href=/libs/prism/themes/prism-one-dark.css rel=stylesheet></noscript><script defer src=/libs/prism/prism.min.js></script><style>#article-container .code-toolbar pre.close{height:300px;overflow:hidden}</style>