<!doctype html><html lang=zh-CN><head><title>æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰² | ByeIOÂ·å¼€å‘è€…åšå®¢</title><meta content=ByeIOÂ·å¼€å‘è€…åšå®¢ property=og:site_name><meta content=article property=og:type><meta content=æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰² property=og:title><meta content=//articles/docs/æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰²/ property=og:url><meta content=ä½¿ç”¨rustå’Œortåº“(onnxruntimeåç«¯)æ¨ç†SAM2.1æ¨¡å‹å¹¶è·å–å›¾åƒåˆ†å‰²ç»“æœ. property=og:description><meta content=/processed_images/img00006.3250c5dc35a28271.webp property=og:image><meta content=summary_large_image name=twitter:card><meta content=æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰² name=twitter:title><meta content=//articles/docs/æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰²/ name=twitter:url><meta content=ä½¿ç”¨rustå’Œortåº“(onnxruntimeåç«¯)æ¨ç†SAM2.1æ¨¡å‹å¹¶è·å–å›¾åƒåˆ†å‰²ç»“æœ. name=twitter:description><meta content=/processed_images/img00006.3250c5dc35a28271.webp name=twitter:image><meta content=ä½¿ç”¨rustå’Œortåº“(onnxruntimeåç«¯)æ¨ç†SAM2.1æ¨¡å‹å¹¶è·å–å›¾åƒåˆ†å‰²ç»“æœ. name=description><script id=ld-json type=application/ld+json>
        {
          "@context": "https://schema.org/",
          "@type": "Article",
          "headline": "æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰²",
          "author": {
            "@type": "Person",
            "name": "qsbye",
            "url": "/about"
          },
          "image": "/processed_images/img00006.c4abedc898f992a6.webp",
          "datePublished": "2025-01-01T00:00:00+00:00",
          
          "description": "ä½¿ç”¨rustå’Œortåº“(onnxruntimeåç«¯)æ¨ç†SAM2.1æ¨¡å‹å¹¶è·å–å›¾åƒåˆ†å‰²ç»“æœ."
        }
    </script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content="telephone=no" name=format-detection><meta content=var(--wjx-card-bg) name=theme-color><link href=/manifest.json rel=manifest><link href=/img/avatar.png rel=icon type=image/x-icon><link href=/img/avatar.png rel=apple-touch-icon><link href=/img/avatar.png rel=bookmark><link href=/img/avatar.png rel=apple-touch-icon-precomposed sizes=180x180><script src=/libs/jquery/jquery-3.7.1.min.js></script><script src=/libs/pjax/pjax.min.js></script><script src=/production/js/utils.js></script><link href=/production/css/blog.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link onload="this.onload=null;this.rel='stylesheet'" as=style href=/libs/snackbar/snackbar.min.css rel=preload><noscript><link href=/libs/snackbar/snackbar.min.css rel=stylesheet></noscript><script>// Added non-passive event listener
  !function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){var e,t=["scroll","wheel","touchstart","touchmove","touchenter","touchend","touchleave","mouseout","mouseleave","mouseup","mousedown","mousemove","mouseenter","mousewheel","mouseover"];if(function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}()){var n=EventTarget.prototype.addEventListener;e=n,EventTarget.prototype.addEventListener=function(n,o,r){var i,s="object"==typeof r&&null!==r,u=s?r.capture:r;(r=s?function(e){var t=Object.getOwnPropertyDescriptor(e,"passive");return t&&!0!==t.writable&&void 0===t.set?Object.assign({},e):e}(r):{}).passive=void 0!==(i=r.passive)?i:-1!==t.indexOf(n)&&!0,r.capture=void 0!==u&&u,e.call(this,n,o,r)},EventTarget.prototype.addEventListener._original=e}});</script><script>((win) => {
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return;
        const now = new Date();
        const expiryDay = ttl * 86400000;
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        };
        localStorage.setItem(key, JSON.stringify(item));
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key);

        if (!itemStr) {
          return undefined;
        }
        const item = JSON.parse(itemStr);
        const now = new Date();

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key);
          return undefined;
        }
        return item.value;
      },
    };

    win.getScript = (url) =>
      new Promise((resolve, reject) => {
        const script = document.createElement("script");
        script.src = url;
        script.async = true;
        script.onerror = reject;
        script.onload = script.onreadystatechange = function () {
          const loadState = this.readyState;
          if (loadState && loadState !== "loaded" && loadState !== "complete")
            return;
          script.onload = script.onreadystatechange = null;
          resolve();
        };
        document.head.appendChild(script);
      });

    win.getCSS = (url, id = false) =>
      new Promise((resolve, reject) => {
        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = url;
        if (id) link.id = id;
        link.onerror = reject;
        link.onload = link.onreadystatechange = function () {
          const loadState = this.readyState;
          if (loadState && loadState !== "loaded" && loadState !== "complete")
            return;
          link.onload = link.onreadystatechange = null;
          resolve();
        };
        document.head.appendChild(link);
      });

    win.activateDarkMode = function () {
      document.documentElement.setAttribute("data-theme", "dark");
      document.documentElement.classList.add("color-scheme-dark");
      wjx.initThemeColor();
    };
    win.activateLightMode = function () {
      document.documentElement.setAttribute("data-theme", "light");
      document.documentElement.classList.remove("color-scheme-dark");
      wjx.initThemeColor();
    };
    const t = saveToLocal.get("theme");

    const isDarkMode = window.matchMedia(
      "(prefers-color-scheme: dark)"
    ).matches;
    const isLightMode = window.matchMedia(
      "(prefers-color-scheme: light)"
    ).matches;
    const isNotSpecified = window.matchMedia(
      "(prefers-color-scheme: no-preference)"
    ).matches;
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified;

    if (t === undefined) {
      if (isLightMode) activateLightMode();
      else if (isDarkMode) activateDarkMode();
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date();
        const hour = now.getHours();
        const isNight = hour <= 6 || hour >= 18;
        isNight ? activateDarkMode() : activateLightMode();
      }
      window
        .matchMedia("(prefers-color-scheme: dark)")
        .addListener(function (e) {
          if (saveToLocal.get("theme") === undefined) {
            e.matches ? activateDarkMode() : activateLightMode();
          }
        });
    } else if (t === "light") activateLightMode();
    else activateDarkMode();

    if ("system" === "dark")
      activateDarkMode();
    else activateLightMode();

    const asideStatus = saveToLocal.get("aside-status");
    if (asideStatus !== undefined) {
      if (asideStatus === "hide") {
        document.documentElement.classList.add("hide-aside");
      } else {
        document.documentElement.classList.remove("hide-aside");
      }
    }
  })(window);</script><script data-pace-options='{ "restartOnRequestAfter":false,"eventLag":false}' src=/libs/pace/pace.min.js></script><script defer src=/libs/clipboard/clipboard.min.js></script><script src=/libs/countup/countup.js></script><link href=/icon/font.css rel=stylesheet><style>[data-theme=light]{--wjx-theme:#425aef!important;--wjx-theme-op:#425aef23!important;--wjx-theme-op-deep:#425aefdd!important;--wjx-theme-none:#425aef00!important}[data-theme=dark]{--wjx-theme:#f2b94b!important;--wjx-theme-op:#f2b94b23!important;--wjx-theme-op-deep:#f2b94bdd!important;--wjx-theme-none:#f2b94b00!important}:root{--halo-comment-widget-component-card-bg:var(--wjx-card-bg);--halo-comment-widget-component-theme-op:var(--wjx-theme-op);--halo-comment-widget-component-card-border:var(--wjx-card-border);--halo-comment-widget-component-shadow-border:var(--wjx-shadow-border);--halo-comment-widget-component-secondtext:var(--wjx-secondtext);--halo-comment-widget-component-lighttext:var(--wjx-lighttext);--halo-comment-widget-component-secondbg:var(--wjx-secondbg);--halo-comment-widget-component-fontcolor:var(--wjx-fontcolor);--halo-comment-widget-component-main:var(--wjx-main);--halo-comment-widget-component-background:var(--wjx-background);--halo-comment-widget-component-white:var(--wjx-white);--halo-comment-widget-component-shadow-black:var(--wjx-shadow-black)}#page{--halo-comment-widget-component-padding:1rem}.color-scheme-dark,.dark,[data-color-scheme=dark]{--halo-search-widget-color-modal-layer:var(--wjx-maskbgdeep);--halo-search-widget-color-modal-content-bg:var(--wjx-card-bg);--halo-search-widget-color-form-input:#fffc;--halo-search-widget-color-form-input-placeholder:#6b7280d9;--halo-search-widget-color-form-input-bg:var(--wjx-card-bg);--halo-search-widget-color-form-divider:#bbbbbb0f;--halo-search-widget-color-result-item-bg:var(--wjx-card-bg);--halo-search-widget-color-result-item-hover-bg:#90939914;--halo-search-widget-color-result-item-title:#fffc;--halo-search-widget-color-result-item-content:#ffffff82;--halo-search-widget-color-command-kbd-item:#c0c4ccb3;--halo-search-widget-color-command-kbd-border:#bbbbbb0f;--halo-search-widget-color-result-empty:#6b7280d9}[data-theme=light]{--halo-search-widget-color-result-item-title:#4b5563}</style><script id=site-config>var GLOBAL_CONFIG = {
        
                
        
        
        
        
        htmlType: "post",
        postTitle: "æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰²",
        isPost: true,
        isHome: false,
        passageTip: {
            enable: true,
            day: 60,
        },
        copyright: {
            enable: false,
            limitCount: 10,
            languages: {
                author: " ä½œè€…ï¼šqsbye",
                link: " é“¾æ¥ï¼š",
                source: " æ¥æºï¼šByeIOÂ·å¼€å‘è€…åšå®¢",
                info: " æç¤ºï¼šè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„å¹¶ä¿ç•™åŸæ–‡é“¾æ¥ã€‚"
            }
        },
        lightbox: 'fancybox',
        rightMenuEnable: true,
        lazyload: {
            enable: true,
            error: "/img/404.svg"
        },
        isFriendLinksInFooter: true,
        loadingBox: true,
        progress_bar: true,
        navMusicEnable: false,
        isMusic: false,
        helloText: ["ğŸ¤–ï¸ æ•°ç ç§‘æŠ€çˆ±å¥½è€…","ğŸ”¯ å…¨æ ˆæ¶æ„éƒ½åœ¨è¡Œ","ğŸ  æ™ºèƒ½å®¶å±…å°èƒ½æ‰‹","ğŸ¤ ç§‘ç ”ç§‘æ™®ä¸¤ä¸è¯¯","ğŸµ ä¸šä½™åŸåˆ›éŸ³ä¹äºº","ğŸƒ æ–‡è‰ºé’å¹´ç»†èŠ‚æ§","ğŸ” æ¢ç´¢ä¸–ç•Œæ¶‰çŒå¹¿","ğŸ¤› çƒ­çˆ±åˆ†äº«äº¤æœ‹å‹"],
        profileStyle: "one",
        enable: true,
        keyboard: true,
        date_suffix: {
            just: 'åˆšåˆš',
            min: 'åˆ†é’Ÿå‰',
            hour: 'å°æ—¶å‰',
            day: 'å¤©å‰',
            month: 'ä¸ªæœˆå‰'
        },
        Snackbar: {
            chs_to_cht: "ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",
            cht_to_chs: "ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",
            day_to_night: "ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",
            night_to_day: "ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",
            bgLight: "#425AEF",
            bgDark: "#f2b94b",
            position: "top-center"
        },
        translate: {
            defaultEncoding: "2",
            translateDelay: 0,
            msgToTraditionalChinese: "ç¹",
            msgToSimplifiedChinese: "ç®€",
            rightMenuMsgToTraditionalChinese: "è½‰ç‚ºç¹é«”",
            rightMenuMsgToSimplifiedChinese: "è½¬ä¸ºç®€ä½“"
        },
        prism: {
            enable: true,
            enable_title: true,
            enable_hr: true,
            enable_line: true,
            enable_copy: true,
            enable_expander: true,
            prism_limit: 330,
            enable_height_limit: false
        },
        
        source: {
            power: {
                powerLink: "/",
                showNum: 3
            },
            links: {
                linksUrl: "/friends",
                linksNum: 3
            },
            jQuery: '/libs/jquery/jquery.min.js',
            justifiedGallery: {
                js: '/libs/justified-gallery/fjGallery.min.js',
                css: '/libs/justified-gallery/fjGallery.css'
            },
            fancybox: {
                js: '/libs/fancybox/jquery.fancybox.min.js',
                css: '/null'
            },
            comments: {
                use: "twikoo",
                maxBarrage: 1,
                barrageTime: 4000,
                mailMd5: "",
                lazyload: false,
                textarea: "el-textarea__inner"
            },
            post: {
                dynamicBackground: true
            },
            tool: {
                switch: false
            },
            postAi: {
                
                gptName: "æœ¬åœ°",
                modeName: "local"
            },twikoo: {
                js: "/libs/twikoo/twikoo.all.min.js",
                twikooUrl: "https://your-api-url",
            },
            footer: {
                default_enable: true
            },
            about: {
                
                rewardList: [],
                rewardAmount: 10
            }
        }
    };</script><style id=wjx-theme-styles>:root{--wjx-main:var(--wjx-theme)!important;--wjx-main-op:var(--wjx-theme-op)!important;--wjx-main-op-deep:var(--wjx-theme-op-deep)!important;--wjx-main-op-light:var(--wjx-theme-op-light)!important;--wjx-main-none:var(--wjx-theme-none)!important}</style><script>document.addEventListener('pjax:send', function () {
      // removeEventListener toc scroll
      window.removeEventListener('scroll', window.tocScrollFn);
      typeof preloader === 'object' && preloader.initLoading();
      
      if (window.aplayers) {
          for (let i = 0; i < window.aplayers.length; i++) {
              if (!window.aplayers[i].options.fixed) {
                  window.aplayers[i].destroy()
              }
          }
      }
      
      typeof typed === 'object' && typed.destroy();
      typeof window.initializationRegistry === 'object' && window.initializationRegistry.clear();
      
      //reset readmode
      const $bodyClassList = document.body.classList
      $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
  })
  document.addEventListener('pjax:complete', function () {
      window.refreshFn();
      
      document.querySelectorAll('script[data-pjax]').forEach(item => {
                  const newScript = document.createElement('script')
                  const content = item.text || item.textContent || item.innerHTML || ""
                  Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
                  newScript.appendChild(document.createTextNode(content))
                  item.parentNode.replaceChild(newScript, item)
              }
      );

      typeof chatBtnFn === 'function' && chatBtnFn();
      typeof panguInit === 'function' && panguInit();
      
      // google analytics
      typeof gtag === 'function' && gtag('config', '', {
          'page_path': window.location.pathname
      });
      
      // baidu analytics
      typeof _hmt === 'object' && _hmt.push(['_trackPageview', window.location.pathname]);
      
      typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting();
      
      // Analytics
      if (false) {
          MtaH5.pgv()
      }
      
      // prismjs
      typeof Prism === 'object' && Prism.highlightAll();
      
      typeof preloader === 'object' && preloader.endLoading();
  })
  document.addEventListener('pjax:error', (e) => {
      if (e.request.status === 404 || e.request.status === 500) {
          window.location.href = e.request.responseURL;
      }
  })</script><script data-pjax src=/production/js/main.js></script><script>let initTop = 0
  let isChatShow = true
  const innerHeight = window.innerHeight + 0
  window.addEventListener('scroll', btf.throttle(function (e) {
    const $rightside = document.getElementById('rightside')

    const $header = document.getElementById('page-header')
    const $cookies_window = document.getElementById('cookies-window')
    const isChatBtnHide = typeof chatBtnHide === 'function'
    const isChatBtnShow = typeof chatBtnShow === 'function'
  
    const currentTop = window.scrollY || document.documentElement.scrollTop
    // æ‰¾åˆ°æ»šåŠ¨æ–¹å‘ true is down & false is up
    const isDown = currentTop > initTop
    initTop = currentTop
    if (currentTop > 0) {
        if (isDown) {
            if ($header.classList.contains('nav-visible')) $header.classList.remove('nav-visible')
            if (isChatBtnShow && isChatShow === true) {
                chatBtnHide()
                isChatShow = false
            }
        } else {
            if (!$header.classList.contains('nav-visible')) $header.classList.add('nav-visible')
            if (isChatBtnHide && isChatShow === false) {
                chatBtnShow()
                isChatShow = true
            }
        }
        $header.classList.add('nav-fixed')
        if($cookies_window!=null && $cookies_window!=''){
            $cookies_window.classList.add('cw-hide')
        }
        if ($rightside && window.getComputedStyle($rightside).getPropertyValue('opacity') === '0') {
            $rightside.style.cssText = 'opacity: 0.8; transform: translateX(-58px)'
        }
    } else {
        if (currentTop === 0) {
            $header.classList.remove('nav-fixed', 'nav-visible')
        }
        $rightside.style.cssText = "opacity: ''; transform: ''"
    }
    if (document.body.scrollHeight <= innerHeight) {
        $rightside.style.cssText = 'opacity: 0.8; transform: translateX(-58px)'
    }
  }, 200))</script><script defer src=/libs/katex/katex.min.js></script><body><style>#loading-box{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#loading-box .loading-bg{background:var(--wjx-card-bg);z-index:1999;opacity:1;pointer-events:all;width:100%;height:100%;transition:all .2s;animation:.3s backwards showLoading;display:flex;position:fixed}#loading-box.loaded .loading-bg{pointer-events:none;transition:all .2s;animation:.3s forwards hideLoading}#loading-box .loading-img{width:100px;height:100px;margin:auto;animation-name:loadingAction;animation-duration:.2s;animation-iteration-count:infinite;animation-direction:alternate;overflow:hidden}#loading-box .loading-image-dot{background:#6bdf8f;border:6px solid #fff;border-radius:50%;width:30px;height:30px;position:absolute;top:50%;left:50%;-webkit-transform:translate(18px,24px);-moz-transform:translate(18px,24px);-ms-transform:translate(18px,24px);-o-transform:translate(18px,24px);transform:translate(18px,24px)}@keyframes loadingAction{0%{opacity:1}to{opacity:.6}}@keyframes hideLoading{0%{opacity:1}to{opacity:0}}@keyframes showLoading{0%{opacity:0}to{opacity:1}}</style><div id=loading-box onclick=wjx.hideLoading()><div class=loading-bg><picture class=loading-img style=border-radius:50%;width:100px;height:100px><source media="(min-width: 1em)" srcset=/processed_images/logo.21eeb8b123e2a315.avif><img alt=Loading decoding=async loading=lazy src=/processed_images/logo.caf14bfbf942dbfc.webp><noscript><img decoding=async loading=lazy src=/processed_images/logo.caf14bfbf942dbfc.webp></noscript></picture><div class=loading-image-dot></div></div></div><script>var preloader = {
            endLoading: () => {
                //- document.body.style.overflow = 'auto';
                document.getElementById('loading-box').classList.add("loaded")
            },
            initLoading: () => {
                //- document.body.style.overflow = '';
                document.getElementById('loading-box').classList.remove("loaded")
            }
        }
        window.addEventListener('load', preloader.endLoading())
        setTimeout(function () {
            preloader.endLoading();
        }, 3000)</script><div id=an_music_bg></div><div class=post data-type=post id=body-wrap><header class=post-bg id=page-header><nav class=show id=nav><div id=nav-group><div id=blog_name><div class=back-home-button tabindex=-1><i class="nav-icon back-home-button-icon icon-apps-fill" style=font-size:1rem></i><div class=back-menu-list-groups><div class=back-menu-list-group><div class=back-menu-list-title>ä½œå“</div><div class=back-menu-list><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a></div></div></div></div><a class="nav-item icon-home" data-pjax href=/ id=site-name title=è¿”å›åšå®¢ä¸»é¡µ> <span>ByeIOÂ·å¼€å‘è€…åšå®¢</span> </a></div><div id=page-name-mask><div id=page-name><a clase=nav-item id=page-name-text onclick=btf.scrollToDest(0,500)> æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰² </a></div></div><div id=menus><div class=menus_items><div class=menus_item><button class="site-page nav-item"><span>æ–‡åº“</span></button><div class=menus_item_child><div class=recursion_menus_item><a class="site-page child nav-item" href=/archives> <i class=icon-book-open style=font-size:.9em></i> <span>å…¨éƒ¨æ–‡ç« </span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/categories> <i class=icon-folder-open style=font-size:.9em></i> <span>åˆ†ç±»åˆ—è¡¨</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/tags> <i class=icon-tags style=font-size:.9em></i> <span>æ ‡ç­¾åˆ—è¡¨</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=javascript:toRandomPost()> <i class=icon-artstation style=font-size:.9em></i> <span>éšæœºæ–‡ç« </span> </a></div></div></div><div class=menus_item><a class="site-page nav-item" href=/tags/work> <span>æ¨è</span> </a><div class="menus_item_child vertical_nav"><div class=recursion_menus_item><a class="site-page child nav-item" href=/articles/docs/readme> <i class=icon-music style=font-size:.9em></i> <span>åšå®¢ä¸»é¢˜ä»‹ç»</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/articles/misc/lorem-ipsum> <i class=icon-music style=font-size:.9em></i> <span>Lorem Ipsum</span> </a></div></div></div><div class=menus_item><button class="site-page nav-item"><span>å‹é“¾</span></button><div class=menus_item_child><div class=recursion_menus_item><a class="site-page child nav-item" href=/friends> <i class=icon-link style=font-size:.9em></i> <span>å‹é“¾åˆ—è¡¨</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=javascript:travelling()> <i class=icon-paper-plane style=font-size:.9em></i> <span>éšæœºå‘ç°</span> </a></div></div></div><div class=menus_item><button class="site-page nav-item"><span>æˆ‘çš„</span></button><div class=menus_item_child><div class=recursion_menus_item><a class="site-page child nav-item" href=/about> <i class=icon-rocket style=font-size:.9em></i> <span>å…³äºæœ¬äºº</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/equipment> <i class=icon-artstation style=font-size:.9em></i> <span>æˆ‘çš„è£…å¤‡</span> </a></div><div class=recursion_menus_item><a class="site-page child nav-item" href=/tags/project> <i class=icon-lightbulb style=font-size:.9em></i> <span>æˆ‘çš„é¡¹ç›®</span> </a></div></div></div></div></div><div id=nav-right><div class=nav-button id=randomPost_button><button class="site-page nav-item" href=javascript:void(0); onclick=toRandomPost() title=éšæœºæ–‡ç« ><i class="nav-icon icon-dice"></i></button></div><div class=nav-button id=darkmode_button><button class="site-page console_switchbutton nav-item" title="åˆ‡æ¢æ¨¡å¼ - æ—¥å¤œäº¤æ›¿ï¼Œé»‘ç™½äº’æ¢ã€‚" href=javascript:void(0); onclick=navFn.switchDarkMode();><i class="nav-icon icon-moon-clear-fill" style=font-size:1rem></i></button></div><div class=nav-button id=nav-console><button class="site-page console_switchbutton nav-item" href=javascript:void(0); onclick=wjx.showConsole() title=æ˜¾ç¤ºä¸­æ§å°><i class="nav-icon icon-dashboard"></i></button></div><div class=nav-button id=nav-totop onclick=btf.scrollToDest(0,500)><button class="totopbtn nav-item"><i class="nav-icon icon-arrow-up" style=font-size:1rem></i><span id=percent>0</span></button></div><div id=toggle-menu><button class="site-page nav-item"><i class="nav-icon icon-bars"></i></button></div></div></div></nav><div class="coverdiv loaded" id=coverdiv><img alt=cover class=nolazyload decoding=async id=post-cover loading=lazy src=/processed_images/img00006.c4abedc898f992a6.webp></div><div id=post-info><div id=post-firstinfo><div class=meta-firstline><a class=post-meta-original href=/copyright title=è¯¥æ–‡ç« ä¸ºåŸåˆ›æ–‡ç« ï¼Œæ³¨æ„ç‰ˆæƒåè®®>åŸåˆ›</a><span class=post-meta-categories> <a href=/categories/theme/ title=ä¸»é¢˜> ä¸»é¢˜ </a> </span><div class=tag_share><div class=post-meta__tag-list><a class=post-meta__tags href=/tags/blog/ title=åšå®¢> <span class="tags-name tags-punctuation">åšå®¢</span> </a><a class=post-meta__tags href=/tags/docs/ title=æ–‡æ¡£> <span class="tags-name tags-punctuation">æ–‡æ¡£</span> </a><a class=post-meta__tags href=/tags/featured/ title=å¿…çœ‹> <span class="tags-name tags-punctuation">å¿…çœ‹</span> </a><a class=post-meta__tags href=/tags/hot/ title=çƒ­é—¨> <span class="tags-name tags-punctuation">çƒ­é—¨</span> </a></div></div></div></div><h1 class=post-title>æŠ˜è…¾ç¬”è®°[23]-ä½¿ç”¨rustè¿›è¡Œå›¾åƒåˆ†å‰²</h1><div id=post-meta><div class=meta-secondline><span class=post-meta-author data-flag-title=æ–‡ç« ä½œè€… title=æ–‡ç« ä½œè€…> <i class="icon-zuozhe post-meta-icon"></i>qsbye </span><span class=post-meta-wordcount> <i class="icon-file-word post-meta-icon" title=å­—æ•°></i> <span class=post-meta-label>å­—æ•°:</span> <span class=word-count>4485</span> <span class=post-meta-separator></span> <i class="icon-clock post-meta-icon" title=é˜…è¯»è€—æ—¶></i> <span class=post-meta-label>é˜…è¯»è€—æ—¶:</span> <span> 23 åˆ†é’Ÿ</span> </span><span class=post-meta-date> <i class="icon-calendar-days post-meta-icon"></i> <time title="2025-01-01 00:00:00" datetime=2025-01-01> 2025/01/01 </time> </span><span class=post-meta-wechat title=è¯¥æ–‡ç« åœ¨åšå®¢é¦–å‘> <i class="icon-rss post-meta-icon"></i>åšå®¢ç‹¬äº« </span><a class=post-meta-pv data-flag-title=çƒ­åº¦ title=çƒ­åº¦> <i class="icon-fire post-meta-icon"></i> <span class=post-meta-label>çƒ­åº¦:</span> <span id=twikoo_visitors> <i class="icon-spinner fa-spin"></i> </span> </a><a class=post-meta-commentcount data-flag-title=è¯„è®ºæ•° href=#post-comment title=è¯„è®ºæ•°> <i class="icon-chat--fill post-meta-icon" style=font-size:17px></i> <span class=post-meta-label>è¯„è®º:</span> <span id=twikoo-count> <i class="icon-spinner fa-spin"></i> </span> </a></div></div></div><section class="main-hero-waves-area waves-area"><svg viewbox="0 24 150 28" class=waves-svg preserveaspectratio=none shape-rendering=auto xlink=http://www.w3.org/1999/xlink xmlns=http://www.w3.org/2000/svg><defs><path d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z" id=gentle-wave></path></defs><g class=parallax><use href=#gentle-wave x=48 y=0></use><use href=#gentle-wave x=48 y=3></use><use href=#gentle-wave x=48 y=5></use><use href=#gentle-wave x=48 y=7></use></g></svg></section></header><main class="layout right-aside" id=content-inner><div id=post><div id=abstract-container><div class=abstract-title><i class=icon-bilibili></i><div class=abstract-title-text>æ–‡ç« æ‘˜è¦</div><div id=abstract-tag>æœ¬åœ°</div></div><div id=abstract-content style=display:block>ä½¿ç”¨rustå’Œortåº“(onnxruntimeåç«¯)æ¨ç†SAM2.1æ¨¡å‹å¹¶è·å–å›¾åƒåˆ†å‰²ç»“æœ.</div><div class=abstract-btn-box><div class=abstract-btn-item id=abstract-intro>ä»‹ç»è‡ªå·±</div><div class=abstract-btn-item id=abstract-generate>ç”Ÿæˆæœ¬æ–‡ç®€ä»‹</div><div class=abstract-btn-item id=abstract-recommend>æ¨èç›¸å…³æ–‡ç« </div><div class=abstract-btn-item id=abstract-home>å‰å¾€ä¸»é¡µ</div><div class=abstract-btn-item id=abstract-hide style=margin-left:auto>éšè—æœ¬æ‘˜è¦</div></div></div><div class="note simple warning" data-tip-enable=true data-update-date=2025-01-01 id=passage-tip></div><article class="post-content line-numbers" id=article-container><h2 id=zhai-yao>æ‘˜è¦</h2><p>ä½¿ç”¨rustå’Œortåº“(onnxruntimeåç«¯)æ¨ç†SAM2.1æ¨¡å‹å¹¶è·å–å›¾åƒåˆ†å‰²ç»“æœ.<h2 id=guan-jian-ci>å…³é”®è¯</h2><p>rust;onnx;SAM2;segment;predict;<h2 id=guan-jian-xin-xi>å…³é”®ä¿¡æ¯</h2><p>é¡¹ç›®åœ°å€:[https://github.com/ByeIO/bye.orbslam3.rs/blob/dev1/crates/seekslam_examples/examples/ort_segment.rs] é…ç½®æ–‡ä»¶:<pre class=language-toml data-lang=toml><code class=language-toml data-lang=toml>[workspace.package]
version = "0.0.1"
edition = "2024"
[workspace.dependencies]
# é”™è¯¯å¤„ç†
anyhow = "1.0.97"
# æ—¶é—´æ ¼å¼åŒ–
chrono = "0.4.40"
# Model Context Protocolåè®®å®šä¹‰
rust-mcp-schema = { version = "0.2.2", path = "./static/rust-mcp-schema" }
# Model Context Protocolå¼€å‘å·¥å…·
# rust-mcp-sdk = { version = "0.1.2", path = "./static/rust-mcp-sdk/crates/rust-mcp-sdk" }
rust-mcp-sdk = { version = "0.1.2" }
# å¤šçº¿ç¨‹æ¡†æ¶
tokio = { version = "1.44.1", features = ["full"] }
# ros2æ¥å£
ros2-interfaces-humble = "0.0.1"
# æ—¥å¿—åç«¯
log = { version = "0.4.27", features = ["std"] }
# prototxtæ–‡ä»¶è¯»å–
protokit = "0.2.0"
# protobufå¤„ç†
prost = "0.13.5"
prost-build = { version = "0.13.5", features = ["cleanup-markdown"] }
# onnxè¿è¡Œæ—¶
wonnx = { version = "0.5.1", path = "./static/wonnx/wonnx" }
# çº¿æ€§ä»£æ•°
nalgebra = { version = "0.33.2", features = ["rand"] }
ndarray = { version = "0.16.1", path = "./static/ndarray" }
# éšæœºæ•°
rand = "0.9.0"
rand_distr = "0.5.1"
# å›¾åƒå¤„ç†
image = "0.25.6"
imageproc = "0.25.0"
# å›¾ä¼˜åŒ–
factrs = "0.2.0"
# wasmè¿è¡Œæ—¶
wasmtime-cli = { version = "31.0.0", path="./static/wasmtime-cli-31.0.0" }
# tractè¿è¡Œæ—¶
tract-onnx = { version = "0.21.11", features = ["getrandom-js"], path = "./static/tract-onnx"}
# javascript/ESMè¿è¡Œæ—¶
deno_cli = { version = "2.2.8", path = "./static/deno" }
# ä¸´æ—¶æ–‡ä»¶
tempfile = "3.19.1"
# åµŒå…¥æ–‡ä»¶
embed-file = "0.2.0"
# onnxruntime(Cç»‘å®š), é»˜è®¤ç‰¹æ€§
ort = { version = "2.0.0-rc.9", path = "./static/ort" }
# YOLOv11
yolo-rs = "0.1.2"

[patch.crates-io]
# æ›¿æ¢ä¾èµ–æ–‡ä»¶
ndarray = { version = "0.16.1", path = "./static/ndarray" }
</code></pre><h2 id=yuan-li-jian-jie>åŸç†ç®€ä»‹</h2><h3 id=ortku-jian-jie>ortåº“ç®€ä»‹</h3><p>[https://github.com/pykeio/ort] [https://ort.pyke.io/] [https://github.com/pykeio/ort/discussions/categories/show-and-tell] <strong>ortæ—¢å¯ä»¥ä½¿ç”¨C++ç»‘å®šçš„onnxruntimeåç«¯(è‡ªåŠ¨ä¸‹è½½), ä¹Ÿå¯ä»¥ä½¿ç”¨çº¯rustçš„tractåç«¯</strong><p>è¿™äº›æ–‡æ¡£æ˜¯é’ˆå¯¹æœ€æ–° alpha ç‰ˆæœ¬çš„ ortï¼Œå³ 2.0.0-rc.9ã€‚æ­¤ç‰ˆæœ¬å·²å…·å¤‡ç”Ÿäº§ç¯å¢ƒçš„å¯ç”¨æ€§ï¼ˆåªæ˜¯ API å°šæœªç¨³å®šï¼‰ï¼Œæˆ‘ä»¬æ¨èæ–°æ—§é¡¹ç›®éƒ½ä½¿ç”¨è¯¥ç‰ˆæœ¬ã€‚<p>ort è®©æœºå™¨å­¦ä¹ æ¨¡å‹é€šè¿‡ ONNX Runtime éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå˜å¾—è½»æ¾ï¼ŒONNX Runtime æ˜¯ä¸€ç§ç¡¬ä»¶åŠ é€Ÿçš„æ¨ç†å¼•æ“ã€‚å€ŸåŠ© ort å’Œ ONNX Runtimeï¼Œä½ å‡ ä¹å¯ä»¥åœ¨ä»»ä½•ç¡¬ä»¶ä¸Šè¿è¡Œå‡ ä¹æ‰€æœ‰æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆåŒ…æ‹¬ ResNetã€YOLOv8ã€BERTã€LLaMA ç­‰ï¼‰ï¼Œé€šå¸¸æ¯” PyTorch æ›´å¿«ï¼Œå¹¶ä¸”é¢å¤–äº«æœ‰ Rust çš„é«˜æ•ˆæ€§ã€‚<p>ONNX æ˜¯ä¸€ç§å¯äº’æ“ä½œçš„ç¥ç»ç½‘ç»œè§„èŒƒã€‚ä½ æ‰€é€‰æ‹©çš„æœºå™¨å­¦ä¹ æ¡†æ¶â€”â€”PyTorchã€TensorFlowã€Kerasã€PaddlePaddle ç­‰â€”â€”ä¼šå°†ä½ çš„æ¨¡å‹è½¬åŒ–ä¸ºç”±åŸºæœ¬æ“ä½œï¼ˆå¦‚ MatMul æˆ– Addï¼‰ç»„æˆçš„ ONNX å›¾ã€‚ç„¶åï¼Œè¿™ä¸ªå›¾å¯ä»¥è¢«è½¬æ¢ä¸ºå¦ä¸€ä¸ªæ¡†æ¶ä¸­çš„æ¨¡å‹ï¼Œæˆ–è€…ç›´æ¥é€šè¿‡ ONNX Runtime è¿›è¡Œæ¨ç†ã€‚<p>å°†ç¥ç»ç½‘ç»œè½¬åŒ–ä¸ºç±»ä¼¼ ONNX çš„å›¾è¡¨ç¤ºï¼Œä¸ºæ›´å¤šä¼˜åŒ–å’Œæ›´å¹¿æ³›çš„åŠ é€Ÿç¡¬ä»¶æ”¯æŒæ‰“å¼€äº†å¤§é—¨ã€‚ONNX Runtime å¯ä»¥æ˜¾è‘—æé«˜å¤§å¤šæ•°æ¨¡å‹çš„æ¨ç†é€Ÿåº¦ / å»¶è¿Ÿï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡ NVIDIA CUDA & TensorRTã€Intel OpenVINOã€Qualcomm QNNã€åä¸º CANN ç­‰å®ç°åŠ é€Ÿã€‚<p>ort æ˜¯ Rust é€šå¾€ ONNX Runtime çš„æ¡¥æ¢ï¼Œè®©ä½ å¯ä»¥é€šè¿‡æ˜“äºä½¿ç”¨ä¸”ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„ API æ¨ç†ä½ çš„ ONNX æ¨¡å‹ã€‚è®¸å¤šå•†ä¸šã€å¼€æºå’Œç ”ç©¶é¡¹ç›®éƒ½åœ¨ä¸€äº›ç›¸å½“é‡è¦çš„ç”Ÿäº§åœºæ™¯ä¸­ä½¿ç”¨ ort æ¥æå‡æ¨ç†æ€§èƒ½ï¼š<ul><li><strong>Twitter</strong> åœ¨å…¶æ¨èç³»ç»Ÿçš„éƒ¨åˆ†ç¯èŠ‚ä½¿ç”¨ ortï¼Œæ¯å¤©å¤„ç†æ•°äº¿æ¬¡è¯·æ±‚ã€‚<li><strong>Bloop</strong> çš„è¯­ä¹‰ä»£ç æœç´¢åŠŸèƒ½ç”± ort æä¾›æ”¯æŒã€‚<li><strong>SurrealDB</strong> å¼ºå¤§çš„ SurrealQL æŸ¥è¯¢è¯­è¨€æ”¯æŒé€šè¿‡ ort è°ƒç”¨æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ŒåŒ…æ‹¬ ONNX å›¾ã€‚<li><strong>Google çš„ Magika</strong> æ–‡ä»¶ç±»å‹æ£€æµ‹åº“ç”± ort æä¾›æ”¯æŒã€‚<li><strong>Wasmtime</strong>ï¼Œä¸€ä¸ªå¼€æºçš„ WebAssembly è¿è¡Œæ—¶ï¼Œé€šè¿‡ ort æ”¯æŒ WASI-NN æ ‡å‡†çš„ ONNX æ¨ç†ã€‚<li><strong>rust-bert</strong> åœ¨ Rust ä¸­å®ç°äº†è®¸å¤šç°æˆå¯ç”¨çš„ NLP ç®¡é“ï¼Œç±»ä¼¼äº Hugging Face Transformersï¼ŒåŒæ—¶æ”¯æŒ tch å’Œ ort åç«¯ã€‚</ul><p>Fast ML inference & training for ONNX models in Rust These docs are for the latest alpha version of ort, 2.0.0-rc.9. This version is production-ready (just not API stable) and we recommend new & existing projects use it. ort makes it easy to deploy your machine learning models to production via ONNX Runtime, a hardware-accelerated inference engine. With ort + ONNX Runtime, you can run almost any ML model (including ResNet, YOLOv8, BERT, LLaMA) on almost any hardware, often far faster than PyTorch, and with the added bonus of Rustâ€™s efficiency.<p>ONNX is an interoperable neural network specification. Your ML framework of choice â€” PyTorch, TensorFlow, Keras, PaddlePaddle, etc. â€” turns your model into an ONNX graph comprised of basic operations like MatMul or Add. This graph can then be converted into a model in another framework, or inferenced directly with ONNX Runtime.<p>Converting a neural network to a graph representation like ONNX opens the door to more optimizations and broader acceleration hardware support. ONNX Runtime can significantly improve the inference speed/latency of most models and enable acceleration with NVIDIA CUDA & TensorRT, Intel OpenVINO, Qualcomm QNN, Huawei CANN, and much more.<p>ort is the Rust gateway to ONNX Runtime, allowing you to infer your ONNX models via an easy-to-use and ergonomic API. Many commercial, open-source, & research projects use ort in some pretty serious production scenarios to boost inference performance:<p>Twitter uses ort in part of their recommendations system, serving hundreds of millions of requests a day. Bloopâ€™s semantic code search feature is powered by ort. SurrealDBâ€™s powerful SurrealQL query language supports calling ML models, including ONNX graphs through ort. Googleâ€™s Magika file type detection library is powered by ort. Wasmtime, an open-source WebAssembly runtime, supports ONNX inference for the WASI-NN standard via ort. rust-bert implements many ready-to-use NLP pipelines in Rust Ã  la Hugging Face Transformers with both tch & ort backends.<h3 id=tu-xiang-fen-ge-gai-nian-jian-jie>å›¾åƒåˆ†å‰²æ¦‚å¿µç®€ä»‹</h3><h4 id=bian-ma-qi-encoder>ç¼–ç å™¨ï¼ˆEncoderï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šç¼–ç å™¨çš„ä½œç”¨æ˜¯å°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºä¸€ç»„ç‰¹å¾è¡¨ç¤ºï¼Œè¿™äº›ç‰¹å¾èƒ½å¤Ÿæ•æ‰å›¾åƒä¸­çš„è¯­ä¹‰ä¿¡æ¯ã€çº¹ç†ã€å½¢çŠ¶ç­‰å…³é”®ä¿¡æ¯ï¼Œä¸ºåç»­çš„åˆ†å‰²ä»»åŠ¡æä¾›åŸºç¡€çš„è§†è§‰ç‰¹å¾ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼šåœ¨ä»£ç ä¸­ï¼Œ<code>encoder_session</code> ç”¨äºåŠ è½½ç¼–ç å™¨æ¨¡å‹ï¼Œé€šè¿‡è°ƒç”¨ <code>self.encoder_session.run</code>ï¼Œå°†è¾“å…¥å›¾åƒ <code>image</code> ä¼ é€’ç»™ç¼–ç å™¨æ¨¡å‹ï¼Œå¾—åˆ°ç¼–ç å™¨çš„è¾“å‡ºç‰¹å¾ <code>high_res_feats_0</code>ã€<code>high_res_feats_1</code> å’Œ <code>image_embed</code>ã€‚</ul><h4 id=jie-ma-qi-decoder>è§£ç å™¨ï¼ˆDecoderï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šè§£ç å™¨çš„ä½œç”¨æ˜¯å°†ç¼–ç å™¨æå–çš„ç‰¹å¾è¿›ä¸€æ­¥å¤„ç†ï¼Œç»“åˆå…¶ä»–è¾“å…¥ï¼ˆå¦‚æç¤ºä¿¡æ¯ç­‰ï¼‰ï¼Œç”Ÿæˆæœ€ç»ˆçš„åˆ†å‰²æ©ç ï¼ˆmasksï¼‰ã€‚å®ƒéœ€è¦æ ¹æ®ç¼–ç å™¨æä¾›çš„ç‰¹å¾ï¼Œç†è§£å›¾åƒä¸­ä¸åŒåŒºåŸŸçš„è¯­ä¹‰ï¼Œå¹¶è¾“å‡ºæ¯ä¸ªåƒç´ æ‰€å±çš„ç±»åˆ«æˆ–å¯¹è±¡çš„æ©ç ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼š<code>decoder_session</code> ç”¨äºåŠ è½½è§£ç å™¨æ¨¡å‹ã€‚åœ¨ <code>predict</code> æ–¹æ³•ä¸­ï¼Œé€šè¿‡è°ƒç”¨ <code>self.decoder_session.run</code>ï¼Œå°†ç¼–ç å™¨çš„ç‰¹å¾ <code>features</code>ã€æç¤ºä¿¡æ¯ï¼ˆå¦‚ç‚¹åæ ‡ <code>point_coords</code>ã€ç‚¹æ ‡ç­¾ <code>point_labels</code>ã€è¾¹æ¡† <code>box</code> ç­‰ï¼‰ä»¥åŠä¸€äº›å…¶ä»–è¾…åŠ©ä¿¡æ¯ï¼ˆå¦‚ <code>mask_input</code>ã€<code>has_mask_input</code>ã€<code>orig_im_size</code> ç­‰ï¼‰ä¼ é€’ç»™è§£ç å™¨æ¨¡å‹ï¼Œå¾—åˆ°åˆ†å‰²æ©ç  <code>masks</code> å’Œ IoU é¢„æµ‹å€¼ <code>iou_pred</code>ã€‚</ul><h4 id=tu-xiang-yu-yi-fen-ge>å›¾åƒè¯­ä¹‰åˆ†å‰²</h4><p>ç›®æ ‡æ˜¯ç†è§£å›¾åƒå†…å®¹ï¼Œä¸ºæ¯ä¸ªåƒç´ åˆ†é…æ­£ç¡®çš„è¯­ä¹‰æ ‡ç­¾ï¼Œä½¿è®¡ç®—æœºèƒ½å¤Ÿâ€œè¯»æ‡‚â€å›¾åƒä¸­çš„ç‰©ä½“.<h4 id=fen-ge-yan-ma-masks>åˆ†å‰²æ©ç ï¼ˆMasksï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šåˆ†å‰²æ©ç æ˜¯å›¾åƒåˆ†å‰²ä»»åŠ¡çš„è¾“å‡ºï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸è¾“å…¥å›¾åƒå°ºå¯¸ç›¸åŒçš„äºŒç»´æˆ–ä¸‰ç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªåƒç´ çš„å€¼è¡¨ç¤ºè¯¥åƒç´ å±äºæŸä¸ªç‰¹å®šå¯¹è±¡æˆ–ç±»åˆ«çš„ç½®ä¿¡åº¦æˆ–æ ‡ç­¾ã€‚é€šè¿‡åˆ†å‰²æ©ç ï¼Œå¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°å›¾åƒä¸­ä¸åŒå¯¹è±¡çš„è¾¹ç•Œå’ŒåŒºåŸŸã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼šåœ¨ä»£ç ä¸­ï¼Œ<code>masks</code> æ˜¯è§£ç å™¨è¾“å‡ºçš„ä¸€ä¸ªé‡è¦ç»“æœã€‚å®ƒç»è¿‡ä¸€ç³»åˆ—çš„å¤„ç†ï¼ŒåŒ…æ‹¬è°ƒæ•´å¤§å°åˆ°åŸå§‹å›¾åƒå°ºå¯¸ç­‰æ“ä½œï¼Œæœ€ç»ˆç”¨äºç”Ÿæˆåˆ†å‰²ç»“æœçš„å¯è§†åŒ–å›¾åƒã€‚</ul><h4 id=dian-ti-shi-point-prompts>ç‚¹æç¤ºï¼ˆPoint Promptsï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šç‚¹æç¤ºæ˜¯ç”¨æˆ·åœ¨å›¾åƒä¸ŠæŒ‡å®šçš„æŸäº›ç‚¹ï¼Œè¿™äº›ç‚¹å¯ä»¥ç”¨æ¥å¼•å¯¼åˆ†å‰²æ¨¡å‹å…³æ³¨ç‰¹å®šçš„åŒºåŸŸæˆ–å¯¹è±¡ã€‚é€šè¿‡æä¾›ç‚¹æç¤ºï¼Œç”¨æˆ·å¯ä»¥å‘Šè¯‰æ¨¡å‹å“ªäº›åŒºåŸŸæ˜¯æ„Ÿå…´è¶£çš„ï¼Œä»è€Œå¸®åŠ©æ¨¡å‹æ›´å‡†ç¡®åœ°åˆ†å‰²å‡ºç›®æ ‡å¯¹è±¡ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼šä»£ç ä¸­çš„ <code>point_coords</code> å’Œ <code>point_labels</code> åˆ†åˆ«è¡¨ç¤ºç‚¹æç¤ºçš„åæ ‡å’Œå¯¹åº”çš„æ ‡ç­¾ã€‚åœ¨ <code>predict</code> æ–¹æ³•ä¸­ï¼Œä¼šæ ¹æ®è¿™äº›ç‚¹æç¤ºä¿¡æ¯æ¥è°ƒæ•´åˆ†å‰²çš„é€»è¾‘å’Œç»“æœã€‚</ul><h4 id=bian-kuang-ti-shi-box-prompts>è¾¹æ¡†æç¤ºï¼ˆBox Promptsï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šè¾¹æ¡†æç¤ºæ˜¯ç”¨æˆ·åœ¨å›¾åƒä¸ŠæŒ‡å®šçš„ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œç”¨äºæŒ‡ç¤ºæ¨¡å‹å…³æ³¨è¯¥åŒºåŸŸå†…çš„å¯¹è±¡ã€‚å®ƒå¯ä»¥å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°å®šä½å’Œåˆ†å‰²å‡ºè¾¹æ¡†å†…çš„ç›®æ ‡å¯¹è±¡ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼š<code>box</code> æ˜¯è¾¹æ¡†æç¤ºçš„è¾“å…¥ï¼Œåœ¨ä»£ç ä¸­ä¼šå¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œå¦‚è½¬æ¢åæ ‡ç­‰æ“ä½œï¼Œå¹¶å°†å…¶ä½œä¸ºè§£ç å™¨çš„è¾“å…¥ä¹‹ä¸€ï¼Œä»¥å½±å“åˆ†å‰²ç»“æœã€‚</ul><h4 id=iou-yu-ce-zhi-iou-predictions>IoU é¢„æµ‹å€¼ï¼ˆIoU Predictionsï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šIoUï¼ˆIntersection over Unionï¼‰é¢„æµ‹å€¼æ˜¯æ¨¡å‹å¯¹åˆ†å‰²ç»“æœè´¨é‡çš„ä¸€ç§è¯„ä¼°ã€‚å®ƒè¡¨ç¤ºé¢„æµ‹çš„åˆ†å‰²æ©ç ä¸çœŸå®æ ‡æ³¨ä¹‹é—´çš„é‡å ç¨‹åº¦ï¼Œé€šå¸¸ç”¨äºè¡¡é‡åˆ†å‰²çš„å‡†ç¡®æ€§ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒIoU é¢„æµ‹å€¼å¯ä»¥å¸®åŠ©ç”¨æˆ·äº†è§£æ¨¡å‹å¯¹åˆ†å‰²ç»“æœçš„ç½®ä¿¡åº¦ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼š<code>iou_pred</code> æ˜¯è§£ç å™¨è¾“å‡ºçš„ä¸€ä¸ªç»“æœï¼Œå®ƒä¸åˆ†å‰²æ©ç ä¸€èµ·è¿”å›ï¼Œä¸ºç”¨æˆ·æä¾›å…³äºåˆ†å‰²è´¨é‡çš„å‚è€ƒä¿¡æ¯ã€‚</ul><h4 id=di-fen-bian-lu-yan-ma-low-resolution-masks>ä½åˆ†è¾¨ç‡æ©ç ï¼ˆLow-Resolution Masksï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šä½åˆ†è¾¨ç‡æ©ç æ˜¯åœ¨è¾ƒä½åˆ†è¾¨ç‡ä¸‹ç”Ÿæˆçš„åˆ†å‰²æ©ç ï¼Œå®ƒé€šå¸¸ç”¨äºåç»­çš„å¤„ç†æˆ–ä½œä¸ºä¸­é—´ç»“æœã€‚ä½åˆ†è¾¨ç‡æ©ç å¯ä»¥å‡å°‘è®¡ç®—é‡å’Œå­˜å‚¨éœ€æ±‚ï¼ŒåŒæ—¶åœ¨ä¸€äº›æƒ…å†µä¸‹ä¹Ÿèƒ½æä¾›è¶³å¤Ÿçš„åˆ†å‰²ä¿¡æ¯ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼šåœ¨ä»£ç ä¸­ï¼Œ<code>low_res_masks</code> æ˜¯ä»è§£ç å™¨è¾“å‡ºçš„ <code>masks</code> ä¸­æå–å‡ºæ¥çš„ï¼Œå®ƒå¯èƒ½ç”¨äºä¸€äº›åç»­çš„å¤„ç†æ­¥éª¤ï¼Œå¦‚è¿›ä¸€æ­¥çš„ä¼˜åŒ–æˆ–åˆ†æã€‚</ul><h4 id=ti-shi-bian-ma-qi-prompt-encoder>æç¤ºç¼–ç å™¨ï¼ˆPrompt Encoderï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šæç¤ºç¼–ç å™¨çš„ä½œç”¨æ˜¯å°†ç”¨æˆ·æä¾›çš„æç¤ºä¿¡æ¯ï¼ˆå¦‚ç‚¹æç¤ºã€è¾¹æ¡†æç¤ºç­‰ï¼‰è¿›è¡Œç¼–ç ï¼Œè½¬æ¢ä¸ºæ¨¡å‹èƒ½å¤Ÿç†è§£å’Œå¤„ç†çš„æ ¼å¼ã€‚å®ƒå°†æç¤ºä¿¡æ¯ä¸å›¾åƒç‰¹å¾ç›¸ç»“åˆï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ ¹æ®æç¤ºæ¥è°ƒæ•´åˆ†å‰²çš„é€»è¾‘ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼šè™½ç„¶ä»£ç ä¸­æ²¡æœ‰ç›´æ¥å‡ºç°â€œæç¤ºç¼–ç å™¨â€çš„å…·ä½“å®ç°ï¼Œä½†ä»è§£ç å™¨çš„è¾“å…¥ä¸­å¯ä»¥çœ‹å‡ºï¼Œç‚¹æç¤ºå’Œè¾¹æ¡†æç¤ºç­‰ä¿¡æ¯è¢«ä¼ é€’ç»™è§£ç å™¨ï¼Œè¿™æš—ç¤ºäº†è§£ç å™¨å†…éƒ¨å¯èƒ½åŒ…å«äº†æç¤ºç¼–ç å™¨çš„åŠŸèƒ½ï¼Œå¯¹è¿™äº›æç¤ºä¿¡æ¯è¿›è¡Œäº†å¤„ç†ã€‚</ul><h4 id=ji-yi-ji-zhi-memory-mechanism>è®°å¿†æœºåˆ¶ï¼ˆMemory Mechanismï¼‰</h4><ul><li><strong>åŠŸèƒ½</strong>ï¼šè®°å¿†æœºåˆ¶ä¸»è¦ç”¨äºå¤„ç†è§†é¢‘åˆ†å‰²ä»»åŠ¡ä¸­çš„æ—¶é—´ä¾èµ–æ€§å’Œç‰©ä½“é®æŒ¡é—®é¢˜ã€‚å®ƒé€šè¿‡å­˜å‚¨è¿‡å»å¸§çš„ä¿¡æ¯ï¼Œå¸®åŠ©æ¨¡å‹åœ¨å½“å‰å¸§ä¸­æ›´å¥½åœ°ç†è§£ç‰©ä½“çš„è¿åŠ¨å’Œå˜åŒ–ï¼Œä»è€Œå®ç°å¯¹ç‰©ä½“çš„è¿ç»­è·Ÿè¸ªå’Œå‡†ç¡®åˆ†å‰²ã€‚<li><strong>ä»£ç ä½“ç°</strong>ï¼šè™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜ç¡®çš„â€œè®°å¿†æœºåˆ¶â€å®ç°ï¼Œä½†æ ¹æ® SAM2.1 æ¨¡å‹çš„æ¶æ„æè¿°ï¼Œè®°å¿†æœºåˆ¶æ˜¯å…¶æ ¸å¿ƒç»„æˆéƒ¨åˆ†ä¹‹ä¸€ï¼Œå®ƒåœ¨å¤„ç†è§†é¢‘åˆ†å‰²ä»»åŠ¡æ—¶èµ·ç€å…³é”®ä½œç”¨ã€‚</ul><h3 id=tu-xiang-fen-ge-yi-ban-shi-yong-bu-zou>å›¾åƒåˆ†å‰²ä¸€èˆ¬ä½¿ç”¨æ­¥éª¤</h3><ol><li>åŠ è½½æ¨¡å‹<li>è®¾ç½®å›¾åƒï¼šä½¿ç”¨é¢„æµ‹å™¨çš„ set_image() æ–¹æ³•è®¾ç½®å›¾åƒ<li>æä¾›æç¤ºï¼šæŒ‡å®šç‚¹ã€æ¡†æˆ–æ©ç ä½œä¸ºæç¤ºï¼ŒæŒ‡ç¤ºæ‚¨æƒ³è¦åˆ†å‰²çš„å¯¹è±¡<li>ç”Ÿæˆæ©ç ï¼šè°ƒç”¨é¢„æµ‹å™¨çš„ predict() æ–¹æ³•ç”Ÿæˆå›¾åƒçš„åˆ†å‰²æ©ç <li>ä½¿ç”¨æˆ–å¯è§†åŒ–ç»“æœï¼šæ¨¡å‹å°†è¿”å›åˆ†å‰²æ©ç ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨æˆ–å¯è§†åŒ–è¿™äº›æ©ç (å åŠ æ©ç åˆ°å›¾åƒ)</ol><h3 id=sam-segment-anything-2-1-jian-jie>SAM(Segment-Anything 2.1)ç®€ä»‹</h3><p>[https://ai-bot.cn/sam-2-1/] [https://ai.meta.com/blog/fair-news-segment-anything-2-1-meta-spirit-lm-layer-skip-salsa-sona/?utm_source=ai-bot.cn] [https://www.jiqizhixin.com/articles/2023-04-17-3] [https://arxiv.org/abs/2408.00714] [https://github.com/facebookresearch/sam2] Segment Anything Model 2ï¼ˆSAM 2ï¼‰æ˜¯ä¸€ä¸ªç”¨äºè§£å†³å›¾åƒå’Œè§†é¢‘ä¸­å¯æç¤ºè§†è§‰åˆ†å‰²çš„åŸºç¡€æ¨¡å‹ã€‚æˆ‘ä»¬å°†SAMæ‰©å±•åˆ°è§†é¢‘é¢†åŸŸï¼Œå³å°†å›¾åƒè§†ä¸ºåªæœ‰å•å¸§çš„è§†é¢‘ã€‚è¯¥æ¨¡å‹è®¾è®¡ä¸ºç®€å•çš„Transformeræ¶æ„ï¼Œå¹¶é…å¤‡æµå¼å†…å­˜ä»¥å®ç°å®æ—¶è§†é¢‘å¤„ç†ã€‚æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ¨¡å‹åœ¨ç¯ï¼ˆmodel-in-the-loopï¼‰çš„æ•°æ®å¼•æ“ï¼Œé€šè¿‡ç”¨æˆ·äº¤äº’æ¥æ”¹è¿›æ¨¡å‹å’Œæ•°æ®ï¼Œä»è€Œæ”¶é›†äº†æˆ‘ä»¬ç›®å‰æœ€å¤§çš„è§†é¢‘åˆ†å‰²æ•°æ®é›†â€”â€”SA-Væ•°æ®é›†ã€‚åœ¨æˆ‘ä»¬çš„æ•°æ®ä¸Šè®­ç»ƒçš„SAM 2åœ¨å„ç§ä»»åŠ¡å’Œè§†è§‰é¢†åŸŸä¸­éƒ½å±•ç°å‡ºäº†å¼ºå¤§çš„æ€§èƒ½ã€‚<p>Segment Anything Model 2 (SAM 2) is a foundation model towards solving promptable visual segmentation in images and videos. We extend SAM to video by considering images as a video with a single frame. The model design is a simple transformer architecture with streaming memory for real-time video processing. We build a model-in-the-loop data engine, which improves model and data via user interaction, to collect our SA-V dataset, the largest video segmentation dataset to date. SAM 2 trained on our data provides strong performance across a wide range of tasks and visual domains.<h3 id=ovseg-open-vocabulary-segmentation-jian-jie>OVSeg(open-vocabulary segmentation) ç®€ä»‹</h3><p>[https://github.com/facebookresearch/ov-seg] [https://huggingface.co/spaces/facebook/ov-seg] [https://jeff-liangf.github.io/projects/ovseg/] å¼€æ”¾è¯æ±‡è¯­ä¹‰åˆ†å‰²æ—¨åœ¨æ ¹æ®æ–‡æœ¬æè¿°å°†å›¾åƒåˆ†å‰²æˆè¯­ä¹‰åŒºåŸŸï¼Œè¿™äº›æ–‡æœ¬æè¿°å¯èƒ½åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¹¶æœªè§è¿‡ã€‚æœ€è¿‘çš„ä¸¤é˜¶æ®µæ–¹æ³•é¦–å…ˆç”Ÿæˆç±»åˆ«æ— å…³çš„æ©ç æè®®ï¼Œç„¶ååˆ©ç”¨é¢„è®­ç»ƒçš„è§†è§‰-è¯­è¨€æ¨¡å‹ï¼ˆä¾‹å¦‚CLIPï¼‰å¯¹æ©ç åŒºåŸŸè¿›è¡Œåˆ†ç±»ã€‚æˆ‘ä»¬å‘ç°è¿™ç§èŒƒå¼çš„æ€§èƒ½ç“¶é¢ˆåœ¨äºé¢„è®­ç»ƒçš„CLIPæ¨¡å‹ï¼Œå› ä¸ºå®ƒåœ¨æ©ç å›¾åƒä¸Šè¡¨ç°ä¸ä½³ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºå¯¹CLIPè¿›è¡Œå¾®è°ƒï¼Œä½¿ç”¨æ”¶é›†åˆ°çš„æ©ç å›¾åƒåŒºåŸŸåŠå…¶å¯¹åº”çš„æ–‡æœ¬æè¿°ã€‚æˆ‘ä»¬é€šè¿‡æŒ–æ˜ç°æœ‰çš„å›¾åƒ-æ ‡é¢˜æ•°æ®é›†ï¼ˆä¾‹å¦‚COCO Captionsï¼‰ï¼Œåˆ©ç”¨CLIPå°†æ©ç å›¾åƒåŒºåŸŸä¸å›¾åƒæ ‡é¢˜ä¸­çš„åè¯è¿›è¡ŒåŒ¹é…ï¼Œæ¥æ”¶é›†è®­ç»ƒæ•°æ®ã€‚ä¸æ›´ç²¾ç¡®ä¸”æ‰‹åŠ¨æ ‡æ³¨çš„å›ºå®šç±»åˆ«åˆ†å‰²æ ‡ç­¾ï¼ˆä¾‹å¦‚COCO-Stuffï¼‰ç›¸æ¯”ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬è¿™ç§å™ªå£°è¾ƒå¤šä½†å¤šæ ·åŒ–çš„æ•°æ®é›†èƒ½å¤Ÿæ›´å¥½åœ°ä¿ç•™CLIPçš„æ³›åŒ–èƒ½åŠ›ã€‚é™¤äº†å¯¹æ•´ä¸ªæ¨¡å‹è¿›è¡Œå¾®è°ƒå¤–ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨æ©ç å›¾åƒä¸­çš„â€œç©ºç™½â€åŒºåŸŸï¼Œé‡‡ç”¨æˆ‘ä»¬ç§°ä¹‹ä¸ºæ©ç æç¤ºè°ƒæ•´çš„æ–¹æ³•ã€‚å®éªŒè¡¨æ˜ï¼Œæ©ç æç¤ºè°ƒæ•´åœ¨ä¸ä¿®æ”¹CLIPä»»ä½•æƒé‡çš„æƒ…å†µä¸‹å¸¦æ¥äº†æ˜¾è‘—çš„æ”¹è¿›ï¼Œå¹¶ä¸”å¯ä»¥è¿›ä¸€æ­¥æ”¹è¿›ä¸€ä¸ªå®Œå…¨å¾®è°ƒçš„æ¨¡å‹ã€‚ç‰¹åˆ«æ˜¯ï¼Œåœ¨COCOä¸Šè®­ç»ƒå¹¶åœ¨ADE20K-150ä¸Šè¯„ä¼°æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½çš„æ¨¡å‹è¾¾åˆ°äº†29.6%çš„mIoUï¼Œæ¯”ä¹‹å‰çš„æœ€ä½³æ°´å¹³é«˜å‡º8.5%ã€‚è¿™æ˜¯é¦–æ¬¡å¼€æ”¾è¯æ±‡é€šç”¨æ¨¡å‹åœ¨æ²¡æœ‰é’ˆå¯¹ç‰¹å®šæ•°æ®é›†è¿›è¡Œè°ƒæ•´çš„æƒ…å†µä¸‹ï¼Œä¸2017å¹´çš„ç›‘ç£ä¸“å®¶æ¨¡å‹æ€§èƒ½ç›¸åŒ¹é…ã€‚<p>Open-Vocabulary Semantic Segmentation with Mask-adapted CLIP<p>Open-vocabulary semantic segmentation aims to segment an image into semantic regions according to text descriptions, which may not have been seen during training. Recent two-stage methods first generate class-agnostic mask proposals and then leverage pre-trained vision-language models, e.g., CLIP, to classify masked regions. We identify the performance bottleneck of this paradigm to be the pre-trained CLIP model, since it does not perform well on masked images. To address this, we propose to finetune CLIP on a collection of masked image regions and their corresponding text descriptions. We collect training data by mining an existing image-caption dataset (e.g., COCO Captions), using CLIP to match masked image regions to nouns in the image captions. Compared with the more precise and manually annotated segmentation labels with fixed classes (e.g., COCO-Stuff), we find our noisy but diverse dataset can better retain CLIP's generalization ability. Along with finetuning the entire model, we utilize the "blank" areas in masked images using a method we dub mask prompt tuning. Experiments demonstrate mask prompt tuning brings significant improvement without modifying any weights of CLIP, and it can further improve a fully finetuned model. In particular, when trained on COCO and evaluated on ADE20K-150, our best model achieves 29.6% mIoU, which is +8.5% higher than the previous state-of-the-art. For the first time, open-vocabulary generalist models match the performance of supervised specialist models in 2017 without dataset specific adaptations.<h3 id=shi-yong-sam2-1jin-xing-tu-xiang-fen-ge-de-shu-xue-yuan-li>ä½¿ç”¨SAM2.1è¿›è¡Œå›¾åƒåˆ†å‰²çš„æ•°å­¦åŸç†</h3><p>[https://arxiv.org/abs/2408.00714] [https://docs.ultralytics.com/zh/models/sam-2/] SAM2æ˜¯ä¸€ä¸ªåŸºäºTransformerçš„ç»Ÿä¸€æ¨¡å‹ï¼Œç”¨äºå›¾åƒå’Œè§†é¢‘åˆ†å‰²ä»»åŠ¡ã€‚å…¶æ ¸å¿ƒæ•°å­¦åŸç†å¯ä»¥åˆ†è§£ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†<ul><li>æ–¹æ³•ç»†èŠ‚ <ul><li>å›¾åƒç¼–ç å™¨ï¼šä½¿ç”¨MAEé¢„è®­ç»ƒçš„Hieraå›¾åƒç¼–ç å™¨ï¼Œæä¾›æ¯å¸§çš„ç‰¹å¾åµŒå…¥ã€‚<li>è®°å¿†æ³¨æ„åŠ›ï¼šé€šè¿‡å †å Lä¸ªTransformerå—ï¼Œå°†å½“å‰å¸§çš„ç‰¹å¾ä¸è¿‡å»çš„è®°å¿†ç‰¹å¾è¿›è¡Œäº¤å‰æ³¨æ„åŠ›æ“ä½œã€‚<li>æç¤ºç¼–ç å™¨å’Œæ©ç è§£ç å™¨ï¼šä¸SAMç›¸åŒï¼Œèƒ½å¤Ÿå¤„ç†ç‚¹ã€æ¡†æˆ–æ©ç ä½œä¸ºæç¤ºã€‚<li>è®°å¿†ç¼–ç å™¨ï¼šé€šè¿‡å·ç§¯æ¨¡å—ä¸‹é‡‡æ ·é¢„æµ‹æ©ç ï¼Œå¹¶å°†å…¶ä¸æœªæ¡ä»¶åŒ–çš„å¸§åµŒå…¥ç›¸ç»“åˆï¼Œç”Ÿæˆè®°å¿†ã€‚<li>è®°å¿†åº“ï¼šä¿ç•™è¿‡å»é¢„æµ‹çš„å†…å­˜ï¼Œç”¨äºåç»­å¸§çš„ä½¿ç”¨ã€‚</ul></ul><table><thead><tr><th>æ–¹æ³•æ¦‚æ‹¬<tbody><tr><td><img alt decoding=async loading=lazy src=https://img2024.cnblogs.com/blog/1048201/202504/1048201-20250412134155587-1301872683.png></table><h4><strong>1. æ ¸å¿ƒä»»åŠ¡</strong></h4><p>SAM2çš„ç›®æ ‡æ˜¯<strong>å¯æç¤ºè§†è§‰åˆ†å‰²ï¼ˆPromptable Visual Segmentation, PVSï¼‰</strong>ï¼Œå…¶æ•°å­¦å½¢å¼å¯è¡¨ç¤ºä¸ºï¼š $$ \mathcal{M} = f_{\theta}(I, P, M_{\text{mem}}) $$ å…¶ä¸­ï¼š<ul><li>$I$ï¼šè¾“å…¥å›¾åƒæˆ–è§†é¢‘å¸§ã€‚<li>$P$ï¼šç”¨æˆ·æç¤ºï¼ˆç‚¹å‡»ã€æ¡†ã€æ©ç ï¼‰ã€‚<li>$M_{\text{mem}}$ï¼šè®°å¿†æ¨¡å—å­˜å‚¨çš„å†å²ä¿¡æ¯ã€‚<li>$\mathcal{M}$ï¼šè¾“å‡ºçš„åˆ†å‰²æ©ç ã€‚</ul><h4 id=-1><strong>2. å…³é”®æ¨¡å—ä¸æ•°å­¦åŸç†</strong></h4><h5 id=-2><strong>2.1 å›¾åƒç¼–ç å™¨ï¼ˆImage Encoderï¼‰</strong></h5><ul><li>åŸºäºåˆ†å±‚Transformerï¼ˆHieraæ¶æ„ï¼‰ï¼Œæå–å¤šå°ºåº¦ç‰¹å¾ï¼š <ul><li>è¾“å…¥å¸§$I$é€šè¿‡ç¼–ç å™¨ç”Ÿæˆç‰¹å¾é‡‘å­—å¡”${F_s}_{s=4,8,16,32}$ï¼ˆ$s$ä¸ºæ­¥é•¿ï¼‰ã€‚<li>é«˜å±‚ç‰¹å¾ï¼ˆ$s=16,32$ï¼‰ç”¨äºè®°å¿†æ¨¡å—ï¼Œä½å±‚ç‰¹å¾ï¼ˆ$s=4,8$ï¼‰é€šè¿‡è·³è·ƒè¿æ¥æ³¨å…¥æ©ç è§£ç å™¨ï¼Œä¿ç•™ç»†èŠ‚ã€‚</ul></ul><h5 id=-3><strong>2.2 è®°å¿†æ¨¡å—ï¼ˆMemory Bankï¼‰</strong></h5><ul><li><strong>è®°å¿†æ›´æ–°</strong>ï¼šå¯¹ç¬¬$t$å¸§ï¼Œè®°å¿†ç¼–ç å™¨ç”Ÿæˆè®°å¿†å‘é‡$m_t$ï¼š $$ m_t = \text{Conv}(F_t^{16} \oplus \text{Downsample}(\mathcal{M}_t)) $$ å…¶ä¸­$\oplus$è¡¨ç¤ºé€å…ƒç´ ç›¸åŠ ï¼Œ$\text{Downsample}$ä¸ºç©ºé—´ä¸‹é‡‡æ ·ã€‚<li><strong>è®°å¿†å­˜å‚¨</strong>ï¼šç»´æŠ¤ä¸¤ä¸ªFIFOé˜Ÿåˆ—ï¼š <ul><li><strong>ç©ºé—´è®°å¿†</strong>ï¼šå­˜å‚¨æœ€è¿‘$N$å¸§çš„$m_t$ã€‚<li><strong>å¯¹è±¡æŒ‡é’ˆ</strong>ï¼šè½»é‡çº§å‘é‡ï¼Œè®°å½•è¯­ä¹‰ä¿¡æ¯ã€‚</ul></ul><h5 id=-4><strong>2.3 è®°å¿†æ³¨æ„åŠ›ï¼ˆMemory Attentionï¼‰</strong></h5><ul><li>å½“å‰å¸§ç‰¹å¾$F_t$ä¸è®°å¿†æ¨¡å—äº¤äº’ï¼š $$ \tilde{F}<em>t = \text{CrossAttn}(F_t, {m</em>{t-k}}_{k=1}^N) + \text{SelfAttn}(F_t) $$ <ul><li>ä½¿ç”¨2D-RoPEç›¸å¯¹ä½ç½®ç¼–ç ï¼Œå¢å¼ºæ—¶ç©ºä¸€è‡´æ€§ã€‚<li>è·¨æ³¨æ„åŠ›æœºåˆ¶èšåˆå†å²ä¿¡æ¯ï¼Œæ— éœ€GRUç­‰é€’å½’ç»“æ„ã€‚</ul></ul><h5 id=-5><strong>2.4 æ©ç è§£ç å™¨ï¼ˆMask Decoderï¼‰</strong></h5><ul><li>ç±»ä¼¼SAMçš„ä¸¤è·¯Transformerç»“æ„ï¼Œè¾“å…¥ä¸ºï¼š <ul><li>æç¤ºåµŒå…¥$P$ï¼ˆé€šè¿‡ä½ç½®ç¼–ç +ç±»å‹åµŒå…¥ï¼‰ã€‚<li>è®°å¿†å¢å¼ºçš„ç‰¹å¾$\tilde{F}_t$ã€‚</ul><li>è¾“å‡ºå¤šå°ºåº¦æ©ç ï¼š $$ \mathcal{M}_t = \text{MLP}(\text{Upsample}(\tilde{F}_t \oplus F_t^{4,8})) $$ å…¶ä¸­ä½å±‚ç‰¹å¾$F_t^{4,8}$é€šè¿‡è·³è·ƒè¿æ¥è¡¥å……ç»†èŠ‚ã€‚</ul><h5 id=-6><strong>3. è®­ç»ƒç­–ç•¥</strong></h5><ul><li><strong>æ•°æ®æ··åˆ</strong>ï¼šè”åˆè®­ç»ƒå›¾åƒï¼ˆSA-1Bï¼‰å’Œè§†é¢‘ï¼ˆSA-Vï¼‰æ•°æ®ï¼ŒæŸå¤±å‡½æ•°ä¸ºæ©ç IoUå’Œäº¤å‰ç†µï¼š $$ \mathcal{L} = \lambda_1 \mathcal{L}<em>{\text{IoU}} + \lambda_2 \mathcal{L}</em>{\text{CE}} $$<li><strong>äº¤äº’æ¨¡æ‹Ÿ</strong>ï¼šåœ¨è®­ç»ƒæ—¶éšæœºé‡‡æ ·æç¤ºï¼ˆç‚¹å‡»/æ¡†/æ©ç ï¼‰ï¼Œæ¨¡æ‹Ÿç”¨æˆ·äº¤äº’ã€‚</ul><h5 id=-7><strong>4. å…³é”®åˆ›æ–°</strong></h5><ol><li><strong>ç»Ÿä¸€å»ºæ¨¡</strong>ï¼šé€šè¿‡è®°å¿†æ¨¡å—å°†å›¾åƒåˆ†å‰²ï¼ˆSAMï¼‰æ¨å¹¿åˆ°è§†é¢‘ï¼Œé™æ€åœºæ™¯ä¸‹è®°å¿†ä¸ºç©ºï¼Œé€€åŒ–ä¸ºSAMã€‚<li><strong>é«˜æ•ˆæ³¨æ„åŠ›</strong>ï¼šç§»é™¤ç›¸å¯¹ä½ç½®åç½®ï¼ˆRPBï¼‰ï¼Œé‡‡ç”¨FlashAttention-2åŠ é€Ÿè®¡ç®—ã€‚<li><strong>æ•°æ®å¼•æ“</strong>ï¼šé€šè¿‡æ¨¡å‹-äººå·¥ååŒæ ‡æ³¨ï¼ˆPhase 1â†’3ï¼‰ï¼Œç”Ÿæˆå¤§è§„æ¨¡æ•°æ®é›†SA-Vï¼ˆ35.5Mæ©ç ï¼‰ã€‚</ol><h5 id=-8><strong>5. æ•°å­¦ä¼˜åŠ¿</strong></h5><ul><li><strong>å®æ—¶æ€§</strong>ï¼šæµå¼å¤„ç†ï¼ˆé€å¸§ç¼–ç +è®°å¿†ç¼“å­˜ï¼‰ï¼Œé€Ÿåº¦è¾¾43.8 FPSï¼ˆA100ï¼‰ã€‚<li><strong>æ³›åŒ–æ€§</strong>ï¼šé€šè¿‡é›¶æ ·æœ¬ä»»åŠ¡éªŒè¯ï¼Œåœ¨17ä¸ªè§†é¢‘å’Œ37ä¸ªå›¾åƒæ•°æ®é›†ä¸Šè¶…è¶ŠSAMï¼ˆ6å€åŠ é€Ÿï¼‰ã€‚</ul><hr><h2 id=-9>å®ç°</h2><ol><li><p>æ¨¡å‹ä¸‹è½½ [https://huggingface.co/IRPC/frogforge-sam2.1-onnx/tree/main] [https://huggingface.co/IRPC/frogforge-sam2.1-onnx/resolve/main/onnx/fp32/sam2.1_base_plus.encoder.onnx] [https://huggingface.co/IRPC/frogforge-sam2.1-onnx/resolve/main/onnx/fp32/sam2.1_base_plus.decoder.onnx]</p> <ul><li>ä½¿ç”¨netronè½¯ä»¶æŸ¥çœ‹onnxæ¨¡å‹çš„è¾“å…¥å’Œè¾“å‡º</ul> <table><thead><tr><th>ç¼–ç å™¨<th>è§£ç å™¨<tbody><tr><td><img alt decoding=async loading=lazy src=https://img2024.cnblogs.com/blog/1048201/202504/1048201-20250412134215613-1957943041.png><td><img alt decoding=async loading=lazy src=https://img2024.cnblogs.com/blog/1048201/202504/1048201-20250412134222047-853254232.png></table><li><p>Pythonç‰ˆæœ¬ä»£ç </p></ol><pre class=language-py data-lang=py><code class=language-py data-lang=py># æµ‹è¯•SAM2.1å›¾ç‰‡åˆ†å‰²

# ç¼–ç æ¨¡å‹: ../../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.encoder.onnx
## è¾“å‡º: 
## high_res_feats_0
## name: high_res_feats_0
## tensor: float32[Reshapehigh_res_feats_0_dim_0,Reshapehigh_res_feats_0_dim_1,Reshapehigh_res_feats_0_dim_2,Reshapehigh_res_feats_0_dim_3]
## high_res_feats_1
## name: high_res_feats_1
## tensor: float32[Reshapehigh_res_feats_1_dim_0,Reshapehigh_res_feats_1_dim_1,Reshapehigh_res_feats_1_dim_2,Reshapehigh_res_feats_1_dim_3]
## image_embed
## name: image_embed
## tensor: float32[Reshapeimage_embed_dim_0,Reshapeimage_embed_dim_1,Reshapeimage_embed_dim_2,Reshapeimage_embed_dim_3]

# è§£ç æ¨¡å‹: ../../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.decoder.onnx
## è¾“å‡º:
## masks
## name: masks
## tensor: float32[Resizemasks_dim_0,Resizemasks_dim_1,Resizemasks_dim_2,Resizemasks_dim_3]
## iou_predictions
## name: iou_predictions
## tensor: float32[Resizemasks_dim_0,Whereiou_predictions_dim_1]

# è¾“å…¥å›¾ç‰‡../assets/rgb1.png
# è¾“å‡º../result/segment_onnx.png

import os
import cv2
import numpy as np
import onnxruntime as ort

class SAM2ImagePredictor:
    def __init__(self, encoder_model_path, decoder_model_path):
        """
        åˆå§‹åŒ– SAM2 å›¾åƒåˆ†å‰²é¢„æµ‹å™¨
        :param encoder_model_path: ç¼–ç å™¨æ¨¡å‹è·¯å¾„
        :param decoder_model_path: è§£ç å™¨æ¨¡å‹è·¯å¾„
        """
        self.encoder_session = ort.InferenceSession(encoder_model_path)
        self.decoder_session = ort.InferenceSession(decoder_model_path)

    def trunc_normal(self, size, std=0.02, a=-2, b=2):
        """
        ç”Ÿæˆæˆªæ–­æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°
        :param size: è¾“å‡ºæ•°ç»„çš„å½¢çŠ¶
        :param std: æ ‡å‡†å·®
        :param a: æˆªæ–­ä¸‹é™
        :param b: æˆªæ–­ä¸Šé™
        :return: æˆªæ–­æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°æ•°ç»„
        """
        values = np.random.normal(loc=0., scale=std, size=size)
        values = np.clip(values, a * std, b * std)
        return values

    def set_image(self, image):
        """
        è®¾ç½®è¾“å…¥å›¾åƒå¹¶è·å–ç¼–ç å™¨çš„ç‰¹å¾
        :param image: è¾“å…¥å›¾åƒ
        :return: ç¼–ç å™¨çš„ç‰¹å¾
        """
        # è°ƒæ•´å›¾åƒå¤§å°ä¸ºæ¨¡å‹æœŸæœ›çš„å°ºå¯¸
        image = cv2.resize(image, (1024, 1024))
        # è°ƒæ•´é€šé“é¡ºåºä¸ºæ¨¡å‹æœŸæœ›çš„é¡ºåºï¼ˆCHWï¼‰
        image = np.transpose(image, (2, 0, 1))
        # æ·»åŠ æ‰¹é‡ç»´åº¦
        image = np.expand_dims(image, axis=0).astype(np.float32)
        outputs = self.encoder_session.run(None, {"image": image})
        high_res_feats_0, high_res_feats_1, image_embed = outputs
        features = {
            "high_res_feats_0": high_res_feats_0,
            "high_res_feats_1": high_res_feats_1,
            "image_embed": image_embed
        }
        return features

    def predict(self, features, orig_hw, point_coords=None, point_labels=None, box=None, mask_input=None):
        """
        è¿›è¡Œå›¾åƒåˆ†å‰²é¢„æµ‹
        :param features: ç¼–ç å™¨çš„ç‰¹å¾
        :param orig_hw: åŸå§‹å›¾åƒçš„é«˜å’Œå®½
        :param point_coords: ç‚¹æç¤ºçš„åæ ‡
        :param point_labels: ç‚¹æç¤ºçš„æ ‡ç­¾
        :param box: è¾¹æ¡†æç¤º
        :param mask_input: æ©ç è¾“å…¥
        :return: åˆ†å‰²æ©ç ã€IoU é¢„æµ‹å€¼å’Œä½åˆ†è¾¨ç‡æ©ç 
        """
        if point_coords is not None and len(point_coords) != 0:
            point_coords = point_coords.astype(np.float32)
            unnorm_coords = self.transform_coords(point_coords, orig_hw)
            labels = point_labels.astype(np.float32)
            if len(unnorm_coords.shape) == 2:
                unnorm_coords, labels = unnorm_coords[None, ...], labels[None, ...]
        else:
            unnorm_coords, labels = None, None

        if box is not None:
            box = box.astype(np.float32)
            unnorm_box = self.transform_boxes(box, orig_hw)
        else:
            unnorm_box = None

        if mask_input is not None:
            mask_input = mask_input.astype(np.float32)
            if len(mask_input.shape) == 3:
                mask_input = mask_input[None, :, :, :]
        else:
            # ç¡®ä¿ mask_input çš„ç»´åº¦ä¸º 4
            mask_input = np.zeros((1, 1, 256, 256), dtype=np.float32)

        # å¦‚æœæ²¡æœ‰ç‚¹æç¤ºå’Œè¾¹æ¡†æç¤ºï¼Œåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ç‚¹æç¤º
        if unnorm_coords is None and unnorm_box is None:
            unnorm_coords = np.array([[[0.5, 0.5]]], dtype=np.float32)  # é»˜è®¤ç‚¹æç¤ºåœ¨å›¾åƒä¸­å¿ƒ
            labels = np.array([[1]], dtype=np.float32)  # é»˜è®¤æ ‡ç­¾ä¸º1ï¼Œä¿®æ”¹ä¸º float32

        if unnorm_coords is not None:
            concat_points = (unnorm_coords, labels)
        else:
            concat_points = None

        if unnorm_box is not None:
            box_coords = unnorm_box.reshape(-1, 2, 2)
            box_labels = np.array([[2, 3]], dtype=np.float32)  # ä¿®æ”¹ä¸º float32
            box_labels = box_labels.repeat(unnorm_box.shape[0], 1)
            if concat_points is not None:
                concat_coords = np.concatenate([box_coords, concat_points[0]], axis=1)
                concat_labels = np.concatenate([box_labels, concat_points[1]], axis=1)
                concat_points = (concat_coords, concat_labels.astype(np.int32))
            else:
                concat_points = (box_coords, box_labels.astype(np.int32))

        if mask_input is None:
            mask_input_dummy = np.zeros((1, 256, 256), dtype=np.float32)
            masks_enable = np.array([0], dtype=np.float32)
        else:
            mask_input_dummy = mask_input
            masks_enable = np.array([1], dtype=np.float32)

        if concat_points is None:
            raise ValueError("concat_points must be exists")

        orig_im_size = np.array(orig_hw, dtype=np.int32)

        sparse_embeddings, dense_embeddings = self.decoder_session.run(
            None,
            {
                "point_coords": concat_points[0],  # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
                "point_labels": concat_points[1],  # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
                "mask_input": mask_input_dummy,   # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
                "has_mask_input": masks_enable,   # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
                "orig_im_size": orig_im_size,     # æ·»åŠ æ¨¡å‹æœŸæœ›çš„è¾“å…¥ i32
                "image_embed": features["image_embed"],  # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
                "high_res_feats_0": features["high_res_feats_0"],  # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
                "high_res_feats_1": features["high_res_feats_1"]   # ä¿®æ”¹ä¸ºæ¨¡å‹æœŸæœ›çš„è¾“å…¥åç§° f32
            }
        )

        masks, iou_pred = sparse_embeddings, dense_embeddings

        low_res_masks = masks[:, 1:, :, :]
        iou_predictions = iou_pred[:, 1:]

        masks = self.postprocess_masks(masks, orig_hw)

        return masks, iou_predictions, low_res_masks

    def transform_coords(self, coords, orig_hw):
        """
        è½¬æ¢åæ ‡
        :param coords: åæ ‡
        :param orig_hw: åŸå§‹å›¾åƒçš„é«˜å’Œå®½
        :return: è½¬æ¢åçš„åæ ‡
        """
        h, w = orig_hw
        coords = coords.copy()
        coords[..., 0] = coords[..., 0] / w
        coords[..., 1] = coords[..., 1] / h

        resolution = 1024
        coords = coords * resolution
        return coords

    def transform_boxes(self, boxes, orig_hw):
        """
        è½¬æ¢è¾¹æ¡†
        :param boxes: è¾¹æ¡†
        :param orig_hw: åŸå§‹å›¾åƒçš„é«˜å’Œå®½
        :return: è½¬æ¢åçš„è¾¹æ¡†
        """
        boxes = self.transform_coords(boxes.reshape(-1, 2, 2), orig_hw)
        return boxes

    def postprocess_masks(self, masks, orig_hw):
        interpolated_masks = []
        for mask in masks:
            # æ‰“å° mask çš„å½¢çŠ¶ï¼Œä¾¿äºè°ƒè¯•
            print("Original mask shape:", mask.shape)

            # ç¡®ä¿ mask çš„å½¢çŠ¶ä¸º (num_masks, height, width)
            if len(mask.shape) == 4:  # å¦‚æœæœ‰ batch ç»´åº¦ï¼Œå»æ‰ batch ç»´åº¦
                mask = np.squeeze(mask, axis=0)
            if len(mask.shape) == 3:  # å¦‚æœå·²ç»æ˜¯ (num_masks, height, width)ï¼Œç›´æ¥ä½¿ç”¨
                pass
            else:
                raise ValueError(f"Unexpected mask shape: {mask.shape}")

            # è½¬æ¢ä¸º (height, width, num_masks)
            mask = np.transpose(mask, (1, 2, 0))

            # è°ƒæ•´å¤§å°åˆ°åŸå§‹å›¾åƒå°ºå¯¸
            resized_mask = cv2.resize(mask, (orig_hw[1], orig_hw[0]), interpolation=cv2.INTER_LINEAR)

            # æ‰“å° resized_mask çš„å½¢çŠ¶ï¼Œä¾¿äºè°ƒè¯•
            print("Resized mask shape:", resized_mask.shape)

            # å¦‚æœ resized_mask æ˜¯äºŒç»´çš„ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„ç»´åº¦
            if len(resized_mask.shape) == 2:
                resized_mask = resized_mask[:, :, np.newaxis]

            # è½¬æ¢å› (num_masks, height, width)
            resized_mask = np.transpose(resized_mask, (2, 0, 1))

            interpolated_masks.append(resized_mask)

        interpolated_masks = np.array(interpolated_masks)

        return interpolated_masks

if __name__ == "__main__":
    # è¾“å…¥å›¾ç‰‡è·¯å¾„
    input_image_path = "../assets/rgb1.png"
    # è¾“å‡ºå›¾ç‰‡è·¯å¾„
    output_image_path = "../result/segment_onnx.png"
    # ç¼–ç å™¨æ¨¡å‹è·¯å¾„
    encoder_model_path = "../../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.encoder.onnx"
    # è§£ç å™¨æ¨¡å‹è·¯å¾„
    decoder_model_path = "../../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.decoder.onnx"

    # è¯»å–è¾“å…¥å›¾ç‰‡
    image = cv2.imread(input_image_path)
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
    orig_hw = image.shape[:2]

    # åˆå§‹åŒ– SAM2 å›¾åƒåˆ†å‰²é¢„æµ‹å™¨
    predictor = SAM2ImagePredictor(encoder_model_path, decoder_model_path)

    # è®¾ç½®è¾“å…¥å›¾åƒå¹¶è·å–ç¼–ç å™¨çš„ç‰¹å¾
    features = predictor.set_image(image)

    # è¿›è¡Œå›¾åƒåˆ†å‰²é¢„æµ‹
    masks, iou_predictions, low_res_masks = predictor.predict(features, orig_hw)

    # å°†åˆ†å‰²æ©ç è½¬æ¢ä¸ºå¯è§†åŒ–å›¾åƒ
    mask = masks[0, 0].astype(np.uint8) * 255
    mask = cv2.cvtColor(mask, cv2.COLOR_GRAY2BGR)

    # å°†åˆ†å‰²æ©ç å åŠ åˆ°åŸå§‹å›¾åƒä¸Š
    result = cv2.addWeighted(image, 0.5, mask, 0.5, 0)
    result = cv2.cvtColor(result, cv2.COLOR_RGB2BGR)

    # ä¿å­˜è¾“å‡ºå›¾ç‰‡
    cv2.imwrite(output_image_path, result)
</code></pre><ol start=3><li>Rustç‰ˆæœ¬ä»£ç </ol><pre class=language-rs data-lang=rs><code class=language-rs data-lang=rs>#![allow(unused)]
#![allow(deprecated)]

//! æµ‹è¯• SAM2.1 å›¾ç‰‡åˆ†å‰²
//! ç¼–ç æ¨¡å‹: ../../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.encoder.onnx
//! è¾“å‡º:
//! high_res_feats_0
//! name: high_res_feats_0
//! tensor: float32[Reshapehigh_res_feats_0_dim_0,Reshapehigh_res_feats_0_dim_1,Reshapehigh_res_feats_0_dim_2,Reshapehigh_res_feats_0_dim_3]
//! high_res_feats_1
//! name: high_res_feats_1
//! tensor: float32[Reshapehigh_res_feats_1_dim_0,Reshapehigh_res_feats_1_dim_1,Reshapehigh_res_feats_1_dim_2,Reshapehigh_res_feats_1_dim_3]
//! image_embed
//! name: image_embed
//! tensor: float32[Reshapeimage_embed_dim_0,Reshapeimage_embed_dim_1,Reshapeimage_embed_dim_2,Reshapeimage_embed_dim_3]
//!
//! è§£ç æ¨¡å‹: ../../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.decoder.onnx
//! è¾“å‡º:
//! masks
//! name: masks
//! tensor: float32[Resizemasks_dim_0,Resizemasks_dim_1,Resizemasks_dim_2,Resizemasks_dim_3]
//! iou_predictions
//! name: iou_predictions
//! tensor: float32[Resizemasks_dim_0,Whereiou_predictions_dim_1]
//!
//! è¾“å…¥å›¾ç‰‡ ./assets/rgb1.png
//! è¾“å‡º ./result/segment_onnx.png

// å¯¼å…¥æ ‡å‡†åº“è·¯å¾„å¤„ç†æ¨¡å—
use std::path::Path;

// å¯¼å…¥ ORT ç›¸å…³æ¨¡å—
use ort::{inputs, session::Session};
use ort::value::Tensor;

// å›¾åƒå¤„ç†ç›¸å…³æ¨¡å—
use image::{GenericImageView, ImageBuffer, Rgb};

// é”™è¯¯å¤„ç†æ¨¡å—
use anyhow::Result;

// çº¿æ€§ä»£æ•°åº“
use ndarray::{ 
    Array, ArrayD, ArrayViewD, 
    Dim, Ix1, Ix2, Ix3, Ix4, 
    IxDyn, stack, Axis,
    IxDynImpl, ArrayBase,
};
use ndarray::OwnedRepr;

// éšæœºæ•°
use rand::rng;

// éšæœºåˆ†å¸ƒ
use rand_distr::{ Normal, Distribution};

// ç”Ÿæˆæˆªæ–­æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°
fn trunc_normal(size: &[usize], std: f32, a: f32, b: f32) -> ArrayD&LTf32> {
    // åˆ›å»ºæ­£æ€åˆ†å¸ƒï¼ˆéœ€å¤„ç†å¯èƒ½çš„é”™è¯¯ï¼‰
    let dist = Normal::new(0.0, std as f64).expect("Invalid normal distribution parameters");
    let mut rng = rand::rng();
    
    // ä½¿ç”¨ mapv è¿›è¡Œå‘é‡åŒ–æ“ä½œ
    ArrayD::zeros(size).mapv(|_ : f32| {
        let v = dist.sample(&mut rng) as f32;
        v.clamp(a * std, b * std) // ç­‰ä»·äº max(a).min(b)
    })
}

// è½¬æ¢åæ ‡
fn transform_coords(coords: &mut Array&LTf32, Ix2>, orig_hw: (u32, u32)) {
    let (h, w) = (orig_hw.0 as f32, orig_hw.1 as f32);
    coords.index_axis_mut(ndarray::Axis(1), 0).mapv_inplace(|x| x / w);
    coords.index_axis_mut(ndarray::Axis(1), 1).mapv_inplace(|y| y / h);

    let resolution = 1024.0;
    coords.mapv_inplace(|x| x * resolution);
}

// è½¬æ¢è¾¹æ¡†
fn transform_boxes(boxes: &mut Array&LTf32, Ix2>, orig_hw: (u32, u32)) {
    // ç›´æ¥å¤„ç†äºŒç»´æ•°ç»„
    transform_coords(boxes, orig_hw); 
}

// åå¤„ç†æ©ç 
fn postprocess_masks(masks: &Array&LTf32, Ix4>, orig_hw: (u32, u32)) -> Array&LTf32, Ix4> {

    // åˆ›å»ºä¸€ä¸ªç”¨äºå­˜å‚¨æ’å€¼åçš„æ©ç çš„å‘é‡
    let mut interpolated_masks = Vec::new();

    // éå†è¾“å…¥çš„æ©ç æ•°ç»„
    for mask in masks.outer_iter() {

        // å°†å½“å‰æ©ç è½¬æ¢ä¸ºåŠ¨æ€ç»´åº¦æ•°ç»„
        let mut _mask = mask.into_dyn();

        // ä½¿ç”¨ä¸´æ—¶å˜é‡è§£å†³å€Ÿç”¨å†²çª
        let mut temp_mask: ArrayViewD&LTf32>;

        // æ£€æŸ¥æ©ç çš„ç»´åº¦ï¼Œå¦‚æœä¸º4ï¼Œåˆ™æå–ç¬¬ä¸€ä¸ªç»´åº¦çš„æ•°æ®
        if _mask.ndim() == 4 {
            // è½¬æ¢ä¸ºåŠ¨æ€ç»´åº¦
            temp_mask = _mask.index_axis(ndarray::Axis(0), 0).into_dyn();
        } else {
            // å¦‚æœä¸æ˜¯4ç»´ï¼Œç›´æ¥èµ‹å€¼, ä½¿ç”¨ã€Œè§†å›¾ã€
            temp_mask = _mask.view(); 
        }

        // å¦‚æœæ©ç çš„ç»´åº¦ä¸æ˜¯3ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
        if _mask.ndim() != 3 {
            panic!("Unexpected mask shape: {:?}", mask.shape());
        }

        // ç¿»è½¬æ©ç çš„åæ ‡è½´
        let mut mask_ = temp_mask.reversed_axes();
        // ä½¿ç”¨imageåº“å°†æ©ç è½¬æ¢ä¸ºå›¾åƒï¼Œå¹¶è¿›è¡Œç¼©æ”¾
        let resized_mask = image::imageops::resize(
            &ImageBuffer::from_fn(
                mask_.shape()[1] as u32,
                mask_.shape()[0] as u32,
                |x, y| Rgb([(mask_[[y as usize, x as usize, 0]] * 255.0) as u8; 3]),
            ),
            orig_hw.1,
            orig_hw.0,
            image::imageops::FilterType::Nearest,
        );

        // å°†ç¼©æ”¾åçš„å›¾åƒè½¬æ¢ä¸ºæ•°ç»„
        let mut resized_mask = Array::from_shape_fn(
            (resized_mask.height() as usize, resized_mask.width() as usize, 1),
            |(y, x, _)| resized_mask.get_pixel(x as u32, y as u32)[0] as f32 / 255.0,
        );

        // å†æ¬¡ç¿»è½¬æ•°ç»„çš„åæ ‡è½´
        resized_mask = resized_mask.reversed_axes();

        // å°†å¤„ç†åçš„æ©ç æ·»åŠ åˆ°å‘é‡ä¸­
        interpolated_masks.push(resized_mask);
    }
    // åˆ›å»ºä¸€ä¸ªè§†å›¾æ•°ç»„
    let views: Vec<_> = interpolated_masks.iter()
        .map(|arr| arr.view())
        .collect();
    
    // å°†è§†å›¾æ•°ç»„å †å æˆä¸€ä¸ªæ–°çš„æ•°ç»„
    ndarray::stack(ndarray::Axis(0), &views).unwrap()
}

struct SAM2ImagePredictor {
    encoder_session: Session,
    decoder_session: Session,
}

impl SAM2ImagePredictor {
    // æ„é€ å‡½æ•°
    fn new(encoder_model_path: &str, decoder_model_path: &str) -> Result&LTSelf> {
        let encoder_session = Session::builder()?.commit_from_file(encoder_model_path)?;
        let decoder_session = Session::builder()?.commit_from_file(decoder_model_path)?;
        Ok(SAM2ImagePredictor {
            encoder_session,
            decoder_session,
        })
    }

    // ä¿®æ­£è¿”å›ç±»å‹ï¼Œæ˜ç¡®è¿”å›çš„ä¸‰ä¸ªæ•°ç»„çš„å…·ä½“å½¢çŠ¶
    fn set_image(&mut self, image: &image::DynamicImage) -> Result<(Array&LTf32, Ix4>, Array&LTf32, Ix4>, Array&LTf32, Ix4>)> {
        // è°ƒæ•´å›¾åƒå¤§å°ä¸ºæ¨¡å‹æœŸæœ›çš„å°ºå¯¸
        let resized_img = image.resize_exact(1024, 1024, image::imageops::FilterType::Nearest);
        // åˆ›å»ºå››ç»´æ•°ç»„ä¿å­˜é¢„å¤„ç†æ•°æ® [batch=1, channels=3, height=1024, width=1024]
        let mut input_array = Array::zeros((1, 3, 1024, 1024));
        // éå†æ‰€æœ‰åƒç´ è¿›è¡Œå½’ä¸€åŒ–å¤„ç†
        for (x, y, pixel) in resized_img.to_rgb8().enumerate_pixels() {
            // å½’ä¸€åŒ– R é€šé“
            input_array[[0, 0, y as usize, x as usize]] = pixel[0] as f32 / 255.0; 
            // å½’ä¸€åŒ– G é€šé“
            input_array[[0, 1, y as usize, x as usize]] = pixel[1] as f32 / 255.0; 
            // å½’ä¸€åŒ– B é€šé“
            input_array[[0, 2, y as usize, x as usize]] = pixel[2] as f32 / 255.0; 
        }
        // å°†æ•°ç»„è½¬æ¢ä¸º ORT å¼ é‡
        let input_tensor = ort::value::Value::from_array(input_array.clone())?;

        // è¿è¡Œç¼–ç å™¨æ¨¡å‹æ¨ç†
        let outputs = self.encoder_session.run(inputs![input_tensor])?;
        // æå–æ¨ç†ç»“æœä¸­çš„ç‰¹å¾å’ŒåµŒå…¥å‘é‡
        let (high_res_feats_0_shape, high_res_feats_0) = outputs["high_res_feats_0"].try_extract_tensor::&LTf32>()?;
        let (high_res_feats_1_shape, high_res_feats_1) = outputs["high_res_feats_1"].try_extract_tensor::&LTf32>()?;
        let (image_embed_shape, image_embed) = outputs["image_embed"].try_extract_tensor::&LTf32>()?;

        // println!("high_res_feats_0çš„shapeå¤§å°: {}", outputs["high_res_feats_0"].try_extract_tensor::&LTf32>()?.0);
        // println!("high_res_feats_1çš„shapeå¤§å°: {}", outputs["high_res_feats_1"].try_extract_tensor::&LTf32>()?.0);
        // println!("image_embedçš„shapeå¤§å°: {}", outputs["image_embed"].try_extract_tensor::&LTf32>()?.0);

        // å°†ç‰¹å¾å’ŒåµŒå…¥å‘é‡è½¬æ¢ä¸º ndarray æ•°ç»„
        Ok((
            // é«˜åˆ†è¾¨ç‡ç‰¹å¾ 0
            Array::from_shape_vec(
                Dim::<[usize; 4]>::new(
                    [high_res_feats_0_shape[0] as usize, high_res_feats_0_shape[1] as usize, 
                    high_res_feats_0_shape[2] as usize, high_res_feats_0_shape[3] as usize]
                ), 
                high_res_feats_0.to_vec()
            )?, 
            // é«˜åˆ†è¾¨ç‡ç‰¹å¾ 1
            Array::from_shape_vec(
                Dim::<[usize; 4]>::new(
                    [high_res_feats_1_shape[0] as usize, high_res_feats_1_shape[1] as usize, 
                    high_res_feats_1_shape[2] as usize, high_res_feats_1_shape[3] as usize]
                ), 
                high_res_feats_1.to_vec()
            )?, 
            // å›¾åƒåµŒå…¥å‘é‡
            Array::from_shape_vec(
                Dim::<[usize; 4]>::new(
                    [image_embed_shape[0] as usize, image_embed_shape[1] as usize,
                    image_embed_shape[2] as usize, image_embed_shape[3] as usize]
                ),
                image_embed.to_vec()
            )?, 
        ))
    }

    // æ‰§è¡Œé¢„æµ‹
    fn predict(
        &mut self,
        features: (Array&LTf32, Ix4>, Array&LTf32, Ix4>, Array&LTf32, Ix4>), 
        orig_hw: (u32, u32), 
        point_coords: Option&LTArray&LTf32, Ix2>>, 
        point_labels: Option&LTArray&LTf32, Ix1>>, 
        box_coords: Option&LTArray&LTf32, Ix2>>, 
        mask_input: Option&LTArray&LTf32, Ix4>>, 
    ) -> Result<(Array&LTf32, Ix4>, Array&LTf32, Ix2>, Array&LTf32, Ix4>)> {
        // åˆå§‹åŒ–æœªå½’ä¸€åŒ–çš„åæ ‡å’Œæ ‡ç­¾
        let mut unnorm_coords: Option&LTArrayD&LTf32>> = None;
        let mut labels: Option&LTArrayD&LTf32>> = None;
    
        // å¦‚æœæœ‰è¾“å…¥ç‚¹åæ ‡
        if let Some(mut coords) = point_coords {
            if coords.len() != 0 {
                // è½¬æ¢åæ ‡
                transform_coords(&mut coords, orig_hw); 
    
                // æ’å…¥è½´
                let coords_3d = coords.insert_axis(Axis(0)).into_dyn();
                let lbls = point_labels.unwrap().insert_axis(Axis(0)).into_dyn();
    
                // è®¾ç½®æœªå½’ä¸€åŒ–çš„åæ ‡
                unnorm_coords = Some(coords_3d); 
                // è®¾ç½®æ ‡ç­¾
                labels = Some(lbls); 
            }
        }
    
        // åˆå§‹åŒ–æœªå½’ä¸€åŒ–çš„è¾¹æ¡†
        let mut unnorm_box: Option&LTArrayD&LTf32>> = None;
        if let Some(mut box_) = box_coords {
            // è°ƒæ•´è¾¹æ¡†å½¢çŠ¶
            let mut box_3d = box_
                .to_shape((1, 2, 2))
                .unwrap()
                .into_owned()
                .into_dyn();
    
            // è½¬æ¢è¾¹æ¡†
            // åŠ¨æ€æ•°ç»„è½¬ä¸ºå›ºå®šç»´åº¦æ•°ç»„å†è°ƒç”¨å¤„ç†å‡½æ•°
            // è½¬æ¢ä¸ºå›ºå®šäºŒç»´æ•°ç»„
            let mut fixed_box_3d: ArrayBase<_, Ix2> = match box_3d.view_mut().to_owned().into_dimensionality::&LTIx2>() {
                Ok(array) => array,
                Err(_) => panic!("The array is not 2-dimensional!"),
            };
            transform_boxes(&mut fixed_box_3d.to_owned(), orig_hw); 
            unnorm_box = Some(box_3d);
        }
    
        // å¤„ç†è¾“å…¥æ©ç 
        let mut mask_input = mask_input.map(|mut m| {
            if m.ndim() == 3 {
                // æ’å…¥è½´
                // m = m.insert_axis(Axis(0)); 
            }
            m.into_dyn()
        });
        // å¦‚æœæ²¡æœ‰è¾“å…¥æ©ç ï¼Œåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„æ©ç 
        if mask_input.is_none() {
            mask_input = Some(Array::zeros((1, 1, 256, 256)).into_dyn());
        }
    
        // å¦‚æœæ²¡æœ‰ç‚¹åæ ‡å’Œè¾¹æ¡†ï¼Œåˆ›å»ºé»˜è®¤çš„ç‚¹åæ ‡å’Œæ ‡ç­¾
        if unnorm_coords.is_none() && unnorm_box.is_none() {
            unnorm_coords = Some(Array::from_shape_vec((1, 1, 2), vec![0.5, 0.5]).unwrap().into_dyn());
            labels = Some(Array::from_shape_vec((1, 1), vec![1.0]).unwrap().into_dyn());
        }
    
        // åˆå¹¶ç‚¹åæ ‡å’Œè¾¹æ¡†
        let mut concat_points: Option<(ArrayD&LTf32>, ArrayD&LTf32>)> = None;
        if let Some(coords) = unnorm_coords {
            concat_points = Some((coords, labels.unwrap()));
        }
    
        if let Some(mut box_coords) = unnorm_box {
            // åˆ›å»ºè¾¹æ¡†æ ‡ç­¾
            let box_labels = Array::from_shape_vec((1, 2), vec![2.0, 3.0]).unwrap().into_dyn();
            if let Some((mut concat_coords, mut concat_labels)) = concat_points {
                // åˆå¹¶ç‚¹åæ ‡å’Œè¾¹æ¡†åæ ‡
                let concat_coords = ndarray::stack(Axis(1), &[box_coords.view(), concat_coords.view()]).unwrap().into_dyn();
                // åˆå¹¶ç‚¹æ ‡ç­¾å’Œè¾¹æ¡†æ ‡ç­¾
                let concat_labels = ndarray::stack(Axis(1), &[box_labels.view(), concat_labels.view()]).unwrap().into_dyn();
                concat_points = Some((concat_coords, concat_labels));
            } else {
                concat_points = Some((box_coords, box_labels));
            }
        }
    
        // è·å–æ©ç è¾“å…¥
        let mask_input_dummy = mask_input.unwrap();
        // åˆ›å»ºæ©ç å¯ç”¨æ ‡å¿—
        let masks_enable = Array::from_shape_vec((1,), vec![if mask_input_dummy.len() > 0 { 1.0 } else { 0.0 }]).unwrap().into_dyn();
    
        // è§£æ„è¾“å…¥ç‰¹å¾
        let (high_res_feats_0, high_res_feats_1, image_embed) = features;
        // åˆ›å»ºåŸå§‹å›¾åƒå¤§å°æ•°ç»„
        let orig_im_size = Array::from_shape_vec((2,), vec![orig_hw.0 as i32, orig_hw.1 as i32]).unwrap().into_dyn();
    
        // è·å–åˆå¹¶åçš„ç‚¹åæ ‡å’Œæ ‡ç­¾
        let (concat_coords, concat_labels) = concat_points.ok_or_else(|| anyhow::anyhow!("concat_points must be exists"))?;
    
        // åœ¨ predict æ–¹æ³•ä¸­
        let outputs = self.decoder_session.run(inputs![
            "point_coords" => ort::value::Value::from_array(concat_coords.mapv(|x| x as f32))?,
            "point_labels" => ort::value::Value::from_array(concat_labels.mapv(|x| x as f32))?,
            "mask_input" => ort::value::Value::from_array(mask_input_dummy.mapv(|x| x as f32))?,
            "has_mask_input" => ort::value::Value::from_array(masks_enable.mapv(|x| x as f32))?,
            "orig_im_size" => ort::value::Value::from_array(orig_im_size.mapv(|x| x as i32))?,
            "image_embed" => ort::value::Value::from_array(image_embed.mapv(|x| x as f32))?,
            "high_res_feats_0" => ort::value::Value::from_array(high_res_feats_0.mapv(|x| x as f32))?,
            "high_res_feats_1" => ort::value::Value::from_array(high_res_feats_1.mapv(|x| x as f32))?
        ])?;
    
        // æå–æ¨ç†ç»“æœ
        let (masks_shape, masks) = outputs["masks"].try_extract_tensor::&LTf32>()?;
        let (iou_pred_shape, iou_pred) = outputs["iou_predictions"].try_extract_tensor::&LTf32>()?;

        println!("masks_shape: {}", masks_shape);
        println!("iou_pred_shape: {}", iou_pred_shape);
    
        // å°†æ¨ç†ç»“æœè½¬æ¢ä¸º ndarray æ•°ç»„, æ©ç 
        let mut masks = Array::from_shape_vec((masks.len(),), masks.to_vec())?.into_dyn();
        // IOU é¢„æµ‹
        let iou_pred = Array::from_shape_vec((iou_pred.len(),), iou_pred.to_vec())?.into_dyn();
    
        // FIXME: è¿™ä¸¤ä¸ªè¿”å›å€¼æ²¡æœ‰ç”¨åˆ°, æ‰€ä»¥ç›´æ¥å¿½ç•¥
        // æå–ä½åˆ†è¾¨ç‡æ©ç 
        // let low_res_masks = masks.slice(ndarray::s![.., 1.., .., ..]).to_owned();
        let low_res_masks: Array&LTf32, Ix4> = masks.clone().into_shape((1, 1, 480, 640))?;
        // æå– IOU é¢„æµ‹
        // let iou_predictions = iou_pred.slice(ndarray::s![.., 1..]).to_owned();
        let iou_predictions: Array&LTf32, Ix2> = iou_pred.clone().into_shape((1, 1))?;
    
        // åå¤„ç†æ©ç 
        // åŠ¨æ€æ•°ç»„è½¬ä¸ºå›ºå®šç»´åº¦æ•°ç»„å†è°ƒç”¨å¤„ç†å‡½æ•°
        // è½¬æ¢ä¸ºå›ºå®šå››ç»´æ•°ç»„

        let mut fixed_masks = low_res_masks.clone();
        // let mut fixed_masks: ArrayBase<_, Ix4> = match masks.view_mut().to_owned().into_dimensionality::&LTIx4>() {
        //     Ok(array) => array,
        //     Err(_) => {
        //         // panic!("The array is not 4-dimensional!"),
        //     }
        // };


        let masks = postprocess_masks(&mut fixed_masks, orig_hw);
    
        // è¿”å›ç»“æœ
        Ok((masks, iou_predictions, low_res_masks))
        // Ok((masks, Array&LTf32, Ix2>::zeros(), Array&LTf32, Ix4>::zeros()))
    }

}

fn main() -> Result<()> {
    // è¾“å…¥å›¾ç‰‡è·¯å¾„
    let input_image_path = "./assets/rgb1.png";
    // è¾“å‡ºå›¾ç‰‡è·¯å¾„
    let output_image_path = "./result/ort_segment.png";
    // ç¼–ç å™¨æ¨¡å‹è·¯å¾„
    let encoder_model_path = "../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.encoder.onnx";
    // è§£ç å™¨æ¨¡å‹è·¯å¾„
    let decoder_model_path = "../../assets/ailia-models/segment-anything-2/sam2.1_base_plus.decoder.onnx";

    // åˆ›å»ºè¾“å‡ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
    std::fs::create_dir_all(Path::new(output_image_path).parent().unwrap())?;

    // è¯»å–è¾“å…¥å›¾ç‰‡
    let image = image::open(input_image_path)?;
    let orig_hw = (image.height(), image.width());

    // åˆå§‹åŒ– SAM2 å›¾åƒåˆ†å‰²é¢„æµ‹å™¨
    let mut predictor = SAM2ImagePredictor::new(encoder_model_path, decoder_model_path)?;

    // è®¾ç½®è¾“å…¥å›¾åƒå¹¶è·å–ç¼–ç å™¨çš„ç‰¹å¾
    let features = predictor.set_image(&image)?;

    // è¿›è¡Œå›¾åƒåˆ†å‰²é¢„æµ‹
    let (masks, iou_predictions, low_res_masks) = predictor.predict(features, orig_hw, None, None, None, None)?;

    // FIXME: ç»˜å›¾é”™è¯¯
    // å°†åˆ†å‰²æ©ç è½¬æ¢ä¸ºå¯è§†åŒ–å›¾åƒ 
    let mask = masks.slice(ndarray::s![0, 0, .., ..]).mapv(|x| (x * 255.0) as u8);
    let mut img_buffer = ImageBuffer::from_fn(orig_hw.1, orig_hw.0, |x, y| Rgb([mask[[x as usize, y as usize]]; 3]));

    // å°†åˆ†å‰²æ©ç å åŠ åˆ°åŸå§‹å›¾åƒä¸Š
    let orig_img = image.to_rgb8();
    for (x, y, pixel) in img_buffer.enumerate_pixels_mut() {
        let orig_pixel = orig_img.get_pixel(x, y);
        *pixel = Rgb([
            ((orig_pixel[0] as f32 * 0.5 + pixel[0] as f32 * 0.5) as u8),
            ((orig_pixel[1] as f32 * 0.5 + pixel[1] as f32 * 0.5) as u8),
            ((orig_pixel[2] as f32 * 0.5 + pixel[2] as f32 * 0.5) as u8),
        ]);
    }

    // ä¿å­˜è¾“å‡ºå›¾ç‰‡
    img_buffer.save(output_image_path)?;

    Ok(())
}
</code></pre><h3 id=-10>æ•ˆæœå¯¹æ¯”</h3><table><thead><tr><th>åŸå›¾<th>Pythonç»“æœ<th>Rustç»“æœ<tbody><tr><td><img alt decoding=async loading=lazy src=https://img2024.cnblogs.com/blog/1048201/202504/1048201-20250412134256360-1125855337.png><td><img alt decoding=async loading=lazy src=https://img2024.cnblogs.com/blog/1048201/202504/1048201-20250412134317941-307546098.png><td><img alt decoding=async loading=lazy src=https://img2024.cnblogs.com/blog/1048201/202504/1048201-20250412134332478-828850684.png></table></article><div><div class=post-copyright><div class=post-copyright__author_group><a class=post-copyright__author_img href=/about> <picture class="post-copyright__author_img_back progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture> </a><div class=post-copyright__author_name>ByeIOÂ·å¼€å‘è€…åšå®¢</div><div class=post-copyright__author_desc>ByeIOÂ·å¼€å‘è€…åšå®¢|æŠ€æœ¯è§£å†³æ–¹æ¡ˆ|å¼€å‘æ€è€ƒ|æ€»ç»“</div></div><div class=post-tools id=post-tools><div class=post-tools-left><div class=rewardLeftButton><div class="reward-link mode"><a class=reward-link-button href=/subscribe> <i class=icon-plant-fill></i>è®¢é˜… </a></div></div><div class=shareRight><div class="copyright-link mobile"><div class=copyright-qrcode><div class=copyright-button title=ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« ><i class=icon-qrcode></i></div><div class=copyright-main><div class=copyright-main-all><div id=qrcode></div><div class=reward-dec>ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« </div></div></div></div></div><div class="copyright-link copyurl"><div class=copyright-button id=post-share-url onclick=rm.copyPageUrl() title=å¤åˆ¶é“¾æ¥><i class=icon-link></i></div></div></div></div></div><div class=post-copyright__notice><span class=post-copyright-info> æœ¬æ–‡æ˜¯åŸåˆ›æ–‡ç« ï¼Œé‡‡ç”¨ <a href=/copyright target=_blank>CC BY-NC-ND 4.0</a> åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜ <a href=/ target=_blank>æœ¬ç«™åç§°åŠåœ°å€</a> </span></div></div><div class=post-tools-right><div class=tag_share><div class=post-meta__tag-list><a class=post-meta__tags href=/tags/blog/> <span class=tags-punctuation>åšå®¢</span> <span class=tagsPageCount>31</span> </a><a class=post-meta__tags href=/tags/docs/> <span class=tags-punctuation>æ–‡æ¡£</span> <span class=tagsPageCount>25</span> </a><a class=post-meta__tags href=/tags/featured/> <span class=tags-punctuation>å¿…çœ‹</span> <span class=tagsPageCount>30</span> </a><a class=post-meta__tags href=/tags/hot/> <span class=tags-punctuation>çƒ­é—¨</span> <span class=tagsPageCount>30</span> </a></div></div></div><link href=/css/post-copyright-one.css rel=stylesheet></div><nav class="pagination-post needEndHide" id=pagination><div class="prev-post pull-left"><a href=/articles/docs/æŠ˜è…¾ç¬”è®°[20]-ä½¿ç”¨rustäº¤æ¢protobufæ•°æ®/> <div class=pagination-info><div class=label>ä¸Šä¸€ç¯‡</div><div class=prev_info>æŠ˜è…¾ç¬”è®°[20]-ä½¿ç”¨rustäº¤æ¢protobufæ•°æ®</div></div> </a></div><div class="next-post pull-right"><a href=/articles/docs/æŠ˜è…¾ç¬”è®°[24]-ä½¿ç”¨ruståŸºäºå…‰æµæ³•å¯¹æ¯”å›¾åƒ/> <div class=pagination-info><div class=label>ä¸‹ä¸€ç¯‡</div><div class=next_info>æŠ˜è…¾ç¬”è®°[24]-ä½¿ç”¨ruståŸºäºå…‰æµæ³•å¯¹æ¯”å›¾åƒ</div></div> </a></div></nav><div class=relatedPosts><div class=headline><i class=icon-cainixihuan style=font-size:1.1rem></i><span>å–œæ¬¢è¿™ç¯‡æ–‡ç« çš„äººä¹Ÿçœ‹äº†</span></div><div class=relatedPosts-list><div><a href=/articles/docs/ROSç¬”è®°[1]-æ­å»ºGazeboä»¿çœŸç¯å¢ƒ/ title=ROSç¬”è®°[1]-æ­å»ºGazeboä»¿çœŸç¯å¢ƒ> <picture class="cover progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> <div class="content is-center"><div class=date><i class="far fa-calendar-alt fa-fw"></i> 2025-01-01</div><div class=title>ROSç¬”è®°[1]-æ­å»ºGazeboä»¿çœŸç¯å¢ƒ</div></div> </a></div><div><a href=/articles/docs/ROSç¬”è®°[2]-è·å–OpenMVæ•°æ®å¹¶å‘å¸ƒåˆ°ROSæ¶ˆæ¯/ title=ROSç¬”è®°[2]-è·å–OpenMVæ•°æ®å¹¶å‘å¸ƒåˆ°ROSæ¶ˆæ¯> <picture class="cover progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> <div class="content is-center"><div class=date><i class="far fa-calendar-alt fa-fw"></i> 2025-01-01</div><div class=title>ROSç¬”è®°[2]-è·å–OpenMVæ•°æ®å¹¶å‘å¸ƒåˆ°ROSæ¶ˆæ¯</div></div> </a></div></div></div><link href=/css/related-posts-two.css rel=stylesheet><hr></div><div class=aside-content id=aside-content><div class="card-widget card-info"><div class=card-content><div class="card-info-avatar is-center"><div class=author-info__top-group><div class=author-info__sayhi id=author-info__sayhi onclick=wjx.changeSayHelloText()>å¥½ä¹…ä¸è§ï¼Œä½ ç»ˆäºæ¥äº†</div></div></div><div class=avatar-img-group><picture class="avatar-img progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture></div><div class=author-info__description_group>ä¸ºåˆ›é€ è€…è€Œç”Ÿçš„å¼€æº Zola ä¸»é¢˜~</div><div class=author-info__bottom-group><a class=author-info__bottom-group-left href=/about> <div class=author-info__name>qsbye</div> <div class=author-info__desc>ByeIOÂ·å¼€å‘è€…åšå®¢|æŠ€æœ¯è§£å†³æ–¹æ¡ˆ|å¼€å‘æ€è€ƒ|æ€»ç»“</div> </a><div class="card-info-social-icons is-center"><a rel="external nofollow" class=social-icon href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang target=_blank title=GitHub> <i class=icon-github></i> </a></div></div></div><style>.avatar-img-group:before{content:"";-o-transition:1s;background:var(--wjx-green);border:5px solid var(--wjx-background);z-index:2;border-radius:50%;width:26px;height:26px;-webkit-transition:all 1s;-moz-transition:all 1s;-ms-transition:all 1s;transition:all 1s;position:absolute;bottom:2px;right:2px}.card-info-avatar.is-center{flex-direction:column;align-items:flex-start;display:flex}#aside-content .card-info .avatar-img{opacity:1;border:5px solid var(--wjx-white);border-radius:500px;width:118px;transition:all .3s;position:absolute;top:0;right:0;overflow:hidden}.page #aside-content .card-info .avatar-img{border-color:var(--wjx-card-bg)}.author-info__top-group{width:100%;height:28px;display:flex}.avatar-img-group{transform-origin:bottom;border-radius:500px;width:118px;height:118px;transition:all .3s cubic-bezier(.69,.39,0,1.21);position:absolute;top:90px;right:calc(50% - 59px)}#aside-content .card-info:hover .avatar-img-group{opacity:0;transform:scale(0)}.author-info__bottom-group{justify-content:space-between;align-items:center;width:100%;padding:1.2rem;display:flex;position:absolute;bottom:0;left:0}a.author-info__bottom-group-left:hover{opacity:.8}#aside-content .card-info .card-info-social-icons{cursor:pointer;flex-flow:wrap;justify-content:flex-start;margin:0;display:flex}#aside-content .card-info .card-info-social-icons i:hover{cursor:pointer;background-color:#000;transform:rotate(540deg)}#aside-content .card-info .card-info-social-icons .social-icon{margin:0 0 0 8px}#aside-content .card-info .card-info-social-icons i{background:var(--wjx-white-op);color:var(--wjx-white);justify-content:center;align-items:center;width:40px;height:40px;font-size:1rem;display:flex}#aside-content .card-info .card-info-social-icons i:hover{background:var(--wjx-white);color:var(--wjx-main);box-shadow:none;transform:scale(1.1)}[data-theme=dark] .page #aside-content .card-info .card-info-social-icons i{background:var(--wjx-black-op);color:var(--wjx-card-bg)}[data-theme=dark] .page #aside-content .card-info .card-info-social-icons i:hover{background:var(--wjx-card-bg);color:var(--wjx-fontcolor)}#aside-content .card-info .banner-button{border-radius:20px;justify-content:center;width:118px;height:40px}@media screen and (width>=1300px){#aside-content .card-info .card-info-social-icons i{color:var(--wjx-white)}[data-theme=dark] .page #aside-content .card-info .card-info-social-icons i{color:var(--wjx-card-bg)}}#aside-content .card-info .card-info-data>.card-info-data-item:hover{background:var(--wjx-post-blockquote-bg);transform:scale(.97)}#aside-content>div.card-widget.card-info>div.card-content>div.card-info-data>.card-info-data-item:hover>a>div.headline,#aside-content>div.card-widget.card-info>div.card-content>div.card-info-data>.card-info-data-item:hover>a>div.length-num{color:var(--wjx-blue)}.author-info__description_group{color:var(--wjx-white);opacity:0;width:100%;padding:1.2rem;transition:all .3s;position:absolute;top:50px;left:0}.card-widget:hover .author-info__description_group{opacity:1}.author-info__description2{text-align:justify;z-index:2;color:#fffc;width:100%;margin:.3rem 0;line-height:1.38}.author-info__description2 b{color:var(--wjx-white)}[data-theme=dark] .page div#author-info__sayhi{background:var(--wjx-black-op);color:var(--wjx-black)}#aside-content .card-info .author-info__name{text-align:left;color:var(--wjx-white);margin-bottom:5px;font-size:20px;font-weight:700;line-height:1}.page #aside-content .card-info .author-info__name,.page .author-info__desc{color:var(--wjx-white)}.author-info__desc{color:var(--wjx-white);opacity:.6;font-size:12px;line-height:1}.author-info__description{text-align:justify;color:var(--wjx-white);opacity:1;margin:.3rem 0;line-height:1.38}.page .author-info__description{color:var(--wjx-card-bg)}.author-info__description b{color:var(--wjx-white);opacity:1}.page .author-info__description b{color:var(--wjx-card-bg);opacity:1}.avatar-sticker{z-index:0;background:var(--wjx-white);border-radius:50%;justify-content:center;align-items:center;width:33px;height:33px;line-height:34px;transition:all .3s ease-out .2s;display:flex;position:absolute;bottom:2px;right:2px;transform:scale(1)}.page .avatar-sticker{background:var(--wjx-card-bg)}.avatar-sticker img{width:26px;height:26px}.card-widget:hover .avatar-sticker{opacity:0;transform:scale(0)}.author-info__description b{color:var(--wjx-white)}#aside-content>.card-widget.card-info:before{background:linear-gradient(-25deg,var(--wjx-main),var(--wjx-main-op-deep),var(--wjx-main),var(--wjx-main-op-deep));content:"";background-size:400%;width:100%;height:100%;animation:15s infinite gradient;position:absolute;top:0;left:0}</style></div><div class="card-widget wjx-right-widget" onclick="javascript:window.open('/subscribe')" id=card-wechat><div id=flip-wrapper><div id=flip-content><div style="background:url(/img/wechat/qr-green.avif) 50%/100% no-repeat" class=face></div><div class="back face" style="background:url(/img/wechat/qr-white.avif) 50%/100% no-repeat"></div></div></div><style>#aside-content .card-widget#card-wechat{background:#07c160}#aside-content .card-widget#card-wechat:before{content:"";background:url(/img/wechat/gzh_cover.avif) 50%/cover no-repeat;width:100%;height:90%;transition:all .2s cubic-bezier(.45,.04,.43,1.21);position:absolute;top:0;left:0}#aside-content .card-widget#card-wechat:hover:before{opacity:0;transition:all .3s ease-out;top:100%}</style></div><div class=sticky_layout><div class=card-widget id=card-toc><div class=item-headline><i class=icon-bars></i><span>æ–‡ç« ç›®å½•</span><span class=toc-percentage></span></div><div class=toc-content></div></div><div class="card-widget card-recent-post"><div class=item-headline><i class=icon-chat--fill style=font-size:19px></i><span>æœ€æ–°è¯„è®º</span></div><div class=aside-list id=newcomm></div></div><div class="card-widget card-recent-post"><div class=item-headline><i class=icon-eicon_map-2-line1></i><span>æœ€è¿‘å‘å¸ƒ</span></div><div class=aside-list><div class=aside-list-item><a class=thumbnail href=/articles/docs/é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5/ title=é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a class=title href=/articles/docs/é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5/ title=é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5>é…ç½®orangepi5proè¿è¡Œrknnç‰ˆæœ¬çš„yolov5</a></div></div><div class=aside-list-item><a class=thumbnail href=/articles/docs/è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ/ title=è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a class=title href=/articles/docs/è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ/ title=è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ>è®¡ç®—æœºæ§åˆ¶apmé£æ§è‡ªåŠ¨é£è¡Œ</a></div></div><div class=aside-list-item><a href="/articles/docs/ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight/" title="ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight" class=thumbnail> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a href="/articles/docs/ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight/" title="ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight" class=title>ç¿»è¯‘[5]-åŸºäºrustå’Œembassyå¼‚æ­¥æ¡†æ¶çš„é£æ§å›ºä»¶_ Holsatus Flight</a></div></div><div class=aside-list-item><a class=thumbnail href=/articles/docs/æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ/ title=æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ> <picture class="post_bg progressive-picture"><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/img00006.8f57f1d144c2cfd7.webp><source media="(min-width: 75em)" srcset="/processed_images/img00006.688adcb5ebd82ad6.avif?w=75em"><source media="(min-width: 60em)" srcset="/processed_images/img00006.8e3bcf4e0c9fd77c.avif?w=60em"><source media="(min-width: 45em)" srcset="/processed_images/img00006.08513801052a4920.avif?w=45em"><source media="(min-width: 30em)" srcset="/processed_images/img00006.0928215d8428e769.avif?w=30em"><source media="(min-width: 22em)" srcset="/processed_images/img00006.c83fffe523ead88b.avif?w=22em"><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" srcset="/processed_images/img00006.0beae348737c79a0.webp?w=22em 360w,
              /processed_images/img00006.1e5d356251b272fe.webp?w=30em 500w,
              /processed_images/img00006.c010a791dd57f875.webp?w=45em 720w,
              /processed_images/img00006.86f2248bcd34f02f.webp?w=60em 960w,
              /processed_images/img00006.799278f602588342.webp?w=75em 1200w" class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this)><noscript><img src="/processed_images/img00006.1e5d356251b272fe.webp?w=30em" decoding=async loading=lazy></noscript></picture> </a><div class=content><a class=title href=/articles/docs/æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ/ title=æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ>æ­å»ºArduPilotçš„SITLä»¿çœŸç¯å¢ƒ</a></div></div></div></div><div class="card-widget card-categories"><div class=item-headline><i class=icon-folder-open></i><span>åˆ†ç±»</span></div><div class=aside-list><ul class=card-category-list><li class=card-category-list-item><a class=card-category-list-link href=/categories/misc/ rel=tag> <span class=card-category-list-name>æ‚è°ˆ</span> <span class=card-category-list-count>6</span> </a><li class=card-category-list-item><a class=card-category-list-link href=/categories/theme/ rel=tag> <span class=card-category-list-name>ä¸»é¢˜</span> <span class=card-category-list-count>25</span> </a></ul></div></div></div></div></main><footer id=footer><div id=wjx-footer-bar><div class=footer-logo>qsbye</div><div class=footer-bar-description>ByeIOÂ·å¼€å‘è€…åšå®¢|æŠ€æœ¯è§£å†³æ–¹æ¡ˆ|å¼€å‘æ€è€ƒ|æ€»ç»“</div><a class=footer-bar-link href=/about>äº†è§£æ›´å¤š</a></div><div id=footer_deal><a rel="external nofollow noopener noreferrer" class=deal_link href=mailto:mail@example.com target=_blank title=Mail> <i class=icon-envelope></i> </a><picture class="footer_mini_logo progressive-picture" onclick="btf.scrollToDest(0, 500)" style=border-radius:500px><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img alt=è¿”å›é¡¶éƒ¨ class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img alt=è¿”å›é¡¶éƒ¨ decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture><a rel="external nofollow noopener noreferrer" class=deal_link href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang target=_blank title=Github> <i class=icon-github></i> </a></div><div id=wjx-footer><div class=footer-group><h3 class=footer-title>æ–‡åº“</h3><div class=footer-links><a class=footer-item data-pjax href=/archives target=_blank>å…¨éƒ¨æ–‡ç« </a><a class=footer-item data-pjax href=/categories target=_blank>åˆ†ç±»åˆ—è¡¨</a><a class=footer-item data-pjax href=/tags target=_blank>æ ‡ç­¾åˆ—è¡¨</a><a class=footer-item data-pjax href=javascript:toRandomPost() target=_blank>éšæœºæ–‡ç« </a></div></div><div class=footer-group><h3 class=footer-title>ä½œå“</h3><div class=footer-links><a class=footer-item data-pjax href=/articles/misc/lorem-ipsum target=_blank>Lorem Ipsum</a></div></div><div class=footer-group><h3 class=footer-title>åè®®</h3><div class=footer-links><a class=footer-item data-pjax href=/privacy target=_blank>éšç§åè®®</a><a class=footer-item data-pjax href=/cookies target=_blank>Cookies</a><a class=footer-item data-pjax href=/copyright target=_blank>ç‰ˆæƒåè®®</a></div></div><div class=footer-group><div class=footer-title-group><h3 class=footer-title>å‹é“¾</h3><button class=random-friends-btn id=footer-random-friends-btn onclick=javascript:wjx.addFriendLinksInFooter(); title=æ¢ä¸€æ‰¹å‹æƒ…é“¾æ¥><i class=icon-arrow-rotate-right style=font-size:16px></i></button></div><div class=footer-links id=friend-links-in-footer></div></div></div><div id=footer-bar style=padding:1rem><div class=footer-bar-links><div class=footer-bar-left><div id=footer-bar-tips><div class=copyright-group>Â© <span class=inline-word id=copyright-info>2025</span> Â ByÂ  <a class=footer-bar-link href=/ target=_blank> <picture class=progressive-picture id=copyright-logo><img class=progressive-thumbnail decoding=async loading=lazy src=/processed_images/avatar.d5facb578cf12fdc.webp><source media="(min-width: 1em)" srcset=/processed_images/avatar.8bb6bf05eac51207.avif><img class=progressive-content decoding=async loading=lazy onload=progressiveLoad(this) src=/processed_images/avatar.06a48b3b45482d6b.webp><noscript><img decoding=async loading=lazy src=/processed_images/avatar.06a48b3b45482d6b.webp></noscript></picture> ByeIOÂ·å¼€å‘è€…åšå®¢ </a><script defer>var startYear = 2025;
                            var currentYear = new Date().getFullYear();
                            var copyrightInfo = `${startYear !== currentYear ? startYear + ' - ' : ''}${currentYear}`;
                            document.getElementById('copyright-info').innerHTML = copyrightInfo;</script></div><div class=compliance-group><a rel="noopener external nofollow noreferrer" class=footer-bar-link href=https://beian.miit.gov.cn/#/Integrated/index target=_blank> ICP </a><a class=footer-bar-link href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang> <div class=status-light></div> <span>æœ¬ç«™åŠä¸»é¢˜åŸºäº Zola æ„å»º</span> </a></div></div></div><div class=footer-bar-right><a class=footer-bar-link href=/subscribe target=_blank>è®¢é˜…</a><a class=footer-bar-link href=https://github.com/iWangJiaxiang/zola-theme-jiaxiang.wang target=_blank>ä¸»é¢˜</a><a class=footer-bar-link href=/about>å…³äº</a><a class=footer-bar-link href=mailto:mail@example.com target=_blank>åé¦ˆ</a><a class="footer-bar-link cc" href=/copyright rel=license target=_blank title=CCç‰ˆæƒåè®®> <i class=icon-copyright-line></i> <i class=icon-creative-commons-by-line></i> <i class=icon-creative-commons-nc-line></i> <i class=icon-creative-commons-nd-line></i> </a></div></div></div><div id=quit-box onclick=RemoveRewardMask()></div><div class="comment-barrage needEndHide" style=display:none></div><style>a.footer-bar-link.cloud{align-items:center;display:flex}img.entered.loading.cloud{height:32px}</style></footer></div><div id=sidebar><div id=menu-mask></div><div id=sidebar-menus><span class=sidebar-menu-item-title>åŠŸèƒ½</span><div class=sidebar-menu-item><button class="darkmode_switchbutton menu-child" href=javascript:void(0); onclick=rm.switchDarkMode() title=æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢><i class=icon-moon style=font-size:.9rem;line-height:2></i> <span>æ˜¾ç¤ºæ¨¡å¼</span></button></div><div class=back-menu-list-groups><div class=back-menu-list-group><div class=back-menu-list-title>ä½œå“</div><div class=back-menu-list><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a><a class="back-menu-item nav-item" href=/articles/misc/lorem-ipsum>  <i class=icon-music style=font-size:.9em></i> <span class=back-menu-item-text>Lorem Ipsum</span> </a></div></div></div><div class=menus_items><div class=menus_item><button class=site-page><span>æ–‡åº“</span></button><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/archives> <i class="icon-book-open faa-tada" style=font-size:.9em></i> <span>å…¨éƒ¨æ–‡ç« </span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/categories> <i class="icon-folder-open faa-tada" style=font-size:.9em></i> <span>åˆ†ç±»åˆ—è¡¨</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/tags> <i class="icon-tags faa-tada" style=font-size:.9em></i> <span>æ ‡ç­¾åˆ—è¡¨</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=javascript:toRandomPost()> <i class="icon-artstation faa-tada" style=font-size:.9em></i> <span>éšæœºæ–‡ç« </span> </a></ul></div><div class=menus_item><a class=site-page href=/tags/work> <span>æ¨è</span> </a><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/articles/docs/readme> <i class="icon-music faa-tada" style=font-size:.9em></i> <span>åšå®¢ä¸»é¢˜ä»‹ç»</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/articles/misc/lorem-ipsum> <i class="icon-music faa-tada" style=font-size:.9em></i> <span>Lorem Ipsum</span> </a></ul></div><div class=menus_item><button class=site-page><span>å‹é“¾</span></button><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/friends> <i class="icon-link faa-tada" style=font-size:.9em></i> <span>å‹é“¾åˆ—è¡¨</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=javascript:travelling()> <i class="icon-paper-plane faa-tada" style=font-size:.9em></i> <span>éšæœºå‘ç°</span> </a></ul></div><div class=menus_item><button class=site-page><span>æˆ‘çš„</span></button><ul class=menus_item_child><li><a class="site-page child faa-parent animated-hover" draggable=false href=/about> <i class="icon-rocket faa-tada" style=font-size:.9em></i> <span>å…³äºæœ¬äºº</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/equipment> <i class="icon-artstation faa-tada" style=font-size:.9em></i> <span>æˆ‘çš„è£…å¤‡</span> </a><li><a class="site-page child faa-parent animated-hover" draggable=false href=/tags/project> <i class="icon-lightbulb faa-tada" style=font-size:.9em></i> <span>æˆ‘çš„é¡¹ç›®</span> </a></ul></div></div><span class=sidebar-menu-item-title>æ ‡ç­¾</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class=item-headline></div><div class=card-tag-cloud><a class=tag-item href=/tags/blog/ style=font-size:1em title=åšå®¢>  åšå®¢<sup>31</sup> </a><a class=tag-item href=/tags/docs/ style=font-size:1em title=æ–‡æ¡£>  æ–‡æ¡£<sup>25</sup> </a><a class=tag-item href=/tags/featured/ style=font-size:1em title=å¿…çœ‹>  å¿…çœ‹<sup>30</sup> </a><a class=tag-item href=/tags/hot/ style=font-size:1em title=çƒ­é—¨>  çƒ­é—¨<sup>30</sup> </a><a class=tag-item href=/tags/project/ style=font-size:1em title=é¡¹ç›®>  é¡¹ç›®<sup>1</sup> </a><a class=tag-item href=/tags/work/ style=font-size:1em title=work>  work<sup>1</sup> </a></div></div></div></div><div id=console><div class=close-btn href=javascript:void(0); onclick=wjx.hideConsole()><i class=icon-circle-xmark></i></div><div class=console-card-group><div class=console-card-group-left><div class=console-card id=card-newest-comments onclick=wjx.hideConsole()><div class=card-content><div class=author-content-item-tips>äº’åŠ¨</div><span class=author-content-item-title>æœ€è¿‘è¯„è®º</span></div><div class=aside-list><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div><div class=console-card-group-right><div class="console-card tags" onclick=wjx.hideConsole()><div class=card-content><div class=author-content-item-tips>æ ‡ç­¾</div><span class=author-content-item-title>å¯»æ‰¾æ„Ÿå…´è¶£çš„é¢†åŸŸ</span></div><div class=card-tag-cloud><a href=/tags/blog/ rel=tag style=color:#d3d3d3;font-size:1em> åšå®¢<sup>31</sup> </a><a href=/tags/docs/ rel=tag style=color:#d3d3d3;font-size:1em> æ–‡æ¡£<sup>25</sup> </a><a href=/tags/featured/ rel=tag style=color:#d3d3d3;font-size:1em> å¿…çœ‹<sup>30</sup> </a><a href=/tags/hot/ rel=tag style=color:#d3d3d3;font-size:1em> çƒ­é—¨<sup>30</sup> </a><a href=/tags/project/ rel=tag style=color:#d3d3d3;font-size:1em> é¡¹ç›®<sup>1</sup> </a><a href=/tags/work/ rel=tag style=color:#d3d3d3;font-size:1em> work<sup>1</sup> </a></div></div><div class="console-card history" onclick=wjx.hideConsole()><div class=item-headline><i class="fas fa-archive"></i><span>æ–‡ç« </span></div><ul class=card-archive-list><ul><li class=card-archive-list-item><a class=card-archive-list-link href=/archives> <span class=card-archive-list-date> 2025 1æœˆ </span> <div class=card-archive-list-count-group><span class=card-archive-list-count>25</span><span class=card-archive-list-count-unit>ç¯‡</span></div> </a></ul><ul><li class=card-archive-list-item><a class=card-archive-list-link href=/archives> <span class=card-archive-list-date> 2024 12æœˆ </span> <div class=card-archive-list-count-group><span class=card-archive-list-count>6</span><span class=card-archive-list-count-unit>ç¯‡</span></div> </a></ul></ul></div></div></div><div class=button-group><div class=console-btn-item><button rel="external nofollow" class=darkmode_switchbutton href=javascript:void(0); onclick=navFn.switchDarkMode(); title=æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢><i class=icon-moon-clear-fill style=font-size:1rem></i></button></div><div class=console-btn-item id=consoleHideAside onclick=wjx.hideAsideBtn() title=è¾¹æ æ˜¾ç¤ºæ§åˆ¶><button class=asideSwitch title=ä¾§è¾¹æ å¼€å…³><i class=icon-arrows-left-right></i></button></div><div class="console-btn-item on" id=consoleCommentBarrage onclick=wjx.switchCommentBarrage() title=çƒ­è¯„å¼€å…³><button class=commentBarrage><i class=icon-chat--fill></i></button></div></div><div class=console-mask href=javascript:void(0); onclick=wjx.hideConsole()></div></div><div id=rightside><div id=rightside-config-hide><button id=translateLink title=ç®€ç¹è½¬æ¢ type=button>ç¹</button><button id=darkmode title=æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢ type=button><i class=icon-circle-half-stroke></i></button><button id=hide-aside-btn title=å•æ å’ŒåŒæ åˆ‡æ¢ type=button><i class=icon-arrows-left-right></i></button></div><div id=rightside-config-show><button id=rightside-config title=è®¾ç½® type=button><i class=icon-gear></i></button><a href=#post-comment id=to_comment title=ç›´è¾¾è¯„è®º><i class=icon-chat--fill style=font-size:17px></i></a><button id=go-up title=å›åˆ°é¡¶éƒ¨ type=button><i class=icon-arrow-up></i></button></div></div><link onload="this.onload=null;this.rel='stylesheet'" as=style href=/css/read-mode.css rel=preload><noscript><link href=/css/read-mode.css rel=stylesheet></noscript><div class=js-pjax><div id=rightMenu><div class="rightMenu-group rightMenu-small"><div class=rightMenu-item id=menu-backward><i class=icon-arrow-left></i></div><div class=rightMenu-item id=menu-forward><i class=icon-arrow-right></i></div><div class=rightMenu-item id=menu-refresh><i class=icon-arrow-rotate-right></i></div><div class=rightMenu-item id=menu-top><i class=icon-arrow-up></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class=rightMenu-item id=menu-copytext><i class=icon-copy></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class=rightMenu-item id=menu-pastetext><i class=icon-paste></i><span>ç²˜è´´æ–‡æœ¬</span></div><a class=rightMenu-item id=menu-commenttext> <i class=icon-comment-medical></i> <span>å¼•ç”¨åˆ°è¯„è®º</span> </a><div class=rightMenu-item id=menu-newwindow><i class=icon-window-restore></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class=rightMenu-item id=menu-copylink><i class=icon-link></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class=rightMenu-item id=menu-copyimg><i class=icon-images></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class=rightMenu-item id=menu-downloadimg><i class=icon-download></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class=rightMenu-item id=menu-newwindowimg><i class=icon-window-restore></i><span>æ–°çª—å£æ‰“å¼€å›¾ç‰‡</span></div><div class=rightMenu-item id=menu-search><i class=icon-search--line></i><span>ç«™å†…æœç´¢</span></div><div class=rightMenu-item id=menu-searchBaidu><i class=icon-baidu></i><span>ç™¾åº¦æœç´¢</span></div><div class=rightMenu-item id=menu-music-toggle><i class=icon-play></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class=rightMenu-item id=menu-music-back><i class=icon-backward></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class=rightMenu-item id=menu-music-forward><i class=icon-forward></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div onclick="javascript:window.open('https://y.qq.com/n/ryqq/playlist/xxxxx')" class=rightMenu-item id=menu-music-playlist><i class=icon-radio></i><span>æŸ¥çœ‹æ‰€æœ‰æ­Œæ›²</span></div><div class=rightMenu-item id=menu-music-copyMusicName><i class=icon-copy></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id=menu-randomPost onclick=toRandomPost()> <i class=icon-shuffle></i> <span>éšä¾¿é€›é€›</span> </a><a class="rightMenu-item menu-link" href=../categories> <i class=icon-cube></i> <span>åšå®¢åˆ†ç±»</span> </a><a class="rightMenu-item menu-link" href=../tags> <i class=icon-tags></i> <span>æ–‡ç« æ ‡ç­¾</span> </a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><div class=rightMenu-item id=menu-copy><i class=icon-copy></i><span>å¤åˆ¶åœ°å€</span></div><div class=rightMenu-item draggable=false id=menu-commentBarrage style=display:flex><i class=icon-chat--fill style=font-size:19px></i><span class=menu-commentBarrage-text>æ˜¾ç¤ºçƒ­è¯„</span></div><div class=rightMenu-item id=menu-darkmode><i class=icon-moon-clear-fill style=font-size:19px></i><span class=menu-darkmode-text>æ·±è‰²æ¨¡å¼</span></div><div class=rightMenu-item id=menu-translate><i class=icon-fanti style=font-size:19px></i><span>è½‰ç‚ºç¹é«”</span></div></div></div><div id=rightmenu-mask></div></div><script defer onload src=/libs/qrcode/qrcode.min.js></script><script defer src=/libs/view-image/view-image.min.js></script><script defer src=/libs/tocbot/4.18.2/tocbot.min.js></script><link onload="this.onload=null;this.rel='stylesheet'" as=style href=/libs/tocbot/4.18.2/tocbot.css rel=preload><noscript><link href=/libs/tocbot/4.18.2/tocbot.css rel=stylesheet></noscript><script async src=/libs/snackbar/snackbar.min.js></script><script>var meting_api = "https:&#x2F;&#x2F;api.i-meto.com&#x2F;meting&#x2F;api?server=:server&amp;type=:type&amp;id=:id&amp;r=:r";</script><canvas height=880 id=universe width=1312></canvas><script defer src=/libs/canvas/dark.js></script><script src=/libs/waterfall/waterfall.min.js></script><script src=/libs/fast-average-color/index.browser.min.js></script><script>let pjaxSelectors = ['title', '#body-wrap', '#rightside-config-hide', '#rightside-config-show', '.js-pjax', '#site-config']
          
    pjaxSelectors.unshift('meta[property="og:type"]', 'meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]', 'meta[property="og:description"]'
            , 'meta[name="twitter:title"]', 'meta[name="twitter:url"]', 'meta[name="twitter:description"]', 'meta[name="twitter:image"]', 'meta[name="description"]')
    
    var pjax = new Pjax({
        elements: 'a:not([target="_blank"])',
        selectors: pjaxSelectors,
        cacheBust: false,
        //debug: true,        
        analytics: false,
        scrollRestoration: false
    })</script><script defer src=/js/rightmenu.js></script><script data-pjax defer src=/production/js/abstract/local.js></script><script data-pjax defer src=/production/js/bundle.js></script><script defer src=/js/tw_cn.js></script><script defer src=/libs/instantpage/instantpage.min.js type=module></script><link onload="this.rel='stylesheet'" as=style href=/libs/prism/prism.min.css rel=preload><noscript><link href=/libs/prism/prism.min.css rel=stylesheet></noscript><link onload="this.rel='stylesheet'" as=style href=/libs/prism/code.css rel=preload><noscript><link href=/libs/prism/code.css rel=stylesheet></noscript><link onload="this.rel='stylesheet'" as=style data-code-theme=light href=/libs/prism/themes/prism-one-dark.css rel=preload><noscript><link href=/libs/prism/themes/prism-one-dark.css rel=stylesheet></noscript><link onload="this.rel='stylesheet'" as=style data-code-theme=dark href=/libs/prism/themes/prism-one-dark.css rel=preload><noscript><link href=/libs/prism/themes/prism-one-dark.css rel=stylesheet></noscript><script defer src=/libs/prism/prism.min.js></script><style>#article-container .code-toolbar pre.close{height:300px;overflow:hidden}</style>